import{u as le}from"./useToast-kHRaTOLr.js";import{p as E,g as ne}from"./request-siz4XrM7.js";import{_ as re,T as F,r as _,o as ie,c as L,b as t,t as n,h as d,w as l,I as ue,f as c,a as m,i as p,u as V,g,k as $}from"./index-CILPpmAj.js";function de(u){return E("/api/v1/back_stage/withdraw/list",u)}function ce(u){return E("/api/v1/back_stage/withdraw/audit",u)}function me(){return ne("/api/v1/back_stage/hot_address/balance")}function j(u,r="YYYY-MM-DD HH:mm:ss"){if(!u)return"-";const x=Number(u),i=new Date(x<1e10?x*1e3:x);if(isNaN(i.getTime()))return"-";const S=i.getFullYear(),k=T(i.getMonth()+1),w=T(i.getDate()),C=T(i.getHours()),D=T(i.getMinutes()),y=T(i.getSeconds());return r.replace("YYYY",S.toString()).replace("MM",k).replace("DD",w).replace("HH",C).replace("mm",D).replace("ss",y)}function T(u){return u<10?`0${u}`:u.toString()}function B(u){let r=u.toString();return r.includes(".")&&(r=r.replace(/\.?0+$/,"")),r}const pe={class:"withdraw-list"},ve={class:"mb-4"},_e={class:"text-2xl font-bold"},ge={class:"action-buttons",style:{"text-align":"center"}},fe={key:2},ye={class:"flex justify-end mt-4"},be={class:"ml-4 self-center text-gray-600"},Ve={class:"space-y-4"},ke={class:"mb-4"},xe={class:"transfer-header",style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",gap:"0.62rem","padding-top":"1rem"}},we={class:"status"},Ce={class:"time"},De={class:"transfer-info"},he={class:"info-row"},ze={class:"value-box"},Te={class:"value"},Be={class:"info-row"},Se={class:"value-box"},Ae={class:"value"},Me={class:"info-row"},$e={class:"value-box"},Ie={class:"info-row"},Ye={class:"value-box"},Ne={class:"transaction-id"},He={class:"value-box"},We={class:"value"},Ue=["href"],Pe={__name:"WithdrawList",setup(u){const{init:r}=le(),x=[{key:"id",label:"订单号"},{key:"user_id",label:"用户编号"},{key:"mobile",label:"手机号"},{key:"amount",label:"提现金额"},{key:"gas_fee",label:"gas费"},{key:"currency",label:"币种"},{key:"status",label:"提现状态"},{key:"audit_status",label:"审核状态",sortable:!0},{key:"created_time",label:"申请时间",sortable:!0},{key:"action",label:"操作"}],i=F({page:1,pagesize:10}),S=_([]),k=_(0),w=_(1),C=_(!1),D=async()=>{C.value=!0;try{const a=await de(i);a&&typeof a.Total=="number"?(S.value=a.Withdraws||[],k.value=parseInt(a.Total)):(console.error("API返回数据格式错误:",a),r({message:"数据格式错误",color:"danger"}))}catch(a){console.error("获取数据失败:",a),r({message:"获取数据失败",color:"danger"})}finally{C.value=!1}},y=async a=>{if(navigator.clipboard)navigator.clipboard.writeText(a).then(()=>{r({message:"复制成功",color:"success"})}).catch(e=>{r({message:"复制成功",color:"success"})});else{const e=document.createElement("textarea");e.value=a,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),r({message:"复制成功",color:"success"})}},R=a=>{i.page=Math.ceil(a/i.pagesize),w.value=a,D()},N=a=>({0:"处理中",1:"成功",2:"失败",3:"确认中",4:"提现异常"})[a]||"未知状态",Z=a=>{const e={0:"warning",1:"success",2:"info",3:"danger"};let M=e[a]||"primary";return console.log(e[a]),M},q=a=>({0:"待审核",1:"已通过",2:"未通过"})[a]||"未知状态",O=a=>({0:"warning",1:"success",2:"danger"})[a]||"primary",A=_(!1),h=_(null),v=F({audit_status:1}),G=a=>{a&&(h.value=a.rowData,v.audit_status=1,A.value=!0)},J=async()=>{if(!h.value)return;let a=ue();if(!v.google_code){r({message:"谷歌认证码不能为空",color:"danger"});return}try{let e=await ce({id:h.value.id,audit_status:v.audit_status,google_code:v.google_code,user_name:a});console.log("data is",e),e==0?r({message:"审核失败, 余额不足",color:"warning"}):(r({message:"审核成功",color:"success"}),A.value=!1,D())}catch(e){r({message:e,color:"danger"})}},I=_(!1),o=_(null),K=a=>{if(!a){console.error("行数据为空");return}o.value=a.rowData,v.audit_status=1,I.value=!0},H=_(0),Q=async()=>{try{const a=await me();a?H.value=parseFloat(a):console.error("热钱包余额获取失败:",a)}catch(a){console.error("热钱包余额获取失败:",a)}};return ie(()=>{D(),Q()}),(a,e)=>{const M=c("VaBadge"),W=c("VaButton"),X=c("VaDataTable"),ee=c("VaPagination"),te=c("VaCardContent"),ae=c("VaCard"),se=c("VaRadio"),oe=c("VaInput"),U=c("VaModal"),z=c("VaAvatar"),P=c("VaDivider"),Y=c("VaIcon");return m(),L("div",pe,[t("div",ve,[t("h1",_e,"提现管理 (热钱包余额："+n(H.value||0)+")",1)]),d(ae,null,{default:l(()=>[d(te,null,{default:l(()=>[d(X,{items:S.value,loading:C.value,columns:x,"items-per-page":i.pagesize,"current-page":i.page,"total-items":k.value,selectable:!1,"show-select":!1,hoverable:"",class:"responsive-table"},{"cell(amount)":l(({value:s})=>[p(n(V(B)(s)),1)]),"cell(gas_fee)":l(({value:s})=>[p(n(V(B)(s)),1)]),"cell(status)":l(({value:s})=>[d(M,{color:Z(s)},{default:l(()=>[p(n(N(s)),1)]),_:2},1032,["color"])]),"cell(audit_status)":l(({value:s})=>[d(M,{color:O(s)},{default:l(()=>[p(n(q(s)),1)]),_:2},1032,["color"])]),"cell(created_time)":l(({value:s})=>[p(n(V(j)(s)),1)]),"cell(action)":l(({row:s})=>[t("div",ge,[s?(m(),g(W,{key:0,size:"small",preset:"primary",onClick:b=>K(s)},{default:l(()=>e[10]||(e[10]=[p(" 查看 ")])),_:2},1032,["onClick"])):$("",!0),s&&Number(s.rowData.audit_status)===0?(m(),g(W,{key:1,size:"small",preset:"primary",onClick:b=>G(s)},{default:l(()=>e[11]||(e[11]=[p(" 审核 ")])),_:2},1032,["onClick"])):(m(),L("span",fe,"--"))])]),_:1},8,["items","loading","items-per-page","current-page","total-items"]),t("div",ye,[d(ee,{modelValue:w.value,"onUpdate:modelValue":[e[0]||(e[0]=s=>w.value=s),R],"page-size":i.pagesize,"visible-pages":"5",total:k.value,"buttons-preset":"secondary","boundary-numbers":""},null,8,["modelValue","page-size","total"]),t("span",be," 共 "+n(k.value)+" 条记录 ",1)])]),_:1})]),_:1}),d(U,{modelValue:A.value,"onUpdate:modelValue":e[3]||(e[3]=s=>A.value=s),title:"提现审核","ok-text":"确认","cancel-text":"取消",size:"small",class:"audit-modal",onOk:J},{default:l(()=>{var s,b;return[t("div",Ve,[t("div",null,[t("div",ke," 当前提现金额："+n(V(B)((s=h.value)==null?void 0:s.amount)||0)+" "+n(((b=h.value)==null?void 0:b.currency)||""),1),e[12]||(e[12]=t("div",{class:"mb-2"},"审核结果",-1)),d(se,{modelValue:v.audit_status,"onUpdate:modelValue":e[1]||(e[1]=f=>v.audit_status=f),options:[{text:"同意",value:1},{text:"拒绝",value:2}],"value-by":"value"},null,8,["modelValue"]),e[13]||(e[13]=t("div",{class:"mb-2",style:{"padding-top":"0.62rem"}},"谷歌认证",-1)),d(oe,{modelValue:v.google_code,"onUpdate:modelValue":e[2]||(e[2]=f=>v.google_code=f),width:"200px",placeholder:"请输入谷歌认证码"},null,8,["modelValue"])])])]}),_:1},8,["modelValue"]),d(U,{modelValue:I.value,"onUpdate:modelValue":e[9]||(e[9]=s=>I.value=s),title:"转账详情",size:"medium",class:"mr-6 my-1","close-button":""},{content:l(()=>{var s,b;return[t("div",xe,[o.value.status===0?(m(),g(z,{key:0,color:"info"},{default:l(()=>e[14]||(e[14]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," more_horiz ",-1)])),_:1})):o.value.status===1?(m(),g(z,{key:1,color:"success"},{default:l(()=>e[15]||(e[15]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," check ",-1)])),_:1})):o.value.status===2?(m(),g(z,{key:2,color:"danger"},{default:l(()=>e[16]||(e[16]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," close ",-1)])),_:1})):o.value.status===3?(m(),g(z,{key:3,color:"warning"},{default:l(()=>e[17]||(e[17]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," directory_sync ",-1)])),_:1})):o.value.status===4?(m(),g(z,{key:4,color:"danger"},{default:l(()=>e[18]||(e[18]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," check ",-1)])),_:1})):$("",!0),t("div",we,n(N(o.value.status)),1),t("div",Ce,n(V(j)(o.value.created_time)),1)]),d(P),t("div",De,[t("div",he,[e[19]||(e[19]=t("span",{class:"label"},"数额：",-1)),t("div",ze,[t("span",Te,n(V(B)((s=o.value)==null?void 0:s.amount)||0)+" "+n(o.value.currency),1)])]),t("div",Be,[e[20]||(e[20]=t("span",{class:"label"},"提款手续费：",-1)),t("div",Se,[t("span",Ae,n(V(B)((b=o.value)==null?void 0:b.gas_fee)||0)+" "+n(o.value.currency),1)])]),t("div",Me,[e[22]||(e[22]=t("span",{class:"label"},"收款地址：",-1)),t("div",$e,[t("span",{class:"value",onClick:e[4]||(e[4]=f=>y(o.value.to_addr))},n(o.value.to_addr),1),d(Y,{class:"material-icons",onClick:e[5]||(e[5]=f=>y(o.value.to_addr))},{default:l(()=>e[21]||(e[21]=[p(" content_copy ")])),_:1})])]),t("div",Ie,[e[24]||(e[24]=t("span",{class:"label"},"付款地址：",-1)),t("div",Ye,[t("span",{class:"value",onClick:e[6]||(e[6]=f=>y(o.value.from_addr))},n(o.value.from_addr),1),o.value.from_addr?(m(),g(Y,{key:0,class:"material-icons",onClick:e[7]||(e[7]=f=>y(o.value.from_addr))},{default:l(()=>e[23]||(e[23]=[p(" content_copy ")])),_:1})):$("",!0)])])]),d(P),t("div",Ne,[e[26]||(e[26]=t("span",{class:"label"},"交易号：",-1)),t("div",He,[t("span",We,[t("a",{href:`https://mainnet.aleo123.io/transactionDetail/${o.value.tx_id}`,target:"_blank"},n(o.value.tx_id),9,Ue)]),o.value.tx_id?(m(),g(Y,{key:0,class:"material-icons",onClick:e[8]||(e[8]=f=>y(o.value.tx_id))},{default:l(()=>e[25]||(e[25]=[p(" content_copy ")])),_:1})):$("",!0)])])]}),_:1},8,["modelValue"])])}}},Ee=re(Pe,[["__scopeId","data-v-6c9b712a"]]);export{Ee as default};
//# sourceMappingURL=WithdrawList-BghGBgoh.js.map
