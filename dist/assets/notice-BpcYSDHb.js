import{p as et,a as Ve,g as Te,b as Ce}from"./request-CQf3S4Yc.js";import{c as tt}from"./user-BTIttF18.js";import{f as nt}from"./date-BwSFrXps.js";import{u as at}from"./useForm-CFkzlK_i.js";import{u as ot}from"./useToast-x_1EYsvM.js";import{_ as st,r as c,U as fe,e as we,B as lt,g as Oe,w as b,f as E,a as be,b as S,i as j,h as m,t as G,u as rt,c as Ue,F as it,k as ut,q as _e}from"./index-BATlB_Q3.js";var ce=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dt={exports:{}};(function(O,p){(function(I,T){O.exports=T()})(ce,function(){var I=1e3,T=6e4,R=36e5,H="millisecond",k="second",A="minute",U="hour",i="day",f="week",h="month",v="quarter",_="year",W="date",oe="Invalid Date",X=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,te={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(r){var a=["th","st","nd","rd"],t=r%100;return"["+r+(a[(t-20)%10]||a[t]||a[0])+"]"}},N=function(r,a,t){var s=String(r);return!s||s.length>=a?r:""+Array(a+1-s.length).join(t)+r},pe={s:N,z:function(r){var a=-r.utcOffset(),t=Math.abs(a),s=Math.floor(t/60),o=t%60;return(a<=0?"+":"-")+N(s,2,"0")+":"+N(o,2,"0")},m:function r(a,t){if(a.date()<t.date())return-r(t,a);var s=12*(t.year()-a.year())+(t.month()-a.month()),o=a.clone().add(s,h),d=t-o<0,u=a.clone().add(s+(d?-1:1),h);return+(-(s+(t-o)/(d?o-u:u-o))||0)},a:function(r){return r<0?Math.ceil(r)||0:Math.floor(r)},p:function(r){return{M:h,y:_,w:f,d:i,D:W,h:U,m:A,s:k,ms:H,Q:v}[r]||String(r||"").toLowerCase().replace(/s$/,"")},u:function(r){return r===void 0}},ne="en",B={};B[ne]=te;var ve="$isDayjsObject",me=function(r){return r instanceof ie||!(!r||!r[ve])},re=function r(a,t,s){var o;if(!a)return ne;if(typeof a=="string"){var d=a.toLowerCase();B[d]&&(o=d),t&&(B[d]=t,o=d);var u=a.split("-");if(!o&&u.length>1)return r(u[0])}else{var y=a.name;B[y]=a,o=y}return!s&&o&&(ne=o),o||!s&&ne},M=function(r,a){if(me(r))return r.clone();var t=typeof a=="object"?a:{};return t.date=r,t.args=arguments,new ie(t)},g=pe;g.l=re,g.i=me,g.w=function(r,a){return M(r,{locale:a.$L,utc:a.$u,x:a.$x,$offset:a.$offset})};var ie=function(){function r(t){this.$L=re(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[ve]=!0}var a=r.prototype;return a.parse=function(t){this.$d=function(s){var o=s.date,d=s.utc;if(o===null)return new Date(NaN);if(g.u(o))return new Date;if(o instanceof Date)return new Date(o);if(typeof o=="string"&&!/Z$/i.test(o)){var u=o.match(X);if(u){var y=u[2]-1||0,w=(u[7]||"0").substring(0,3);return d?new Date(Date.UTC(u[1],y,u[3]||1,u[4]||0,u[5]||0,u[6]||0,w)):new Date(u[1],y,u[3]||1,u[4]||0,u[5]||0,u[6]||0,w)}}return new Date(o)}(t),this.init()},a.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},a.$utils=function(){return g},a.isValid=function(){return this.$d.toString()!==oe},a.isSame=function(t,s){var o=M(t);return this.startOf(s)<=o&&o<=this.endOf(s)},a.isAfter=function(t,s){return M(t)<this.startOf(s)},a.isBefore=function(t,s){return this.endOf(s)<M(t)},a.$g=function(t,s,o){return g.u(t)?this[s]:this.set(o,t)},a.unix=function(){return Math.floor(this.valueOf()/1e3)},a.valueOf=function(){return this.$d.getTime()},a.startOf=function(t,s){var o=this,d=!!g.u(s)||s,u=g.p(t),y=function(q,L){var Z=g.w(o.$u?Date.UTC(o.$y,L,q):new Date(o.$y,L,q),o);return d?Z:Z.endOf(i)},w=function(q,L){return g.w(o.toDate()[q].apply(o.toDate("s"),(d?[0,0,0,0]:[23,59,59,999]).slice(L)),o)},V=this.$W,D=this.$M,F=this.$D,K="set"+(this.$u?"UTC":"");switch(u){case _:return d?y(1,0):y(31,11);case h:return d?y(1,D):y(0,D+1);case f:var z=this.$locale().weekStart||0,P=(V<z?V+7:V)-z;return y(d?F-P:F+(6-P),D);case i:case W:return w(K+"Hours",0);case U:return w(K+"Minutes",1);case A:return w(K+"Seconds",2);case k:return w(K+"Milliseconds",3);default:return this.clone()}},a.endOf=function(t){return this.startOf(t,!1)},a.$set=function(t,s){var o,d=g.p(t),u="set"+(this.$u?"UTC":""),y=(o={},o[i]=u+"Date",o[W]=u+"Date",o[h]=u+"Month",o[_]=u+"FullYear",o[U]=u+"Hours",o[A]=u+"Minutes",o[k]=u+"Seconds",o[H]=u+"Milliseconds",o)[d],w=d===i?this.$D+(s-this.$W):s;if(d===h||d===_){var V=this.clone().set(W,1);V.$d[y](w),V.init(),this.$d=V.set(W,Math.min(this.$D,V.daysInMonth())).$d}else y&&this.$d[y](w);return this.init(),this},a.set=function(t,s){return this.clone().$set(t,s)},a.get=function(t){return this[g.p(t)]()},a.add=function(t,s){var o,d=this;t=Number(t);var u=g.p(s),y=function(D){var F=M(d);return g.w(F.date(F.date()+Math.round(D*t)),d)};if(u===h)return this.set(h,this.$M+t);if(u===_)return this.set(_,this.$y+t);if(u===i)return y(1);if(u===f)return y(7);var w=(o={},o[A]=T,o[U]=R,o[k]=I,o)[u]||1,V=this.$d.getTime()+t*w;return g.w(V,this)},a.subtract=function(t,s){return this.add(-1*t,s)},a.format=function(t){var s=this,o=this.$locale();if(!this.isValid())return o.invalidDate||oe;var d=t||"YYYY-MM-DDTHH:mm:ssZ",u=g.z(this),y=this.$H,w=this.$m,V=this.$M,D=o.weekdays,F=o.months,K=o.meridiem,z=function(L,Z,le,ue){return L&&(L[Z]||L(s,d))||le[Z].slice(0,ue)},P=function(L){return g.s(y%12||12,L,"0")},q=K||function(L,Z,le){var ue=L<12?"AM":"PM";return le?ue.toLowerCase():ue};return d.replace(Y,function(L,Z){return Z||function(le){switch(le){case"YY":return String(s.$y).slice(-2);case"YYYY":return g.s(s.$y,4,"0");case"M":return V+1;case"MM":return g.s(V+1,2,"0");case"MMM":return z(o.monthsShort,V,F,3);case"MMMM":return z(F,V);case"D":return s.$D;case"DD":return g.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return z(o.weekdaysMin,s.$W,D,2);case"ddd":return z(o.weekdaysShort,s.$W,D,3);case"dddd":return D[s.$W];case"H":return String(y);case"HH":return g.s(y,2,"0");case"h":return P(1);case"hh":return P(2);case"a":return q(y,w,!0);case"A":return q(y,w,!1);case"m":return String(w);case"mm":return g.s(w,2,"0");case"s":return String(s.$s);case"ss":return g.s(s.$s,2,"0");case"SSS":return g.s(s.$ms,3,"0");case"Z":return u}return null}(L)||u.replace(":","")})},a.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},a.diff=function(t,s,o){var d,u=this,y=g.p(s),w=M(t),V=(w.utcOffset()-this.utcOffset())*T,D=this-w,F=function(){return g.m(u,w)};switch(y){case _:d=F()/12;break;case h:d=F();break;case v:d=F()/3;break;case f:d=(D-V)/6048e5;break;case i:d=(D-V)/864e5;break;case U:d=D/R;break;case A:d=D/T;break;case k:d=D/I;break;default:d=D}return o?d:g.a(d)},a.daysInMonth=function(){return this.endOf(h).$D},a.$locale=function(){return B[this.$L]},a.locale=function(t,s){if(!t)return this.$L;var o=this.clone(),d=re(t,s,!0);return d&&(o.$L=d),o},a.clone=function(){return g.w(this.$d,this)},a.toDate=function(){return new Date(this.valueOf())},a.toJSON=function(){return this.isValid()?this.toISOString():null},a.toISOString=function(){return this.$d.toISOString()},a.toString=function(){return this.$d.toUTCString()},r}(),se=ie.prototype;return M.prototype=se,[["$ms",H],["$s",k],["$m",A],["$H",U],["$W",i],["$M",h],["$y",_],["$D",W]].forEach(function(r){se[r[1]]=function(a){return this.$g(a,r[0],r[1])}}),M.extend=function(r,a){return r.$i||(r(a,ie,M),r.$i=!0),M},M.locale=re,M.isDayjs=me,M.unix=function(r){return M(1e3*r)},M.en=B[ne],M.Ls=B,M.p={},M})})(dt);function ct(O){return et("/api/v1/back_stage/version/add",O)}function mt(O,p,I){return Ve(`/api/v1/back_stage/version/modify?version=${O}&system=${p}`,I).then(T=>{if(!T)throw new Error("请求失败，未返回响应数据");return T})}function ft(O){return Ve("/api/v1/back_stage/version/timed_publish",O).then(p=>{if(!p)throw new Error("请求失败，未返回响应数据");return p})}function pt(O){return Te("/api/v1/back_stage/notice/list",O)}function vt(O){return Ce("/api/v1/back_stage/notice/add",O).then(p=>{if(!p)throw new Error("请求失败，未返回响应数据");return p})}function gt(O){return Ve(`/api/v1/back_stage/notice/delete?id=${O}`).then(p=>{if(!p)throw new Error("请求失败，未返回响应数据");return p})}function ht(O){return Ce("/api/v1/back_stage/notice/push",O).then(p=>{if(!p)throw new Error("请求失败，未返回响应数据");return p})}function yt(){return Te("/api/v1/back_stage/notice/type")}var bt={exports:{}};(function(O,p){(function(I,T){T()})(ce,function(){function I(i,f){return typeof f>"u"?f={autoBom:!1}:typeof f!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),f={autoBom:!f}),f.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}function T(i,f,h){var v=new XMLHttpRequest;v.open("GET",i),v.responseType="blob",v.onload=function(){U(v.response,f,h)},v.onerror=function(){console.error("could not download file")},v.send()}function R(i){var f=new XMLHttpRequest;f.open("HEAD",i,!1);try{f.send()}catch{}return 200<=f.status&&299>=f.status}function H(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(f)}}var k=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ce=="object"&&ce.global===ce?ce:void 0,A=k.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),U=k.saveAs||(typeof window!="object"||window!==k?function(){}:"download"in HTMLAnchorElement.prototype&&!A?function(i,f,h){var v=k.URL||k.webkitURL,_=document.createElement("a");f=f||i.name||"download",_.download=f,_.rel="noopener",typeof i=="string"?(_.href=i,_.origin===location.origin?H(_):R(_.href)?T(i,f,h):H(_,_.target="_blank")):(_.href=v.createObjectURL(i),setTimeout(function(){v.revokeObjectURL(_.href)},4e4),setTimeout(function(){H(_)},0))}:"msSaveOrOpenBlob"in navigator?function(i,f,h){if(f=f||i.name||"download",typeof i!="string")navigator.msSaveOrOpenBlob(I(i,h),f);else if(R(i))T(i,f,h);else{var v=document.createElement("a");v.href=i,v.target="_blank",setTimeout(function(){H(v)})}}:function(i,f,h,v){if(v=v||open("","_blank"),v&&(v.document.title=v.document.body.innerText="downloading..."),typeof i=="string")return T(i,f,h);var _=i.type==="application/octet-stream",W=/constructor/i.test(k.HTMLElement)||k.safari,oe=/CriOS\/[\d]+/.test(navigator.userAgent);if((oe||_&&W||A)&&typeof FileReader<"u"){var X=new FileReader;X.onloadend=function(){var N=X.result;N=oe?N:N.replace(/^data:[^;]*;/,"data:attachment/file;"),v?v.location.href=N:location=N,v=null},X.readAsDataURL(i)}else{var Y=k.URL||k.webkitURL,te=Y.createObjectURL(i);v?v.location=te:location.href=te,v=null,setTimeout(function(){Y.revokeObjectURL(te)},4e4)}});k.saveAs=U.saveAs=U,O.exports=U})})(bt);const wt={class:"mb-4"},_t={class:"filters-row"},Vt={class:"table-responsive"},$t=["title"],kt={class:"action-container"},Dt={class:"dialog-header"},Mt={class:"dialog-content"},xt={class:"version-info"},St={class:"system-highlight"},Ot={class:"system-highlight"},Ut={class:"dialog-header"},Tt={class:"modal-content"},Ct={class:"flex justify-end gap-4"},At={class:"flex justify-end mt-4"},Lt={class:"ml-4 self-center text-gray-600"},Et={__name:"notice",setup(O){const{init:p}=ot();at("addFormRef");const I=c(!1);c(null),c(null);const T=c(null),R=c(""),H=c(""),k=c(!1),A=c(""),U=c(""),i=c(""),f=c(""),h=c(""),v=c([]),_=c([]),W=c([]),oe=l=>{T.value=l.id,I.value=!0},X=l=>l.map(e=>({value:e,text:e})),Y=async()=>{try{const l=await yt(),e={value:"",text:"所有"};v.value=[e,...X(l||[])],_.value=X(l||[]);const C=await tt();W.value=[e,...X(C||[])]}catch(l){p({message:l,color:"danger"})}},te=()=>A.value.trim().length,N=()=>U.value.trim().length,pe=()=>i.value.trim().length,ne=()=>te()>0&&te()<=50&&N()>0&&N()<=100&&pe()>0&&pe()<=2e3&&f.value!=""&&h.value!="",B=()=>{A.value="",U.value="",i.value="",f.value="",h.value=""},ve=async()=>{if(!ne()){p({message:"请检查输入内容是否符合要求",color:"danger"});return}const l={title:A.value,title_en:A.value,spec:U.value,spec_en:U.value,content:i.value,content_en:i.value,type:h.value.value,belonged_user:f.value.value};try{await vt(l),p({message:"新增成功",color:"rgb(47, 148, 172)"})}catch(e){p({message:`删除失败: ${e.message||"未知错误"}`,color:"danger"})}finally{Q(),B(),k.value=!1}},me=()=>{B(),k.value=!1},re=async()=>{try{await gt(T.value),p({message:"删除成功",color:"rgb(47, 148, 172)"})}catch(l){p({message:`删除失败: ${l.message||"未知错误"}`,color:"danger"})}finally{Q(),Y(),I.value=!1}},M=()=>{p({message:"已取消删除",color:"info"}),I.value=!1};c({}),c({}),fe({});const g=c([{value:"",text:"所有"},{value:"ios",text:"IOS"},{value:"android",text:"Android"}]),ie=c([{value:"ios",text:"IOS"},{value:"android",text:"Android"}]),se=c(g[0]);c();const r=c(new Date),a=c(new Date),t=c(!1);c(new Date);const s=c({}),o=l=>!!l||"必须选择时间",d=l=>{const e=new Date;return new Date(l)<=e?"时间必须晚于当前":!0},u=fe({version:"",system:""}),y=we(()=>o(a.value)===!0&&d(r.value)===!0);we(()=>["0",0].includes(s.value.is_latest));const w=c(1),V=c(0),D=c([]),F=c(!1),K=c(0),z=c(!1);c(null),c(null),c(null),c(null);const P=c(""),q=c(""),L=l=>{K.value=l.rowData.id,P.value=l.rowData.belonged_user,q.value=l.rowData.type,z.value=!0},Z=async l=>{const e={uid:P.value,notice_id:K.value};try{const C=await ht(e);p({message:C,color:"success"})}catch(C){p({message:C.message||"发布失败",color:"danger"})}finally{z.value=!1}},le=async()=>{const l=a.value;l.setHours(r.value.getHours()),l.setMinutes(r.value.getMinutes()),l.setSeconds(0);const e={version:u.version,system:u.system,release_time:l.toLocaleString()};try{await je(e)}catch{}finally{t.value=!1}},ue=()=>{z.value=!1},$e=l=>l?/^v\d+\.\d+\.\d+(-[a-zA-Z0-9]+)?$/.test(l)||"格式示例：v1.0.0 或 v2.3.4-beta":"版本号不能为空",ke=l=>{if(!l)return"下载链接不能为空";try{return new URL(l),!0}catch{return"请输入有效的URL地址"}};we(()=>(console.log("version is",$.version),console.log("download_url is",$.download_url),$e($.version)===!0&&ke($.download_url)===!0));const de=fe({page:1,pagesize:15}),ge=c(!1);c(!1);const $=fe({version:"",system:"",download_url:"",release_notes:"",release_notes_en:""}),Ae=()=>{k.value=!0},Le=(l,e)=>l?l.length>e?l.slice(0,e)+"...":l:"",Q=async()=>{var l,e;F.value=!0;try{const C={page:de.page,pagesize:de.pagesize,content:R==null?void 0:R.value,type:(l=H.value)==null?void 0:l.value};se&&(C.system=(e=se.value)==null?void 0:e.value);const J=await pt(C);J!=null&&J.notices?(D.value=J.notices,V.value=J.total):(D.value=[],V.value=0)}catch(C){console.error("获取数据失败:",C),p({message:C.message||"获取数据失败",color:"danger"}),D.value=[],V.value=0}finally{F.value=!1}};lt([se,R,H],()=>{de.page=1,w.value=1,Q(),Y()});const Ee=[{key:"id",label:"序号"},{key:"type",label:"通知类型"},{key:"title",label:"标题"},{key:"spec",label:"概览"},{key:"belonged_user",label:"推送用户"},{key:"created_time",label:"通知时间"},{key:"is_published",label:"推送状态"},{key:"actions",label:"操作"}],he=c(!1),x=fe({version:"",system:"",release_notes:"",release_notes_en:"",download_url:""}),Fe=async()=>{try{const l=await mt(x.version,x.system,{download_url:x.download_url,release_notes:x.release_notes,release_notes_en:x.release_notes_en});p({message:l,color:"success"}),await Q(),he.value=!1}catch(l){console.error("修改失败:",l),p({message:l.message||"修改失败",color:"danger"})}},je=async l=>{try{const e=await ft(l);p({message:e,color:"success",duration:3e4}),await Q(),Y()}catch(e){p({message:e.message||"定时发布失败",color:"danger",duration:5e3})}},Ie=async()=>{var l;try{const e=await ct({version:$.version,system:(l=$.system)==null?void 0:l.value,download_url:$.download_url,release_notes:$.release_notes,release_notes_en:$.release_notes_en});p({message:e,color:"success"}),await Q(),ge.value=!1}catch(e){console.error("修改失败:",e),p({message:e.message||"修改失败",color:"danger"})}},He=()=>{he.value=!1,Ne()},Re=()=>{t.value=!1},ze=()=>{ge.value=!1,We()},Ne=()=>{x.version="",x.system="",x.download_url="",x.release_notes="",x.release_notes_en=""},We=()=>{$.version="",$.system="",$.download_url="",$.release_notes="",$.release_notes_en=""},Ye=l=>{de.page=Math.ceil(l/de.pagesize),w.value=l,Q(),Y()},Be=()=>{se.value="",R.value="",H.value="",Q(),Y()};return Q(),Y(),(l,e)=>{const C=E("va-input"),J=E("va-select"),ae=E("va-button"),ee=E("VaInput"),De=E("VaForm"),ye=E("VaModal"),Me=E("va-button-group"),Pe=E("VaDataTable"),qe=E("VaDateInput"),Ze=E("VaTimeInput"),xe=E("va-modal"),Se=E("va-icon"),Je=E("va-divider"),Ge=E("VaTextarea"),Xe=E("VaPagination"),Ke=E("va-card");return be(),Oe(Ke,{class:"machines-list"},{default:b(()=>[S("div",wt,[S("div",_t,[e[29]||(e[29]=j(" 内容查询： ")),m(C,{modelValue:R.value,"onUpdate:modelValue":e[0]||(e[0]=n=>R.value=n),placeholder:"请输入消息内容",class:"mb-1 mr-6",style:{maxWidth:"13%"}},{prepend:b(()=>e[26]||(e[26]=[])),_:1},8,["modelValue"]),e[30]||(e[30]=j(" 类型筛选： ")),m(J,{modelValue:H.value,"onUpdate:modelValue":e[1]||(e[1]=n=>H.value=n),options:v.value,placeholder:"请选择通知类型",class:"mb-1",style:{maxWidth:"16%"}},null,8,["modelValue","options"]),m(ae,{onClick:Ae,color:"rgb(47, 148, 172)",class:"mb-1 ml-6"},{default:b(()=>e[27]||(e[27]=[j(" 新增通知 ")])),_:1}),m(ae,{onClick:Be,color:"rgb(47, 148, 172)",class:"mb-1 ml-6"},{default:b(()=>e[28]||(e[28]=[j(" 刷新 ")])),_:1}),m(ye,{modelValue:ge.value,"onUpdate:modelValue":e[7]||(e[7]=n=>ge.value=n),title:"新增版本",onCancel:ze,onOk:Ie,"ok-disabled":!0},{default:b(()=>[m(De,null,{default:b(()=>[m(ee,{modelValue:$.version,"onUpdate:modelValue":e[2]||(e[2]=n=>$.version=n),label:"版本号",rules:[$e],required:"",class:"mb-2",placeholder:"v1.0.0"},null,8,["modelValue","rules"]),m(J,{modelValue:$.system,"onUpdate:modelValue":e[3]||(e[3]=n=>$.system=n),label:"操作系统",options:ie.value,placeholder:"IOS",class:"mb-2"},null,8,["modelValue","options"]),m(ee,{modelValue:$.download_url,"onUpdate:modelValue":e[4]||(e[4]=n=>$.download_url=n),label:"下载链接",type:"url",rules:[ke],required:"",class:"mb-2",placeholder:"https://apps.apple.com/app/..."},null,8,["modelValue","rules"]),m(ee,{modelValue:$.release_notes,"onUpdate:modelValue":e[5]||(e[5]=n=>$.release_notes=n),label:"更新日志 (如需换行请用','隔开)",type:"textarea",class:"mb-2"},null,8,["modelValue"]),m(ee,{modelValue:$.release_notes_en,"onUpdate:modelValue":e[6]||(e[6]=n=>$.release_notes_en=n),label:"更新日志英文版 (如需换行请用','隔开)",type:"textarea",class:"mb-2"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])])]),S("div",Vt,[m(Pe,{items:D.value,columns:Ee,striped:"",class:"responsive-table"},{"cell(created_time)":b(({value:n})=>[j(G(rt(nt)(n)),1)]),"cell(spec)":b(({value:n})=>[n?(be(),Ue("a",{key:1,title:n,target:"_blank"},G(Le(n,45)),9,$t)):(be(),Ue(it,{key:0},[j("无")],64))]),"cell(belonged_user)":b(({value:n})=>[j(G(n===""?"所有":n),1)]),"cell(is_published)":b(({value:n})=>[j(G(n==="0"?"未推送":"已推送"),1)]),"cell(actions)":b(({row:n})=>[S("div",kt,[m(Me,null,{default:b(()=>[n.rowData.is_published===0?(be(),Oe(ae,{key:0,icon:"rocket_launch",size:"small",color:"rgb(47, 148, 172)",title:"推送",onClick:Qe=>L(n),class:"action-icon"},null,8,["onClick"])):ut("",!0),m(ae,{size:"small",icon:"delete",color:"rgb(208, 24, 39)",title:"删除版本",onClick:Qe=>oe(n.rowData),class:"action-icon"},null,8,["onClick"])]),_:2},1024)])]),_:1},8,["items"]),m(ye,{modelValue:he.value,"onUpdate:modelValue":e[13]||(e[13]=n=>he.value=n),title:"修改通知",onCancel:He,onOk:Fe,"ok-props":{color:"rgb(47, 148, 172)",textColor:"white"},"cancel-props":{color:"rgb(47, 148, 172)",textColor:"white"}},{default:b(()=>[m(De,null,{default:b(()=>[m(ee,{modelValue:x.version,"onUpdate:modelValue":e[8]||(e[8]=n=>x.version=n),label:"标题",type:"string",class:"mb-3",readonly:""},null,8,["modelValue"]),m(ee,{modelValue:x.system,"onUpdate:modelValue":e[9]||(e[9]=n=>x.system=n),label:"通知类型",type:"string",class:"mb-3",readonly:""},null,8,["modelValue"]),m(ee,{modelValue:x.download_url,"onUpdate:modelValue":e[10]||(e[10]=n=>x.download_url=n),label:"概览",type:"string",class:"mb-3"},null,8,["modelValue"]),m(ee,{modelValue:x.release_notes,"onUpdate:modelValue":e[11]||(e[11]=n=>x.release_notes=n),label:"推送用户",type:"textarea",class:"mb-3"},null,8,["modelValue"]),m(ee,{modelValue:x.release_notes_en,"onUpdate:modelValue":e[12]||(e[12]=n=>x.release_notes_en=n),label:"更新日志英文版 (如需换行请用','隔开)",type:"textarea",class:"mb-3"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),m(xe,{modelValue:t.value,"onUpdate:modelValue":e[16]||(e[16]=n=>t.value=n),"hide-default-actions":"",title:"选择发布时间"},{default:b(()=>[m(qe,{modelValue:a.value,"onUpdate:modelValue":e[14]||(e[14]=n=>a.value=n)},null,8,["modelValue"]),m(Ze,{modelValue:r.value,"onUpdate:modelValue":e[15]||(e[15]=n=>r.value=n),class:"ml-2"},null,8,["modelValue"]),m(Me,null,{default:b(()=>[m(ae,{block:"",onClick:Re,color:"rgb(47, 148, 172)",class:"mt-4"},{default:b(()=>e[31]||(e[31]=[j(" 取消 ")])),_:1}),m(ae,{block:"",onClick:le,disabled:!y.value,color:"rgb(47, 148, 172)",class:"mt-4 ml-2"},{default:b(()=>e[32]||(e[32]=[j(" 确认发布 ")])),_:1},8,["disabled"])]),_:1})]),_:1},8,["modelValue"]),m(ye,{modelValue:z.value,"onUpdate:modelValue":e[17]||(e[17]=n=>z.value=n),title:"系统提示","ok-text":"确认推送","cancel-text":"暂不推送",onOk:Z,onCancel:ue},{header:b(()=>[S("div",Dt,[m(Se,{name:"warning",color:"warning"}),e[33]||(e[33]=S("span",{class:"header-text"},"消息推送确认",-1))])]),default:b(()=>[S("div",Mt,[S("p",xt,[e[34]||(e[34]=j(" 即将为 ")),S("span",St,G(P.value===""?"所有":P.value),1),e[35]||(e[35]=j(" 用户推送 ")),S("span",Ot,G(q.value),1),e[36]||(e[36]=j(" 类型通知 "))]),m(Je)])]),_:1},8,["modelValue"]),m(ye,{modelValue:I.value,"onUpdate:modelValue":e[18]||(e[18]=n=>I.value=n),title:"系统提示",size:"small",message:l.deleteConfirmMessage,onOk:re,onCancel:M,"ok-text":"确认","cancel-text":"取消","ok-props":{color:"danger"}},{header:b(()=>[S("div",Ut,[m(Se,{name:"warning",color:"warning"}),e[37]||(e[37]=S("span",{class:"header-text"},"确认删除？",-1))])]),_:1},8,["modelValue","message"]),m(xe,{modelValue:k.value,"onUpdate:modelValue":e[24]||(e[24]=n=>k.value=n),"hide-default-actions":"",size:"medium"},{header:b(()=>e[38]||(e[38]=[S("h5",{class:"va-h5"},"发布新通知",-1)])),default:b(()=>[S("div",Tt,[m(C,{modelValue:A.value,"onUpdate:modelValue":e[19]||(e[19]=n=>A.value=n),label:"标题",placeholder:"请输入标题...",class:"mb-4","max-length":50,counter:""},{counter:b(({valueLength:n})=>[S("span",{class:_e({"text-danger":n>50})},G(n)+"/50 ",3)]),_:1},8,["modelValue"]),m(J,{modelValue:h.value,"onUpdate:modelValue":e[20]||(e[20]=n=>h.value=n),options:_.value,label:"通知类型",placeholder:"请选择通知类型",class:"mb-4",style:{maxWidth:"47.5%"}},null,8,["modelValue","options"]),m(J,{modelValue:f.value,"onUpdate:modelValue":e[21]||(e[21]=n=>f.value=n),options:W.value,label:"用户UID",placeholder:"请选择用户UID",class:"mb-4 ml-8",style:{maxWidth:"47.5%"}},null,8,["modelValue","options"]),m(C,{modelValue:U.value,"onUpdate:modelValue":e[22]||(e[22]=n=>U.value=n),label:"概述",placeholder:"请输入概述...",class:"mb-4","max-length":100,counter:""},{counter:b(({valueLength:n})=>[S("span",{class:_e({"text-danger":n>100})},G(n)+"/100 ",3)]),_:1},8,["modelValue"]),m(Ge,{modelValue:i.value,"onUpdate:modelValue":e[23]||(e[23]=n=>i.value=n),label:"内容 (支持HTML语言)",placeholder:"请输入详细内容...",autosize:"","min-rows":10,"max-rows":20,"max-length":2e3,counter:"",class:"mb-6",style:{width:"1000px"}},{counter:b(({valueLength:n})=>[S("span",{class:_e({"text-danger":n>2e3})},G(n)+"/2000 ",3)]),_:1},8,["modelValue"]),S("div",Ct,[m(ae,{color:"secondary",onClick:me},{default:b(()=>e[39]||(e[39]=[j(" 取消 ")])),_:1}),m(ae,{disabled:!ne,onClick:ve},{default:b(()=>e[40]||(e[40]=[j(" 确认发布 ")])),_:1},8,["disabled"])])])]),_:1},8,["modelValue"])]),S("div",At,[m(Xe,{modelValue:w.value,"onUpdate:modelValue":[e[25]||(e[25]=n=>w.value=n),Ye],"page-size":de.pagesize,"visible-pages":"5",total:V.value,"buttons-preset":"secondary","boundary-numbers":""},null,8,["modelValue","page-size","total"]),S("span",Lt," 共 "+G(V.value)+" 条记录 ",1)])]),_:1})}}},Nt=st(Et,[["__scopeId","data-v-952ea62a"]]);export{Nt as default};
//# sourceMappingURL=notice-BpcYSDHb.js.map
