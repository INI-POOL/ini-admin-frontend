import{u as me}from"./useToast-CDxkwnHH.js";import{p as O,g as ve}from"./request-sRQiuwxY.js";import{f as R}from"./date-CMM1G54V.js";import{a as pe}from"./user-BQd5ON8D.js";import{_ as _e,U as q,r as v,o as fe,c as z,b as t,t as r,h as n,w as l,I as ge,f as i,a as c,i as u,u as b,g as _,k as U}from"./index-CHwleGDh.js";function ye(V){return O("/api/v1/back_stage/withdraw/list",V)}function be(V){return O("/api/v1/back_stage/withdraw/audit",V)}function Ve(){return ve("/api/v1/back_stage/hot_address/balance")}function T(V){let d=V.toString();return d.includes(".")&&(d=d.replace(/\.?0+$/,"")),d}const ke={class:"withdraw-list"},xe={class:"mb-4"},we={class:"text-2xl font-bold"},Ce=["onClick"],De={class:"action-buttons",style:{"text-align":"center"}},ze={key:2},Te={class:"flex justify-end mt-4"},Ae={class:"ml-4 self-center text-gray-600"},Be={key:0,class:"text-center p-4"},Ue={key:1},he={class:"grid grid-cols-2 gap-4"},$e={key:2,class:"text-danger p-4"},Ie={class:"space-y-4"},Se={class:"mb-4"},Pe={class:"transfer-header",style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",gap:"0.62rem","padding-top":"1rem"}},We={class:"status"},Me={class:"time"},Ne={class:"transfer-info"},Le={class:"info-row"},je={class:"value-box"},Ee={class:"value"},Fe={class:"info-row"},He={class:"value-box"},Re={class:"value"},qe={class:"info-row"},Oe={class:"value-box"},Ze={class:"info-row"},Ge={class:"value-box"},Je={class:"transaction-id"},Ke={class:"value-box"},Qe={class:"value"},Xe=["href"],Ye={__name:"WithdrawList",setup(V){const{init:d}=me(),Z=[{key:"id",label:"订单号"},{key:"uid",label:"用户编号"},{key:"mobile",label:"手机号"},{key:"amount",label:"提现金额"},{key:"gas_fee",label:"gas费"},{key:"currency",label:"币种"},{key:"status",label:"提现状态"},{key:"audit_status",label:"审核状态",sortable:!0},{key:"created_time",label:"申请时间",sortable:!0},{key:"action",label:"操作"}],k=q({page:1,pagesize:10}),L=v([]),A=v(0),h=v(1),$=v(!1),I=async()=>{$.value=!0;try{const a=await ye(k);a&&typeof a.Total=="number"?(L.value=a.Withdraws||[],A.value=parseInt(a.Total)):(console.error("API返回数据格式错误:",a),d({message:"数据格式错误",color:"danger"}))}catch(a){console.error("获取数据失败:",a),d({message:"获取数据失败",color:"danger"})}finally{$.value=!1}},w=async a=>{if(navigator.clipboard)navigator.clipboard.writeText(a).then(()=>{d({message:"复制成功",color:"success"})}).catch(e=>{d({message:"复制成功",color:"success"})});else{const e=document.createElement("textarea");e.value=a,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),d({message:"复制成功",color:"success"})}},G=a=>{k.page=Math.ceil(a/k.pagesize),h.value=a,I()},j=(a,e)=>{const m={0:"处理中",1:"成功",2:"失败",3:"确认中",4:"提现异常"};return console.log(a,e),a==2&&e>15?"Aleo网络异常":m[a]||"未知状态"},J=a=>{const e={0:"warning",1:"success",2:"info",3:"danger"};let m=e[a]||"primary";return console.log(e[a]),m},K=a=>({0:"待审核",1:"已通过",2:"未通过"})[a]||"未知状态",Q=a=>({0:"warning",1:"success",2:"danger"})[a]||"primary",B=v(!1),C=v(null),p=q({audit_status:1}),S=v(!1),P=v(!1),y=v(null),X=a=>{a&&(C.value=a.rowData,p.audit_status=1,B.value=!0)},Y=async a=>{console.log("row is",a),S.value=!0,P.value=!0;let e={page:1,pagesize:10,uid:a.uid,currency:a.currency};try{const m=await pe(e);console.log("response is",m),y.value=m==null?void 0:m[0]}catch(m){console.error("获取用户详情失败:",m),y.value=null}finally{P.value=!1}},ee=async()=>{if(!C.value)return;let a=ge();if(!p.google_code){d({message:"谷歌认证码不能为空",color:"danger"});return}try{let e=await be({id:C.value.id,audit_status:p.audit_status,google_code:p.google_code,user_name:a});console.log("data is",e),e==0?d({message:"审核失败, 余额不足",color:"warning"}):(d({message:"审核成功",color:"success"}),B.value=!1,I())}catch(e){d({message:e,color:"danger"})}},W=v(!1),o=v(null),te=a=>{if(!a){console.error("行数据为空");return}o.value=a.rowData,p.audit_status=1,W.value=!0},E=v(0),ae=async()=>{try{const a=await Ve();a?E.value=parseFloat(a):console.error("热钱包余额获取失败:",a)}catch(a){console.error("热钱包余额获取失败:",a)}};return fe(()=>{I(),ae()}),(a,e)=>{const m=i("VaBadge"),F=i("VaButton"),se=i("VaDataTable"),le=i("VaPagination"),oe=i("VaCardContent"),ne=i("VaCard"),re=i("VaProgressCircle"),x=i("va-text"),ie=i("va-card-content"),ue=i("va-card"),M=i("VaModal"),de=i("VaRadio"),ce=i("VaInput"),D=i("VaAvatar"),H=i("VaDivider"),N=i("VaIcon");return c(),z("div",ke,[t("div",xe,[t("h1",we,"提现管理  (热钱包余额："+r(E.value||0)+")",1)]),n(ne,null,{default:l(()=>[n(oe,null,{default:l(()=>[n(se,{items:L.value,loading:$.value,columns:Z,"items-per-page":k.pagesize,"current-page":k.page,"total-items":A.value,selectable:!1,"show-select":!1,hoverable:"",class:"responsive-table"},{"cell(amount)":l(({value:s})=>[u(r(b(T)(s)),1)]),"cell(gas_fee)":l(({value:s})=>[u(r(b(T)(s)),1)]),"cell(uid)":l(({row:s})=>[t("span",{class:"text-primary cursor-pointer hover:underline",onClick:f=>Y(s.rowData)},r(s.rowData.uid),9,Ce)]),"cell(status)":l(({row:s})=>[n(m,{color:J(s.rowData.status)},{default:l(()=>[u(r(j(s.rowData.status,s.rowData.id)),1)]),_:2},1032,["color"])]),"cell(audit_status)":l(({value:s})=>[n(m,{color:Q(s)},{default:l(()=>[u(r(K(s)),1)]),_:2},1032,["color"])]),"cell(created_time)":l(({value:s})=>[u(r(b(R)(s)),1)]),"cell(action)":l(({row:s})=>[t("div",De,[s?(c(),_(F,{key:0,size:"small",preset:"primary",onClick:f=>te(s)},{default:l(()=>e[11]||(e[11]=[u(" 查看 ")])),_:2},1032,["onClick"])):U("",!0),s&&Number(s.rowData.audit_status)===0?(c(),_(F,{key:1,size:"small",preset:"primary",onClick:f=>X(s)},{default:l(()=>e[12]||(e[12]=[u(" 审核 ")])),_:2},1032,["onClick"])):(c(),z("span",ze,"--"))])]),_:1},8,["items","loading","items-per-page","current-page","total-items"]),t("div",Te,[n(le,{modelValue:h.value,"onUpdate:modelValue":[e[0]||(e[0]=s=>h.value=s),G],"page-size":k.pagesize,"visible-pages":"5",total:A.value,"buttons-preset":"secondary","boundary-numbers":""},null,8,["modelValue","page-size","total"]),t("span",Ae," 共 "+r(A.value)+" 条记录 ",1)])]),_:1})]),_:1}),n(M,{modelValue:S.value,"onUpdate:modelValue":e[1]||(e[1]=s=>S.value=s),title:"用户详情",size:"medium","hide-default-actions":""},{default:l(()=>[P.value?(c(),z("div",Be,[n(re,{indeterminate:""})])):y.value?(c(),z("div",Ue,[n(ue,{class:"mb-1"},{default:l(()=>[n(ie,null,{default:l(()=>[t("div",he,[t("div",null,[n(x,{class:"font-bold"},{default:l(()=>e[13]||(e[13]=[u("总收益：")])),_:1}),n(x,null,{default:l(()=>[u(r((y.value.balance_amount||0)+(y.value.total_withdraw||0)),1)]),_:1}),e[16]||(e[16]=t("br",null,null,-1)),e[17]||(e[17]=t("br",null,null,-1)),n(x,{class:"font-bold"},{default:l(()=>e[14]||(e[14]=[u("当前余额：")])),_:1}),n(x,null,{default:l(()=>[u(r(y.value.balance_amount||0),1)]),_:1}),e[18]||(e[18]=t("br",null,null,-1)),e[19]||(e[19]=t("br",null,null,-1)),n(x,{class:"font-bold"},{default:l(()=>e[15]||(e[15]=[u("已提现 (含手续费)：")])),_:1}),n(x,null,{default:l(()=>[u(r(y.value.total_withdraw||0),1)]),_:1})])])]),_:1})]),_:1})])):(c(),z("div",$e," 数据加载失败，请重试。 "))]),_:1},8,["modelValue"]),n(M,{modelValue:B.value,"onUpdate:modelValue":e[4]||(e[4]=s=>B.value=s),title:"提现审核","ok-text":"确认","cancel-text":"取消",size:"small",class:"audit-modal",onOk:ee},{default:l(()=>{var s,f;return[t("div",Ie,[t("div",null,[t("div",Se," 当前提现金额："+r(b(T)((s=C.value)==null?void 0:s.amount)||0)+" "+r(((f=C.value)==null?void 0:f.currency)||""),1),e[20]||(e[20]=t("div",{class:"mb-2"},"审核结果",-1)),n(de,{modelValue:p.audit_status,"onUpdate:modelValue":e[2]||(e[2]=g=>p.audit_status=g),options:[{text:"同意",value:1},{text:"拒绝",value:2}],"value-by":"value"},null,8,["modelValue"]),e[21]||(e[21]=t("div",{class:"mb-2",style:{"padding-top":"0.62rem"}},"谷歌认证",-1)),n(ce,{modelValue:p.google_code,"onUpdate:modelValue":e[3]||(e[3]=g=>p.google_code=g),width:"200px",placeholder:"请输入谷歌认证码"},null,8,["modelValue"])])])]}),_:1},8,["modelValue"]),n(M,{modelValue:W.value,"onUpdate:modelValue":e[10]||(e[10]=s=>W.value=s),title:"转账详情",size:"medium",class:"mr-6 my-1","close-button":""},{content:l(()=>{var s,f;return[t("div",Pe,[o.value.status===0?(c(),_(D,{key:0,color:"info"},{default:l(()=>e[22]||(e[22]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," more_horiz ",-1)])),_:1})):o.value.status===1?(c(),_(D,{key:1,color:"success"},{default:l(()=>e[23]||(e[23]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," check ",-1)])),_:1})):o.value.status===2?(c(),_(D,{key:2,color:"danger"},{default:l(()=>e[24]||(e[24]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," close ",-1)])),_:1})):o.value.status===3?(c(),_(D,{key:3,color:"warning"},{default:l(()=>e[25]||(e[25]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," directory_sync ",-1)])),_:1})):o.value.status===4?(c(),_(D,{key:4,color:"danger"},{default:l(()=>e[26]||(e[26]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," check ",-1)])),_:1})):U("",!0),t("div",We,r(j(o.value.status,o.value.id)),1),t("div",Me,r(b(R)(o.value.created_time)),1)]),n(H),t("div",Ne,[t("div",Le,[e[27]||(e[27]=t("span",{class:"label"},"数额：",-1)),t("div",je,[t("span",Ee,r(b(T)((s=o.value)==null?void 0:s.amount)||0)+" "+r(o.value.currency),1)])]),t("div",Fe,[e[28]||(e[28]=t("span",{class:"label"},"提款手续费：",-1)),t("div",He,[t("span",Re,r(b(T)((f=o.value)==null?void 0:f.gas_fee)||0)+" "+r(o.value.currency),1)])]),t("div",qe,[e[30]||(e[30]=t("span",{class:"label"},"收款地址：",-1)),t("div",Oe,[t("span",{class:"value",onClick:e[5]||(e[5]=g=>w(o.value.to_addr))},r(o.value.to_addr),1),n(N,{class:"material-icons",onClick:e[6]||(e[6]=g=>w(o.value.to_addr))},{default:l(()=>e[29]||(e[29]=[u(" content_copy ")])),_:1})])]),t("div",Ze,[e[32]||(e[32]=t("span",{class:"label"},"付款地址：",-1)),t("div",Ge,[t("span",{class:"value",onClick:e[7]||(e[7]=g=>w(o.value.from_addr))},r(o.value.from_addr),1),o.value.from_addr?(c(),_(N,{key:0,class:"material-icons",onClick:e[8]||(e[8]=g=>w(o.value.from_addr))},{default:l(()=>e[31]||(e[31]=[u(" content_copy ")])),_:1})):U("",!0)])])]),n(H),t("div",Je,[e[34]||(e[34]=t("span",{class:"label"},"交易号：",-1)),t("div",Ke,[t("span",Qe,[t("a",{href:`https://mainnet.aleo123.io/transactionDetail/${o.value.tx_id}`,target:"_blank"},r(o.value.tx_id),9,Xe)]),o.value.tx_id?(c(),_(N,{key:0,class:"material-icons",onClick:e[9]||(e[9]=g=>w(o.value.tx_id))},{default:l(()=>e[33]||(e[33]=[u(" content_copy ")])),_:1})):U("",!0)])])]}),_:1},8,["modelValue"])])}}},ot=_e(Ye,[["__scopeId","data-v-1dca5ba4"]]);export{ot as default};
//# sourceMappingURL=WithdrawList-VaNQpGTc.js.map
