import{d as q,X as A,r as c,U as L,o as F,f as r,a as k,g as w,w as u,b as y,h as l,u as d,J as I,k as M,i as j,a7 as b,a8 as x}from"./index-56cTcoHO.js";import{u as z}from"./useToast-C_JvB3M6.js";import{v as i,g as C}from"./utils-4CxEKF4m.js";import{i as G,c as D}from"./user-CUL1rSg7.js";import"./request-BJWF0Hoa.js";const E={class:"flex justify-center mt-4"},K=q({__name:"Login",setup(J){const{push:p}=A(),{init:t}=z(),n=c(!1),g=c(0),f=c(0),e=L({username:"",password:"",google_code:"",keepLoggedIn:!1}),h=()=>{e.username.trim()==="umpool"&&g.value===1||e.username.trim()==="admin"&&f.value===1?n.value=!0:n.value=!1};F(async()=>{await U()});const U=async()=>{try{const s=await G("umpool");g.value=s;const o=await G("admin");f.value=o}catch(s){console.error("Error checking Google code requirement:",s)}},v=()=>{if(n.value===!0&&e.google_code==""){t({message:"谷歌认证码不能为空",color:"danger"});return}if(V()&&n.value===!0)D({user_name:e.username,google_code:e.google_code}).then(s=>{if(s===1){const o=C();b(o),x(e.username),t({message:"登陆成功！",color:"success"}),p({name:"withdraw"})}else t({message:"谷歌认证码错误",color:"danger"})}).catch(s=>{s.response?t({message:s.response.data.msg,color:"danger"}):t({message:"无效参数",color:"danger"})});else if(V()&&n.value===!1){const s=C();b(s),x(e.username),t({message:"登陆成功！",color:"success"}),p({name:"withdraw"})}else t({message:"登陆失败！",color:"error"})},V=()=>e.username.trim()==="admin"&&e.password.trim()==="A3f!7#b2Pz9L"||e.username==="umpool"&&e.password==="gT9@pY6uV*2S";return(s,o)=>{const m=r("VaInput"),N=r("VaIcon"),B=r("VaValue"),T=r("VaButton"),S=r("VaForm");return k(),w(S,{ref:"form",onSubmit:I(v,["prevent"])},{default:u(()=>[o[4]||(o[4]=y("h1",{class:"font-semibold text-4xl mb-4"},"登陆",-1)),l(m,{modelValue:e.username,"onUpdate:modelValue":o[0]||(o[0]=a=>e.username=a),rules:[d(i).required,d(i).username],class:"mb-4",label:"用户名",type:"text",onInput:h},null,8,["modelValue","rules"]),l(B,{"default-value":!1},{default:u(a=>[l(m,{modelValue:e.password,"onUpdate:modelValue":o[1]||(o[1]=_=>e.password=_),rules:[d(i).required],type:a.value?"text":"password",class:"mb-4",label:"密码",onClickAppendInner:I(_=>a.value=!a.value,["stop"])},{appendInner:u(()=>[l(N,{name:a.value?"mso-visibility_off":"mso-visibility",class:"cursor-pointer",color:"secondary"},null,8,["name"])]),_:2},1032,["modelValue","rules","type","onClickAppendInner"])]),_:1}),n.value?(k(),w(m,{key:0,modelValue:e.google_code,"onUpdate:modelValue":o[2]||(o[2]=a=>e.google_code=a),class:"mb-4",label:"谷歌验证码",type:"text"},null,8,["modelValue"])):M("",!0),y("div",E,[l(T,{class:"w-full",onClick:v},{default:u(()=>o[3]||(o[3]=[j(" 登陆")])),_:1})])]),_:1},512)}}});export{K as default};
//# sourceMappingURL=Login-Cq45RskG.js.map
