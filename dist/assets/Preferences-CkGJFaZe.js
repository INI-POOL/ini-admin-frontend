import{H as O,d as A,I as M,f as c,a as f,c as S,h as i,w as m,i as _,b as l,t as P,u as x,F as E,r as v,o as j,e as U,g as b,j as V,k as C,J as z}from"./index-98b2TmdF.js";import{u as I}from"./useToast-Bomeq_h3.js";import{i as D,c as R,g as T}from"./user-CJ-gGk7p.js";import"./request-Kt3X7jOf.js";const N=O("user",{state:()=>({userName:"Vasili Savitski",email:"vasili@gmail.com",memberSince:"8/12/2020",pfp:"https://picsum.photos/id/22/200/300",is2FAEnabled:!1}),actions:{toggle2FA(){this.is2FAEnabled=!this.is2FAEnabled},changeUserName(g){this.userName=g}}}),q={class:"flex flex-col justify-center"},H={class:"text-[28px] md:text-[32px] leading-10 font-bold"},J=A({__name:"PreferencesHeader",setup(g){const u=M();return N(),(a,s)=>{const d=c("VaAvatar");return f(),S(E,null,[i(d,{color:"warning"},{default:m(()=>s[0]||(s[0]=[_(" U.M ")])),_:1}),l("div",q,[l("h2",H,P(x(u)),1)])],64)}}}),w={"--va-button-font-size":"14px","--va-button-line-height":"20px"},Y={class:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-6 min-h-[36px] leading-5"},K=A({__name:"Settings",emits:["openNameModal","openResetPasswordModal"],setup(g,{emit:u}){const a=N();I();const s=v(0);j(async()=>{await d()});const d=async()=>{try{const t=M(),r=await D(t);s.value=r}catch(t){console.error("Error checking Google code requirement:",t)}};U(()=>a.is2FAEnabled?"2FA successfully enabled":"2FA successfully disabled"),U(()=>a.is2FAEnabled?{color:"danger",button:"Disable 2FA",content:"Two-Factor Authentication (2FA) is now enabled for your account, adding an extra layer of security to your sign-ins."}:{color:"primary",button:"Set up 2FA",content:"Add an extra layer of security to your account. To sign in, you’ll need to provide a code along with your username and password."});const e=u;return(t,r)=>{const n=c("VaButton"),p=c("VaDivider");return f(),S(E,null,[l("div",Y,[r[2]||(r[2]=l("p",{class:"font-bold w-[200px]"},"绑定谷歌认证器",-1)),r[3]||(r[3]=l("div",{class:"flex-1"},[l("div",{class:"max-w-[748px]"}," 为您的帐户增加一层额外的安全保护。 登录时，除了用户名和密码外，您还需要提供一个谷歌验证码（安全认证器）。 ")],-1)),s.value==0?(f(),b(n,{key:0,style:V(x(w)),class:"w-fit h-fit",preset:"primary",onClick:r[0]||(r[0]=o=>e("openAuthenticationModal"))},{default:m(()=>r[1]||(r[1]=[_(" 绑定 ")])),_:1},8,["style"])):C("",!0)]),i(p)],64)}}}),L={class:"flex flex-col-reverse md:flex-row md:items-center md:justify-end md:space-x-4"},Q=A({__name:"EditNameModal",emits:["cancel"],setup(g,{emit:u}){const a=N(),{init:s}=I(),d=u,e=v(a.userName),t=()=>{if(!e.value||e.value===a.userName)return d("cancel");a.changeUserName(e.value),s({message:"You've successfully changed your name",color:"success"}),d("cancel")};return(r,n)=>{const p=c("VaInput"),o=c("VaButton"),$=c("VaForm"),k=c("VaModal");return f(),b(k,{"mobile-fullscreen":!1,size:"small","hide-default-actions":"","max-width":"380px","model-value":"","close-button":"","onUpdate:modelValue":n[2]||(n[2]=y=>d("cancel"))},{default:m(()=>[n[5]||(n[5]=l("h1",{class:"va-h5 mb-4"},"Reset password",-1)),i($,{ref:"form",onSubmit:z(t,["prevent"])},{default:m(()=>[i(p,{modelValue:e.value,"onUpdate:modelValue":n[0]||(n[0]=y=>e.value=y),class:"mb-4",label:"Name",placeholder:"Name"},null,8,["modelValue"]),l("div",L,[i(o,{style:V(x(w)),preset:"secondary",color:"secondary",onClick:n[1]||(n[1]=y=>d("cancel"))},{default:m(()=>n[3]||(n[3]=[_(" Cancel")])),_:1},8,["style"]),i(o,{style:V(x(w)),class:"mb-4 md:mb-0",type:"submit",onClick:t},{default:m(()=>n[4]||(n[4]=[_(" Save")])),_:1},8,["style"])])]),_:1},512)]),_:1})}}}),W={class:"flex flex-col-reverse md:flex-row md:items-center md:justify-end md:space-x-4"},X={__name:"EditAuthenticationModal",emits:["cancel"],setup(g,{emit:u}){N();const{init:a}=I(),s=u,d=v(),e=v(),t=v(""),r=()=>{if(t.value||a({message:"谷歌认证码错误",color:"danger"}),t.value){const p=M();R({user_name:p,google_code:t.value}).then(o=>{o==1?(a({message:"谷歌认证绑定成功",color:"success"}),s("cancel"),window.location.reload()):(a({message:"谷歌认证绑定失败",color:"danger"}),s("cancel"))}).catch(o=>{a({message:"谷歌认证绑定失败",color:"danger"}),s("cancel")})}};return(async()=>{const p=M(),o=await T(p);e.value=o,console.log(e.value)})(),(p,o)=>{const $=c("VaImage"),k=c("VaInput"),y=c("VaButton"),G=c("VaForm"),h=c("VaModal");return f(),b(h,{"mobile-fullscreen":!1,size:"small","hide-default-actions":"","max-width":"380px","model-value":"","close-button":"","onUpdate:modelValue":o[2]||(o[2]=F=>s("cancel"))},{default:m(()=>[o[5]||(o[5]=l("h1",{class:"va-h5 mb-4"},"谷歌认证",-1)),i(G,{ref_key:"form",ref:d},{default:m(()=>{var F;return[i($,{class:"w-full md:w-1/2 lg:w-1/3",src:(F=e.value)==null?void 0:F.qr_secret},null,8,["src"]),i(k,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=B=>t.value=B),class:"mb-4",label:"Name",placeholder:"请输入谷歌认证码"},null,8,["modelValue"]),l("div",W,[i(y,{style:V(x(w)),preset:"secondary",color:"secondary",onClick:o[1]||(o[1]=B=>s("cancel"))},{default:m(()=>o[3]||(o[3]=[_(" Cancel")])),_:1},8,["style"]),i(y,{style:V(x(w)),class:"mb-4 md:mb-0",type:"submit",onClick:r},{default:m(()=>o[4]||(o[4]=[_(" Save")])),_:1},8,["style"])])]}),_:1},512)]),_:1})}}},Z={class:"flex flex-col p-4 space-y-10 bg-backgroundSecondary rounded-lg"},ee={class:"flex space-x-5"},oe={class:"space-y-4 md:space-y-6"},le=A({__name:"Preferences",setup(g){const u=v(!1),a=v(!1),s=v(!1);return(d,e)=>(f(),S(E,null,[e[5]||(e[5]=l("h1",{class:"page-title"},"双重认证",-1)),l("div",Z,[l("div",ee,[i(J)]),l("div",oe,[i(K,{onOpenNameModal:e[0]||(e[0]=t=>u.value=!0),onOpenResetPasswordModal:e[1]||(e[1]=t=>a.value=!0),onOpenAuthenticationModal:e[2]||(e[2]=t=>s.value=!0)})])]),u.value?(f(),b(Q,{key:0,onCancel:e[3]||(e[3]=t=>u.value=!1)})):C("",!0),s.value?(f(),b(X,{key:1,onCancel:e[4]||(e[4]=t=>s.value=!1)})):C("",!0)],64))}});export{le as default};
//# sourceMappingURL=Preferences-CkGJFaZe.js.map
