import{H as O,d as M,I as F,f as i,a as f,c as S,h as r,w as m,i as _,b as l,t as P,u as x,F as E,r as v,o as j,e as U,g as b,j as V,k as C,J as z}from"./index-CtZFWvXs.js";import{u as I}from"./useToast-DpVhXmZn.js";import{i as D,c as R,g as T}from"./user-Sdwy1VVW.js";import"./request-BjHn9DS3.js";const A=O("user",{state:()=>({userName:"Vasili Savitski",email:"vasili@gmail.com",memberSince:"8/12/2020",pfp:"https://picsum.photos/id/22/200/300",is2FAEnabled:!1}),actions:{toggle2FA(){this.is2FAEnabled=!this.is2FAEnabled},changeUserName(g){this.userName=g}}}),q={class:"flex flex-col justify-center"},H={class:"text-[28px] md:text-[32px] leading-10 font-bold"},J=M({__name:"PreferencesHeader",setup(g){const c=F();return A(),(a,s)=>{const u=i("VaAvatar");return f(),S(E,null,[r(u,{color:"warning"},{default:m(()=>s[0]||(s[0]=[_(" U.M ")])),_:1}),l("div",q,[l("h2",H,P(x(c)),1)])],64)}}}),w={"--va-button-font-size":"14px","--va-button-line-height":"20px"},Y={class:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-6 min-h-[36px] leading-5"},K=M({__name:"Settings",emits:["openNameModal","openResetPasswordModal"],setup(g,{emit:c}){const a=A();I();const s=v(0);j(async()=>{await u()});const u=async()=>{try{const t=await D("umpool");s.value=t}catch(t){console.error("Error checking Google code requirement:",t)}};U(()=>a.is2FAEnabled?"2FA successfully enabled":"2FA successfully disabled"),U(()=>a.is2FAEnabled?{color:"danger",button:"Disable 2FA",content:"Two-Factor Authentication (2FA) is now enabled for your account, adding an extra layer of security to your sign-ins."}:{color:"primary",button:"Set up 2FA",content:"Add an extra layer of security to your account. To sign in, you’ll need to provide a code along with your username and password."});const e=c;return(t,d)=>{const n=i("VaButton"),p=i("VaDivider");return f(),S(E,null,[l("div",Y,[d[2]||(d[2]=l("p",{class:"font-bold w-[200px]"},"绑定谷歌认证器",-1)),d[3]||(d[3]=l("div",{class:"flex-1"},[l("div",{class:"max-w-[748px]"}," 为您的帐户增加一层额外的安全保护。 登录时，除了用户名和密码外，您还需要提供一个谷歌验证码（安全认证器）。 ")],-1)),s.value==0?(f(),b(n,{key:0,style:V(x(w)),class:"w-fit h-fit",preset:"primary",onClick:d[0]||(d[0]=o=>e("openAuthenticationModal"))},{default:m(()=>d[1]||(d[1]=[_(" 绑定 ")])),_:1},8,["style"])):C("",!0)]),r(p)],64)}}}),L={class:"flex flex-col-reverse md:flex-row md:items-center md:justify-end md:space-x-4"},Q=M({__name:"EditNameModal",emits:["cancel"],setup(g,{emit:c}){const a=A(),{init:s}=I(),u=c,e=v(a.userName),t=()=>{if(!e.value||e.value===a.userName)return u("cancel");a.changeUserName(e.value),s({message:"You've successfully changed your name",color:"success"}),u("cancel")};return(d,n)=>{const p=i("VaInput"),o=i("VaButton"),N=i("VaForm"),$=i("VaModal");return f(),b($,{"mobile-fullscreen":!1,size:"small","hide-default-actions":"","max-width":"380px","model-value":"","close-button":"","onUpdate:modelValue":n[2]||(n[2]=y=>u("cancel"))},{default:m(()=>[n[5]||(n[5]=l("h1",{class:"va-h5 mb-4"},"Reset password",-1)),r(N,{ref:"form",onSubmit:z(t,["prevent"])},{default:m(()=>[r(p,{modelValue:e.value,"onUpdate:modelValue":n[0]||(n[0]=y=>e.value=y),class:"mb-4",label:"Name",placeholder:"Name"},null,8,["modelValue"]),l("div",L,[r(o,{style:V(x(w)),preset:"secondary",color:"secondary",onClick:n[1]||(n[1]=y=>u("cancel"))},{default:m(()=>n[3]||(n[3]=[_(" Cancel")])),_:1},8,["style"]),r(o,{style:V(x(w)),class:"mb-4 md:mb-0",type:"submit",onClick:t},{default:m(()=>n[4]||(n[4]=[_(" Save")])),_:1},8,["style"])])]),_:1},512)]),_:1})}}}),W={class:"flex flex-col-reverse md:flex-row md:items-center md:justify-end md:space-x-4"},X={__name:"EditAuthenticationModal",emits:["cancel"],setup(g,{emit:c}){A();const{init:a}=I(),s=c,u=v(),e=v(),t=v(""),d=()=>{if(t.value||a({message:"谷歌认证码错误",color:"danger"}),t.value){const p=F();R({user_name:p,google_code:t.value}).then(o=>{o==1?(a({message:"谷歌认证绑定成功",color:"success"}),s("cancel"),window.location.reload()):(a({message:"谷歌认证绑定失败",color:"danger"}),s("cancel"))}).catch(o=>{a({message:"谷歌认证绑定失败",color:"danger"}),s("cancel")})}};return(async()=>{const p=F(),o=await T(p);e.value=o,console.log(e.value)})(),(p,o)=>{const N=i("VaImage"),$=i("VaInput"),y=i("VaButton"),G=i("VaForm"),h=i("VaModal");return f(),b(h,{"mobile-fullscreen":!1,size:"small","hide-default-actions":"","max-width":"380px","model-value":"","close-button":"","onUpdate:modelValue":o[2]||(o[2]=k=>s("cancel"))},{default:m(()=>[o[5]||(o[5]=l("h1",{class:"va-h5 mb-4"},"谷歌认证",-1)),r(G,{ref_key:"form",ref:u},{default:m(()=>{var k;return[r(N,{class:"w-full md:w-1/2 lg:w-1/3",src:(k=e.value)==null?void 0:k.qr_secret},null,8,["src"]),r($,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=B=>t.value=B),class:"mb-4",label:"Name",placeholder:"请输入谷歌认证码"},null,8,["modelValue"]),l("div",W,[r(y,{style:V(x(w)),preset:"secondary",color:"secondary",onClick:o[1]||(o[1]=B=>s("cancel"))},{default:m(()=>o[3]||(o[3]=[_(" Cancel")])),_:1},8,["style"]),r(y,{style:V(x(w)),class:"mb-4 md:mb-0",type:"submit",onClick:d},{default:m(()=>o[4]||(o[4]=[_(" Save")])),_:1},8,["style"])])]}),_:1},512)]),_:1})}}},Z={class:"flex flex-col p-4 space-y-10 bg-backgroundSecondary rounded-lg"},ee={class:"flex space-x-5"},oe={class:"space-y-4 md:space-y-6"},le=M({__name:"Preferences",setup(g){const c=v(!1),a=v(!1),s=v(!1);return(u,e)=>(f(),S(E,null,[e[5]||(e[5]=l("h1",{class:"page-title"},"双重认证",-1)),l("div",Z,[l("div",ee,[r(J)]),l("div",oe,[r(K,{onOpenNameModal:e[0]||(e[0]=t=>c.value=!0),onOpenResetPasswordModal:e[1]||(e[1]=t=>a.value=!0),onOpenAuthenticationModal:e[2]||(e[2]=t=>s.value=!0)})])]),c.value?(f(),b(Q,{key:0,onCancel:e[3]||(e[3]=t=>c.value=!1)})):C("",!0),s.value?(f(),b(X,{key:1,onCancel:e[4]||(e[4]=t=>s.value=!1)})):C("",!0)],64))}});export{le as default};
//# sourceMappingURL=Preferences-B-RgFv0J.js.map
