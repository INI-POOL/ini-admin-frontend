import{u as se}from"./useToast-jrZIA6fZ.js";import{p as F}from"./request-CYM5lb0L.js";import{_ as oe,T as P,r as f,o as le,c as L,b as t,h as d,w as l,I as ne,f as c,a as m,i as p,t as n,u as V,g as v,k as B}from"./index-BaO3riMA.js";function re(u){return F("/api/v1/back_stage/withdraw/list",u)}function ie(u){return F("/api/v1/back_stage/withdraw/audit",u)}function j(u,r="YYYY-MM-DD HH:mm:ss"){if(!u)return"-";const x=Number(u),i=new Date(x<1e10?x*1e3:x);if(isNaN(i.getTime()))return"-";const $=i.getFullYear(),k=S(i.getMonth()+1),w=S(i.getDate()),C=S(i.getHours()),D=S(i.getMinutes()),y=S(i.getSeconds());return r.replace("YYYY",$.toString()).replace("MM",k).replace("DD",w).replace("HH",C).replace("mm",D).replace("ss",y)}function S(u){return u<10?`0${u}`:u.toString()}function M(u){let r=u.toString();return r.includes(".")&&(r=r.replace(/\.?0+$/,"")),r}const ue={class:"withdraw-list"},de={class:"action-buttons",style:{"text-align":"center"}},ce={key:2},me={class:"flex justify-end mt-4"},pe={class:"ml-4 self-center text-gray-600"},ve={class:"space-y-4"},_e={class:"mb-4"},ge={class:"transfer-header",style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",gap:"0.62rem","padding-top":"1rem"}},fe={class:"status"},ye={class:"time"},be={class:"transfer-info"},Ve={class:"info-row"},ke={class:"value-box"},xe={class:"value"},we={class:"info-row"},Ce={class:"value-box"},De={class:"value"},ze={class:"info-row"},Te={class:"value-box"},Se={class:"info-row"},Me={class:"value-box"},$e={class:"transaction-id"},Ie={class:"value-box"},Ye={class:"value"},Be=["href"],Ne={__name:"WithdrawList",setup(u){const{init:r}=se(),x=[{key:"id",label:"订单号"},{key:"user_id",label:"用户编号"},{key:"mobile",label:"手机号"},{key:"amount",label:"提现金额"},{key:"gas_fee",label:"gas费"},{key:"currency",label:"币种"},{key:"status",label:"提现状态"},{key:"audit_status",label:"审核状态",sortable:!0},{key:"created_time",label:"申请时间",sortable:!0},{key:"action",label:"操作"}],i=P({page:1,pagesize:10}),$=f([]),k=f(0),w=f(1),C=f(!1),D=async()=>{C.value=!0;try{const a=await re(i);a&&typeof a.Total=="number"?($.value=a.Withdraws||[],k.value=parseInt(a.Total)):(console.error("API返回数据格式错误:",a),r({message:"数据格式错误",color:"danger"}))}catch(a){console.error("获取数据失败:",a),r({message:"获取数据失败",color:"danger"})}finally{C.value=!1}},y=async a=>{try{await navigator.clipboard.writeText(a),r({message:"复制成功",color:"success"})}catch{r({message:"复制失败",color:"danger"})}},R=a=>{i.page=Math.ceil(a/i.pagesize),w.value=a,D()},A=a=>({0:"申请中",1:"提现成功",2:"提现失败",3:"确认中",4:"提现异常"})[a]||"未知状态",Z=a=>{const e={0:"warning",1:"success",2:"info",3:"danger"};let Y=e[a]||"primary";return console.log(e[a]),Y},q=a=>({0:"待审核",1:"审核成功",2:"审核失败"})[a]||"未知状态",E=a=>({0:"warning",1:"success",2:"danger"})[a]||"primary",I=f(!1),z=f(null),_=P({audit_status:1}),O=a=>{a&&(z.value=a.rowData,_.audit_status=1,I.value=!0)},G=async()=>{if(!z.value)return;let a=ne();try{await ie({id:z.value.id,audit_status:_.audit_status,google_code:_.google_code,user_name:a}),r({message:"审核成功",color:"success"}),I.value=!1,D()}catch{r({message:"审核失败",color:"danger"})}},N=f(!1),o=f(null),J=a=>{if(!a){console.error("行数据为空");return}o.value=a.rowData,_.audit_status=1,N.value=!0};return le(()=>{D()}),(a,e)=>{const Y=c("VaBadge"),W=c("VaButton"),K=c("VaDataTable"),Q=c("VaPagination"),X=c("VaCardContent"),ee=c("VaCard"),te=c("VaRadio"),ae=c("VaInput"),U=c("VaModal"),T=c("VaAvatar"),H=c("VaDivider"),h=c("VaIcon");return m(),L("div",ue,[e[27]||(e[27]=t("div",{class:"mb-4"},[t("h1",{class:"text-2xl font-bold"},"提现管理")],-1)),d(ee,null,{default:l(()=>[d(X,null,{default:l(()=>[d(K,{items:$.value,loading:C.value,columns:x,"items-per-page":i.pagesize,"current-page":i.page,"total-items":k.value,selectable:!1,"show-select":!1,hoverable:"",class:"responsive-table"},{"cell(amount)":l(({value:s})=>[p(n(V(M)(s)),1)]),"cell(gas_fee)":l(({value:s})=>[p(n(V(M)(s)),1)]),"cell(status)":l(({value:s})=>[d(Y,{color:Z(s)},{default:l(()=>[p(n(A(s)),1)]),_:2},1032,["color"])]),"cell(audit_status)":l(({value:s})=>[d(Y,{color:E(s)},{default:l(()=>[p(n(q(s)),1)]),_:2},1032,["color"])]),"cell(created_time)":l(({value:s})=>[p(n(V(j)(s)),1)]),"cell(action)":l(({row:s})=>[t("div",de,[s?(m(),v(W,{key:0,size:"small",preset:"primary",onClick:b=>J(s)},{default:l(()=>e[10]||(e[10]=[p(" 查看 ")])),_:2},1032,["onClick"])):B("",!0),s&&Number(s.rowData.audit_status)===0?(m(),v(W,{key:1,size:"small",preset:"primary",onClick:b=>O(s)},{default:l(()=>e[11]||(e[11]=[p(" 审核 ")])),_:2},1032,["onClick"])):(m(),L("span",ce,"--"))])]),_:1},8,["items","loading","items-per-page","current-page","total-items"]),t("div",me,[d(Q,{modelValue:w.value,"onUpdate:modelValue":[e[0]||(e[0]=s=>w.value=s),R],"page-size":i.pagesize,"visible-pages":"5",total:k.value,"buttons-preset":"secondary","boundary-numbers":""},null,8,["modelValue","page-size","total"]),t("span",pe," 共 "+n(k.value)+" 条记录 ",1)])]),_:1})]),_:1}),d(U,{modelValue:I.value,"onUpdate:modelValue":e[3]||(e[3]=s=>I.value=s),title:"提现审核","ok-text":"确认","cancel-text":"取消",size:"small",class:"audit-modal",onOk:G},{default:l(()=>{var s,b;return[t("div",ve,[t("div",null,[t("div",_e," 当前提现金额："+n(V(M)((s=z.value)==null?void 0:s.amount)||0)+" "+n(((b=z.value)==null?void 0:b.currency)||""),1),e[12]||(e[12]=t("div",{class:"mb-2"},"审核结果",-1)),d(te,{modelValue:_.audit_status,"onUpdate:modelValue":e[1]||(e[1]=g=>_.audit_status=g),options:[{text:"同意",value:1},{text:"拒绝",value:2}],"value-by":"value"},null,8,["modelValue"]),e[13]||(e[13]=t("div",{class:"mb-2",style:{"padding-top":"0.62rem"}},"谷歌认证",-1)),d(ae,{modelValue:_.google_code,"onUpdate:modelValue":e[2]||(e[2]=g=>_.google_code=g),width:"200px",placeholder:"请输入谷歌认证码"},null,8,["modelValue"])])])]}),_:1},8,["modelValue"]),d(U,{modelValue:N.value,"onUpdate:modelValue":e[9]||(e[9]=s=>N.value=s),title:"转账详情",size:"medium",class:"mr-6 my-1","close-button":""},{content:l(()=>{var s,b;return[t("div",ge,[o.value.status===0?(m(),v(T,{key:0,color:"info"},{default:l(()=>e[14]||(e[14]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," more_horiz ",-1)])),_:1})):o.value.status===1?(m(),v(T,{key:1,color:"success"},{default:l(()=>e[15]||(e[15]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," check ",-1)])),_:1})):o.value.status===2?(m(),v(T,{key:2,color:"danger"},{default:l(()=>e[16]||(e[16]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," close ",-1)])),_:1})):o.value.status===3?(m(),v(T,{key:3,color:"warning"},{default:l(()=>e[17]||(e[17]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," directory_sync ",-1)])),_:1})):o.value.status===4?(m(),v(T,{key:4,color:"danger"},{default:l(()=>e[18]||(e[18]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," check ",-1)])),_:1})):B("",!0),t("div",fe,n(A(o.value.status)),1),t("div",ye,n(V(j)(o.value.created_time)),1)]),d(H),t("div",be,[t("div",Ve,[e[19]||(e[19]=t("span",{class:"label"},"数额：",-1)),t("div",ke,[t("span",xe,n(V(M)((s=o.value)==null?void 0:s.amount)||0)+" "+n(o.value.currency),1)])]),t("div",we,[e[20]||(e[20]=t("span",{class:"label"},"提款手续费：",-1)),t("div",Ce,[t("span",De,n(V(M)((b=o.value)==null?void 0:b.gas_fee)||0)+" "+n(o.value.currency),1)])]),t("div",ze,[e[22]||(e[22]=t("span",{class:"label"},"收款地址：",-1)),t("div",Te,[t("span",{class:"value",onClick:e[4]||(e[4]=g=>y(o.value.to_addr))},n(o.value.to_addr),1),d(h,{class:"material-icons",onClick:e[5]||(e[5]=g=>y(o.value.to_addr))},{default:l(()=>e[21]||(e[21]=[p(" content_copy ")])),_:1})])]),t("div",Se,[e[24]||(e[24]=t("span",{class:"label"},"付款地址：",-1)),t("div",Me,[t("span",{class:"value",onClick:e[6]||(e[6]=g=>y(o.value.from_addr))},n(o.value.from_addr),1),o.value.from_addr?(m(),v(h,{key:0,class:"material-icons",onClick:e[7]||(e[7]=g=>y(o.value.from_addr))},{default:l(()=>e[23]||(e[23]=[p(" content_copy ")])),_:1})):B("",!0)])])]),d(H),t("div",$e,[e[26]||(e[26]=t("span",{class:"label"},"交易号：",-1)),t("div",Ie,[t("span",Ye,[t("a",{href:`https://mainnet.aleo123.io/transactionDetail/${o.value.tx_id}`,target:"_blank"},n(o.value.tx_id),9,Be)]),o.value.tx_id?(m(),v(h,{key:0,class:"material-icons",onClick:e[8]||(e[8]=g=>y(o.value.tx_id))},{default:l(()=>e[25]||(e[25]=[p(" content_copy ")])),_:1})):B("",!0)])])]}),_:1},8,["modelValue"])])}}},Ue=oe(Ne,[["__scopeId","data-v-02392259"]]);export{Ue as default};
//# sourceMappingURL=WithdrawList-DRZisjPg.js.map
