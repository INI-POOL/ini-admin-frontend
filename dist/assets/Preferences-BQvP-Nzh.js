import{H as D,d as A,I as M,f as i,a as v,c as E,h as r,w as p,i as f,b as a,t as P,u as _,F as B,r as g,o as R,e as T,g as w,j as $,k as I,J as q}from"./index-ZAL7-VQw.js";import{u as U}from"./useToast-Cr2-Gd3t.js";import{i as H,c as J,g as Y}from"./user-CXVdtAJN.js";import"./request-Dg882Ae1.js";const N=D("user",{state:()=>({userName:"Vasili Savitski",email:"vasili@gmail.com",memberSince:"8/12/2020",pfp:"https://picsum.photos/id/22/200/300",is2FAEnabled:!1}),actions:{toggle2FA(){this.is2FAEnabled=!this.is2FAEnabled},changeUserName(y){this.userName=y}}}),K={class:"flex flex-col justify-center"},L={class:"text-[28px] md:text-[32px] leading-10 font-bold"},Q=A({__name:"PreferencesHeader",setup(y){const u=M();return N(),(l,s)=>{const m=i("VaAvatar");return v(),E(B,null,[r(m,{color:"warning"},{default:p(()=>s[0]||(s[0]=[f(" U.M ")])),_:1}),a("div",K,[a("h2",L,P(_(u)),1)])],64)}}}),k={"--va-button-font-size":"14px","--va-button-line-height":"20px"},W={class:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-6 min-h-[36px] leading-5"},X=A({__name:"Settings",emits:["openNameModal","openResetPasswordModal"],setup(y,{emit:u}){const l=N();U();const s=g(0);R(async()=>{await m()});const m=async()=>{try{const t=M(),c=await H(t);s.value=c}catch(t){console.error("Error checking Google code requirement:",t)}};T(()=>l.is2FAEnabled?"2FA successfully enabled":"2FA successfully disabled"),T(()=>l.is2FAEnabled?{color:"danger",button:"Disable 2FA",content:"Two-Factor Authentication (2FA) is now enabled for your account, adding an extra layer of security to your sign-ins."}:{color:"primary",button:"Set up 2FA",content:"Add an extra layer of security to your account. To sign in, you’ll need to provide a code along with your username and password."});const o=u;return(t,c)=>{const n=i("VaButton"),x=i("VaDivider");return v(),E(B,null,[a("div",W,[c[2]||(c[2]=a("p",{class:"font-bold w-[200px]"},"绑定谷歌认证器",-1)),c[3]||(c[3]=a("div",{class:"flex-1"},[a("div",{class:"max-w-[748px]"}," 为您的帐户增加一层额外的安全保护。 登录时，除了用户名和密码外，您还需要提供一个谷歌验证码（安全认证器）。 ")],-1)),s.value==0?(v(),w(n,{key:0,style:$(_(k)),class:"w-fit h-fit",preset:"primary",onClick:c[0]||(c[0]=d=>o("openAuthenticationModal"))},{default:p(()=>c[1]||(c[1]=[f(" 绑定 ")])),_:1},8,["style"])):I("",!0)]),r(x)],64)}}}),Z={class:"flex flex-col-reverse md:flex-row md:items-center md:justify-end md:space-x-4"},ee=A({__name:"EditNameModal",emits:["cancel"],setup(y,{emit:u}){const l=N(),{init:s}=U(),m=u,o=g(l.userName),t=()=>{if(!o.value||o.value===l.userName)return m("cancel");l.changeUserName(o.value),s({message:"You've successfully changed your name",color:"success"}),m("cancel")};return(c,n)=>{const x=i("VaInput"),d=i("VaButton"),e=i("VaForm"),F=i("VaModal");return v(),w(F,{"mobile-fullscreen":!1,size:"small","hide-default-actions":"","max-width":"380px","model-value":"","close-button":"","onUpdate:modelValue":n[2]||(n[2]=b=>m("cancel"))},{default:p(()=>[n[5]||(n[5]=a("h1",{class:"va-h5 mb-4"},"Reset password",-1)),r(e,{ref:"form",onSubmit:q(t,["prevent"])},{default:p(()=>[r(x,{modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=b=>o.value=b),class:"mb-4",label:"Name",placeholder:"Name"},null,8,["modelValue"]),a("div",Z,[r(d,{style:$(_(k)),preset:"secondary",color:"secondary",onClick:n[1]||(n[1]=b=>m("cancel"))},{default:p(()=>n[3]||(n[3]=[f(" Cancel")])),_:1},8,["style"]),r(d,{style:$(_(k)),class:"mb-4 md:mb-0",type:"submit",onClick:t},{default:p(()=>n[4]||(n[4]=[f(" Save")])),_:1},8,["style"])])]),_:1},512)]),_:1})}}}),oe={class:"flex flex-col-reverse md:flex-row md:items-center md:justify-end md:space-x-4"},te={__name:"EditAuthenticationModal",emits:["cancel"],setup(y,{emit:u}){N();const{init:l}=U(),s=u,m=g(),o=g(),t=g(""),c=()=>{if(t.value||l({message:"谷歌认证码错误",color:"danger"}),t.value){const d=M();J({user_name:d,google_code:t.value}).then(e=>{e==1?(l({message:"谷歌认证绑定成功",color:"success"}),s("cancel"),window.location.reload()):(l({message:"谷歌认证绑定失败",color:"danger"}),s("cancel"))}).catch(e=>{l({message:"谷歌认证绑定失败",color:"danger"}),s("cancel")})}};(async()=>{const d=M(),e=await Y(d);o.value=e,console.log(o.value)})();const x=async d=>{if(navigator.clipboard)navigator.clipboard.writeText(d).then(()=>{console.log("复制成功")}).catch(e=>{console.error("复制失败",e)});else{const e=document.createElement("textarea");e.value=d,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),console.log("复制成功")}};return(d,e)=>{const F=i("VaImage"),b=i("VaIcon"),h=i("VaInput"),G=i("VaButton"),j=i("VaForm"),z=i("VaModal");return v(),w(z,{"mobile-fullscreen":!1,size:"small","hide-default-actions":"","max-width":"380px","model-value":"","close-button":"","onUpdate:modelValue":e[4]||(e[4]=S=>s("cancel"))},{default:p(()=>[e[8]||(e[8]=a("h1",{class:"va-h5 mb-4"},"谷歌认证",-1)),r(j,{ref_key:"form",ref:m},{default:p(()=>{var S,O;return[r(F,{class:"w-full md:w-1/2 lg:w-1/3",src:(S=o.value)==null?void 0:S.qr_secret},null,8,["src"]),a("div",{class:"mt-4",onClick:e[1]||(e[1]=C=>{var V;return x((V=o.value)==null?void 0:V.secret)})},[f(P((O=o.value)==null?void 0:O.secret)+" ",1),r(b,{class:"material-icons",onClick:e[0]||(e[0]=C=>{var V;return x((V=o.value)==null?void 0:V.secret)})},{default:p(()=>e[5]||(e[5]=[f(" content_copy ")])),_:1})]),r(h,{modelValue:t.value,"onUpdate:modelValue":e[2]||(e[2]=C=>t.value=C),class:"mb-4",label:"Name",placeholder:"请输入谷歌认证码"},null,8,["modelValue"]),a("div",oe,[r(G,{style:$(_(k)),preset:"secondary",color:"secondary",onClick:e[3]||(e[3]=C=>s("cancel"))},{default:p(()=>e[6]||(e[6]=[f(" Cancel")])),_:1},8,["style"]),r(G,{style:$(_(k)),class:"mb-4 md:mb-0",type:"submit",onClick:c},{default:p(()=>e[7]||(e[7]=[f(" Save")])),_:1},8,["style"])])]}),_:1},512)]),_:1})}}},se={class:"flex flex-col p-4 space-y-10 bg-backgroundSecondary rounded-lg"},ne={class:"flex space-x-5"},ae={class:"space-y-4 md:space-y-6"},de=A({__name:"Preferences",setup(y){const u=g(!1),l=g(!1),s=g(!1);return(m,o)=>(v(),E(B,null,[o[5]||(o[5]=a("h1",{class:"page-title"},"双重认证",-1)),a("div",se,[a("div",ne,[r(Q)]),a("div",ae,[r(X,{onOpenNameModal:o[0]||(o[0]=t=>u.value=!0),onOpenResetPasswordModal:o[1]||(o[1]=t=>l.value=!0),onOpenAuthenticationModal:o[2]||(o[2]=t=>s.value=!0)})])]),u.value?(v(),w(ee,{key:0,onCancel:o[3]||(o[3]=t=>u.value=!1)})):I("",!0),s.value?(v(),w(te,{key:1,onCancel:o[4]||(o[4]=t=>s.value=!1)})):I("",!0)],64))}});export{de as default};
//# sourceMappingURL=Preferences-BQvP-Nzh.js.map
