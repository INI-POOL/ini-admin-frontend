{"version":3,"file":"notice-Bd9_i8LJ.js","sources":["../../src/api/notice.js","../../src/pages/notice/notice.vue"],"sourcesContent":["import { patch,get,post,put,getWithConfig,deleteFunc } from \"./request\";\n\n// 查询机器可选项\nexport function noticeList(params) {\n  return get(\"/api/v1/back_stage/notice/list\",params);\n}\n\nexport function addNotice(data) {\n  return put(\"/api/v1/back_stage/notice/add\",data)\n  .then((response) => {\n    if (!response) {\n      throw new Error(\"请求失败，未返回响应数据\");\n    }\n    return response;\n  });\n}\n\nexport function modifyNotice(id, data) {\n  return patch(`/api/v1/back_stage/notice/modify?id=${id}`, data)\n    .then((response) => {\n      if (!response) {\n        throw new Error(\"请求失败，未返回响应数据\");\n      }\n      return response;\n    });\n}\n\nexport function deleteNotice(id) {\n  return patch(`/api/v1/back_stage/notice/delete?id=${id}`)\n    .then((response) => {\n      if (!response) {\n        throw new Error(\"请求失败，未返回响应数据\");\n      }\n      return response;\n    });\n}\n\nexport function pushNotice(data) {\n  return put('/api/v1/back_stage/notice/push',data)\n    .then((response) => {\n      if (!response) {\n        throw new Error(\"请求失败，未返回响应数据\");\n      }\n      return response;\n    });\n}\n\nexport function noticeTypes() {\n\treturn get(\"/api/v1/back_stage/notice/type\");\n}","<template>\n    <va-card class=\"machines-list\">\n        <!-- 搜索和过滤区域 -->\n        <div class=\"mb-4\">\n            <div class=\"filters-row\">\n\t\t\t\t内容查询：\n\t\t\t\t<va-input v-model=\"searchContent\" placeholder=\"请输入消息内容\" class=\"mb-1 mr-6\" :style=\"{ maxWidth: '13%' }\">\n\t\t\t\t    <template #prepend>\n\t\t\t\t        <!-- <va-icon name=\"mobile\" /> -->\n\t\t\t\t    </template>\n\t\t\t\t</va-input>\n\t\t\t\t类型筛选：\n\t\t\t\t<va-select\n\t\t\t\t    v-model=\"selectNotice\"\n\t\t\t\t    :options=\"noticeTypeOptions\"\n\t\t\t\t    placeholder=\"请选择通知类型\"\n\t\t\t\t    class=\"mb-1 mr-6\"\n\t\t\t\t    :style=\"{ maxWidth: '16%' }\"\n\t\t\t\t/>\n\t\t\t\t推送状态：\n\t\t\t\t<va-select\n\t\t\t\t    v-model=\"selectPublish\"\n\t\t\t\t    :options=\"publishedOptions\"\n\t\t\t\t    placeholder=\"请选择通知类型\"\n\t\t\t\t    class=\"mb-1\"\n\t\t\t\t    :style=\"{ maxWidth: '16%' }\"\n\t\t\t\t/>\n\t\t\t\t<va-button @click=\"addVersionForm\" color=\"rgb(47, 148, 172)\" class=\"mb-1 ml-6\">\n\t\t\t\t    新增通知\n\t\t\t\t</va-button>\n\t\t\t\t<va-button @click=\"refreshData\" color=\"rgb(47, 148, 172)\" class=\"mb-1 ml-6\">\n\t\t\t\t    重置\n\t\t\t\t</va-button>\n            </div>\n        </div>\n\n        <!-- 列表区域 -->\n        <div class=\"table-responsive\">\n            \n            <VaDataTable :items=\"notices\" :columns=\"columns\" striped class=\"responsive-table\">\n\t\t\t\t<template #cell(created_time)=\"{ value }\">\n\t\t\t\t    {{ formatDateTime(value) }}\n\t\t\t\t</template>\n\t\t\t\t<template #cell(spec)=\"{ value }\">\n\t\t\t\t   <template v-if=\"!value\">无</template>\t\t\t\t\n\t\t\t\t   <a v-else :title=\"value\" target=\"_blank\">\n\t\t\t\t\t {{ truncateText(value, 45) }}\n\t\t\t\t   </a>\n\t\t\t\t</template>\n\t\t\t\t<template #cell(belonged_user)=\"{ value }\">\n\t\t\t\t    {{ value === '' ? '所有' : value }}\n\t\t\t\t</template>\n\t\t\t\t<template #cell(is_published)=\"{ value }\">\n\t\t\t\t    {{ value === '0' || 0 ? '未推送' : '已推送' }}\n\t\t\t\t</template>\n                <template #cell(actions)=\"{ row }\">\n\t\t\t\t\t  <div class=\"action-container\">\n\t\t\t\t\t    <!-- 主要操作：紧凑图标按钮 -->\n\t\t\t\t\t\t<va-button-group>\n\t\t\t\t\t\t\t<va-button \n\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t\ticon=\"edit\"\n\t\t\t\t\t\t\t\tcolor=\"rgb(47, 148, 172)\"\n\t\t\t\t\t\t\t\t@click=\"editNotice(row)\"\n\t\t\t\t\t\t\t\ttitle=\"修改通知内容\"\n\t\t\t\t\t\t\t\tclass=\"action-icon\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<va-button\n\t\t\t\t\t\t\t  icon=\"rocket_launch\"\n\t\t\t\t\t\t\t  size=\"small\"\n\t\t\t\t\t\t\t  color=\"rgb(47, 148, 172)\"\n\t\t\t\t\t\t\t  title=\"推送\"\n\t\t\t\t\t\t\t  @click=\"confirmPublish(row)\"\n\t\t\t\t\t\t\t  class=\"action-icon\"\n\t\t\t\t\t\t\t  v-if=\"row.rowData.is_published === 0\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<va-button\n\t\t\t\t\t\t\t  size=\"small\"\n\t\t\t\t\t\t\t  icon=\"delete\"\n\t\t\t\t\t\t\t  color=\"rgb(208, 24, 39)\"\n\t\t\t\t\t\t\t  title=\"删除通知\"\n\t\t\t\t\t\t\t  @click=\"openDeleteConfirm(row.rowData)\"\n\t\t\t\t\t\t\t  class=\"action-icon\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</va-button-group>\n\t\t\t\t\t  </div>\n                </template>\n            </VaDataTable>\n            \n            <!-- 添加编辑弹窗 -->\n\t\t\t<va-modal\n                v-model=\"isEditModalVisible\"\n\t\t\t\thide-default-actions\n                title=\"修改通知\"\n\t\t\t\t:ok-props=\"{ color: 'rgb(47, 148, 172)', textColor: 'white' }\"\n\t\t\t\t:cancel-props=\"{ color: 'rgb(47, 148, 172)', textColor: 'white' }\"\n            >\n                <VaForm>\n\t\t\t\t\t<va-select\n\t\t\t\t\t    v-model=\"editForm.type\"\n\t\t\t\t\t\t:options=\"noticeSpecTypeOptions\"\n\t\t\t\t\t\tlabel=\"通知类型\"\n\t\t\t\t\t    placeholder=\"请选择通知类型\"\n\t\t\t\t\t    class=\"mb-4\"\n\t\t\t\t\t/>\n\t\t\t\t\t<VaInput\n\t\t\t\t\t  v-model=\"editForm.title\"\n\t\t\t\t\t  label=\"标题\"\n\t\t\t\t\t  class=\"mb-4\"\n\t\t\t\t\t  :max-length=\"50\"\n\t\t\t\t\t  counter\n\t\t\t\t\t>\n\t\t\t\t\t  <template #counter=\"{ valueLength }\">\n\t\t\t\t\t    <span :class=\"{ 'text-danger': valueLength > 50 }\">\n\t\t\t\t\t      {{ valueLength }}/50\n\t\t\t\t\t    </span>\n\t\t\t\t\t  </template>\n\t\t\t\t\t</VaInput>\n\t\t\t\t\t<va-input\n\t\t\t\t\t  v-model=\"editForm.spec\"\n\t\t\t\t\t  label=\"概述\"\n\t\t\t\t\t  class=\"mb-4\"\n\t\t\t\t\t  :max-length=\"100\"\n\t\t\t\t\t  counter\n\t\t\t\t\t>\n\t\t\t\t\t  <template #counter=\"{ valueLength }\">\n\t\t\t\t\t    <span :class=\"{ 'text-danger': valueLength > 100 }\">\n\t\t\t\t\t      {{ valueLength }}/100\n\t\t\t\t\t    </span>\n\t\t\t\t\t  </template>\n\t\t\t\t\t</va-input>\n\t\t\t\t\t<VaTextarea\n\t\t\t\t\t  v-model=\"editForm.content\"\n\t\t\t\t\t  label=\"内容 (支持HTML语言)\"\n\t\t\t\t\t  placeholder=\"请输入详细内容...\"\n\t\t\t\t\t  autosize\n\t\t\t\t\t  :min-rows=\"10\"\n\t\t\t\t\t  :max-rows=\"20\"\n\t\t\t\t\t  :max-length=\"2000\"\n\t\t\t\t\t  counter\n\t\t\t\t\t  class=\"mb-6\"\n\t\t\t\t\t  :style=\"{ width: '1000px' }\"\n\t\t\t\t\t>\n\t\t\t\t\t  <template #counter=\"{ valueLength }\">\n\t\t\t\t\t    <span :class=\"{ 'text-danger': valueLength > 2000 }\">\n\t\t\t\t\t      {{ valueLength }}/2000\n\t\t\t\t\t    </span>\n\t\t\t\t\t  </template>\n\t\t\t\t\t</VaTextarea>\n                </VaForm>\n\t\t\t\t    <!-- 操作按钮 -->\n\t\t\t\t\t<div class=\"flex justify-end gap-4\">\n\t\t\t\t          <va-button\n\t\t\t\t            color=\"secondary\"\n\t\t\t\t            @click=\"onCancel\"\n\t\t\t\t          >\n\t\t\t\t            取消\n\t\t\t\t          </va-button>\n\t\t\t\t          <va-button\n\t\t\t\t            @click=\"onOk\"\n\t\t\t\t          >\n\t\t\t\t            确认修改\n\t\t\t\t          </va-button>\n\t\t\t\t        </div>\n            </va-modal>\n\t\t\t\n\t\t\t<va-modal v-model=\"isDatePickerVisible\" hide-default-actions title=\"选择发布时间\">\n\t\t\t    <VaDateInput v-model=\"date\" />\n\t\t\t\t<VaTimeInput v-model=\"time\" class=\"ml-2\" />\n\t\t\t\n\t\t\t    <va-button-group>\n\t\t\t\t\t<va-button\n\t\t\t\t\t  block \n\t\t\t\t\t  @click=\"onCronCancel\"\n\t\t\t\t\t  color=\"rgb(47, 148, 172)\"\n\t\t\t\t\t  class=\"mt-4\"\n\t\t\t\t\t>\n\t\t\t\t\t  取消\n\t\t\t\t\t</va-button>\n\t\t\t\t\t<va-button\n\t\t\t\t\t  block \n\t\t\t\t\t  @click=\"handleCronPublish\"\n\t\t\t\t\t  :disabled=\"!isDateTimeValid\"\n\t\t\t\t\t  color=\"rgb(47, 148, 172)\"\n\t\t\t\t\t  class=\"mt-4 ml-2\"\n\t\t\t\t\t>\n\t\t\t\t\t  确认发布\n\t\t\t\t\t</va-button>\n\t\t\t\t</va-button-group>\n\n\t\t\t  </va-modal>\n\t\t\t  \t\t\t\n\t\t\t<VaModal\n\t\t\t    v-model=\"showConfirmDialog\"\n\t\t\t\ttitle=\"系统提示\"\n\t\t\t\tok-text=\"确认推送\"\n\t\t\t\tcancel-text=\"暂不推送\"\n\t\t\t    @ok=\"handleConfirm\"\n\t\t\t    @cancel=\"handleCancel\"\n\t\t\t  >\n\t\t\t\t<template #header>\n\t\t\t\t  <div class=\"dialog-header\">\n\t\t\t\t\t<va-icon name=\"warning\" color=\"warning\" />\n\t\t\t\t\t<span class=\"header-text\">消息推送确认</span>\n\t\t\t\t  </div>\n\t\t\t\t</template>\n\t\t\t\n\t\t\t\t<div class=\"dialog-content\">\n\t\t\t\t  <p class=\"version-info\">\n\t\t\t\t\t即将为 <span class=\"system-highlight\">{{ pendingUid === '' ? '所有' : pendingUid }}</span> 用户推送 <span class=\"system-highlight\">{{ pendingType }}</span> 类型通知\n\t\t\t\t  </p>\n\t\t\t\t  <va-divider />\n\t\t\t\t</div>\n\t\t\t  </VaModal>\n\t\t\t  \n\t\t\t    <VaModal\n\t\t\t      v-model=\"isDeleteConfirmVisible\"\n\t\t\t      title=\"系统提示\"\n\t\t\t      size=\"small\"\n\t\t\t      :message=\"deleteConfirmMessage\"\n\t\t\t      @ok=\"confirmDelete\"\n\t\t\t      @cancel=\"cancelDelete\"\n\t\t\t      ok-text=\"确认\"\n\t\t\t      cancel-text=\"取消\"\n\t\t\t      :ok-props=\"{ color: 'danger' }\"\n\t\t\t    >\n\t\t\t\t\t<template #header>\n\t\t\t\t\t  <div class=\"dialog-header\">\n\t\t\t\t\t\t<va-icon name=\"warning\" color=\"warning\" />\n\t\t\t\t\t\t<span class=\"header-text\">确认删除？</span>\n\t\t\t\t\t  </div>\n\t\t\t\t\t</template>\n\t\t\t\t</VaModal>\n\t\t\t\t\n\t\t\t\t<va-modal v-model=\"showAddModal\" hide-default-actions size=\"medium\">\n\t\t\t\t      <template #header>\n\t\t\t\t        <h5 class=\"va-h5\">新增通知</h5>\n\t\t\t\t      </template>\n\t\t\t\t\n\t\t\t\t      <div class=\"modal-content\">\n\t\t\t\t        <!-- 标题输入 -->\n\t\t\t\t        <va-input\n\t\t\t\t          v-model=\"title\"\n\t\t\t\t          label=\"标题\"\n\t\t\t\t          placeholder=\"请输入标题...\"\n\t\t\t\t          class=\"mb-4\"\n\t\t\t\t          :max-length=\"50\"\n\t\t\t\t          counter\n\t\t\t\t        >\n\t\t\t\t          <template #counter=\"{ valueLength }\">\n\t\t\t\t            <span :class=\"{ 'text-danger': valueLength > 50 }\">\n\t\t\t\t              {{ valueLength }}/50\n\t\t\t\t            </span>\n\t\t\t\t          </template>\n\t\t\t\t        </va-input>\n\t\t\t\t\t\t<va-select\n\t\t\t\t\t\t    v-model=\"addType\"\n\t\t\t\t\t\t    :options=\"noticeSpecTypeOptions\"\n\t\t\t\t\t\t\tlabel=\"通知类型\"\n\t\t\t\t\t\t    placeholder=\"请选择通知类型\"\n\t\t\t\t\t\t    class=\"mb-4\"\n\t\t\t\t\t\t    :style=\"{ maxWidth: '47.5%' }\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<va-select\n\t\t\t\t\t\t    v-model=\"addUid\"\n\t\t\t\t\t\t    :options=\"uidOptions\"\n\t\t\t\t\t\t\tlabel=\"用户UID\"\n\t\t\t\t\t\t    placeholder=\"请选择用户UID\"\n\t\t\t\t\t\t    class=\"mb-4 ml-8\"\n\t\t\t\t\t\t    :style=\"{ maxWidth: '47.5%' }\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<va-input\n\t\t\t\t\t\t  v-model=\"spec\"\n\t\t\t\t\t\t  label=\"概述\"\n\t\t\t\t\t\t  placeholder=\"请输入概述...\"\n\t\t\t\t\t\t  class=\"mb-4\"\n\t\t\t\t\t\t  :max-length=\"100\"\n\t\t\t\t\t\t  counter\n\t\t\t\t\t\t>\n\t\t\t\t\t\t  <template #counter=\"{ valueLength }\">\n\t\t\t\t\t\t    <span :class=\"{ 'text-danger': valueLength > 100 }\">\n\t\t\t\t\t\t      {{ valueLength }}/100\n\t\t\t\t\t\t    </span>\n\t\t\t\t\t\t  </template>\n\t\t\t\t\t\t</va-input>\n\t\t\t\t\n\t\t\t\t        <!-- 内容输入 -->\n\t\t\t\t        <VaTextarea\n\t\t\t\t          v-model=\"content\"\n\t\t\t\t          label=\"内容 (支持HTML语言)\"\n\t\t\t\t          placeholder=\"请输入详细内容...\"\n\t\t\t\t          autosize\n\t\t\t\t          :min-rows=\"10\"\n\t\t\t\t\t\t  :max-rows=\"20\"\n\t\t\t\t          :max-length=\"2000\"\n\t\t\t\t          counter\n\t\t\t\t          class=\"mb-6\"\n\t\t\t\t\t\t  :style=\"{ width: '1000px' }\"\n\t\t\t\t        >\n\t\t\t\t          <template #counter=\"{ valueLength }\">\n\t\t\t\t            <span :class=\"{ 'text-danger': valueLength > 2000 }\">\n\t\t\t\t              {{ valueLength }}/2000\n\t\t\t\t            </span>\n\t\t\t\t          </template>\n\t\t\t\t        </VaTextarea>\n\t\t\t\t\n\t\t\t\t        <!-- 操作按钮 -->\n\t\t\t\t        <div class=\"flex justify-end gap-4\">\n\t\t\t\t          <va-button\n\t\t\t\t            color=\"secondary\"\n\t\t\t\t            @click=\"cancel\"\n\t\t\t\t          >\n\t\t\t\t            取消\n\t\t\t\t          </va-button>\n\t\t\t\t          <va-button\n\t\t\t\t            :disabled=\"!isFormValid\"\n\t\t\t\t            @click=\"handleSubmit\"\n\t\t\t\t          >\n\t\t\t\t            确认新增\n\t\t\t\t          </va-button>\n\t\t\t\t        </div>\n\t\t\t\t      </div>\n\t\t\t\t    </va-modal>\n\t\t\t\t\t\n        </div>\n\n        <!-- 分页 -->\n        <div class=\"flex justify-end mt-4\">\n            <VaPagination\n                v-model=\"currentStartIndex\"\n                :page-size=\"queryParams.pagesize\"\n                visible-pages=\"5\"\n                :total=\"totalItems\"\n                buttons-preset=\"secondary\"\n                boundary-numbers\n                @update:modelValue=\"handlePageChange\"\n            />\n            <span class=\"ml-4 self-center text-gray-600\">\n                共 {{ totalItems }} 条记录\n            </span>\n        </div>\n    </va-card>\n</template>\n\n<script setup>\nimport dayjs from 'dayjs'\nimport { ElMessage } from 'element-plus'\nimport { ref, reactive, computed } from 'vue'\nimport { versionList, addVersion, modifyVersion, publishVersion,uploadApk,downloadApk,timedPublishVersion,deleteVersion } from \"../../api/version\"\nimport { noticeList, addNotice, modifyNotice, pushNotice,deleteNotice,noticeTypes } from \"../../api/notice\"\nimport { getUserUids } from \"../../api/user\"\nimport { formatDateTime } from \"../../utils/date.ts\"\nimport { useToast, useForm } from \"vuestic-ui\"\nimport { saveAs } from 'file-saver'\n\nconst { init: toast } = useToast()\n\nconst { isValid, validate } = useForm('addFormRef')\n\nconst requiredAddRule = (value) => {\n  return !!value?.trim() || '该字段为必填项'\n}\n\nconst isDeleteConfirmVisible = ref(false)\nconst selectedVersion = ref(null)\nconst selectedSystem = ref(null)\nconst deleteId = ref(null)\n\nconst searchContent = ref('')\n\nconst selectNotice = ref('')\n\nconst showAddModal = ref(false)\nconst title = ref('')\nconst spec = ref('')\nconst content = ref('')\nconst addUid = ref('')\nconst addType = ref('')\n\nconst noticeTypeOptions = ref([])\nconst noticeSpecTypeOptions = ref([])\nconst uidOptions = ref([])\n\nconst openDeleteConfirm = (rowData) => {\n  deleteId.value = rowData.id\n  isDeleteConfirmVisible.value = true\n}\n\nconst convertToOptions = (arr) => \n  arr.map(item => ({ value: item, text: item }));\nconst fetchNoticeOptions = async () => {\n  try {\n    const response = await noticeTypes()\n\tconst defaultOption = { value: '', text: '所有' };\n\tnoticeTypeOptions.value = [defaultOption, ...convertToOptions(response || [])];\n\tnoticeSpecTypeOptions.value = convertToOptions(response || [])\n\tconst uids = await getUserUids()\n\tuidOptions.value = [defaultOption, ...convertToOptions(uids || [])];\n\t\n  } catch (error) {\n    toast({\n      message: error,\n      color: 'danger'\n    })\n  }\n}\n\nconst selectPublish = ref('')\n\nconst publishedOptions = [\n\t{ value: '', text: '所有' },\n    { value: '1', text: '已推送' },\n    { value: '0', text: '未推送' },\n]\n\nconst titleLength = () => {\n\treturn title.value.trim().length\n}\n\nconst specLength = () => {\n\treturn spec.value.trim().length\n}\n\nconst contentLength = () => {\n\treturn content.value.trim().length\n}\n\nconst isFormValid = () => {\n\treturn titleLength() > 0 && \n\t\t titleLength() <= 50 &&\n\t\t specLength() > 0 &&\n\t\t specLength() <= 100 &&\n\t\t contentLength() > 0 &&\n\t\t contentLength() <= 2000 &&\n\t\t addUid.value != '' &&\n\t\t addType.value != ''\n}\n\nconst isEditFormValid = () => {\n\tconsole.log(\"title length is\",editForm.title.trim().length)\n\treturn editForm.title.trim().length > 0 && \n\t\t editForm.title.trim().length <= 50 &&\n\t\t editForm.spec.trim().length > 0 &&\n\t\t editForm.spec.trim().length <= 100 &&\n\t\t editForm.content.trim().length > 0 &&\n\t\t editForm.content.trim().length <= 2000 &&\n\t\t editForm.belonged_user.value != '' &&\n\t\t editForm.type.value != ''\n}\n\nconst resetAddNoticeForm = () => {\n   title.value = ''\n   spec.value = ''\n   content.value = ''\n   addUid.value = ''\n   addType.value = ''\n}\n\nconst handleSubmit = async () => {\n      if (!isFormValid()) {\n        toast({\n          message: '请检查输入内容是否符合要求',\n          color: 'danger'\n        })\n        return\n      }\n\t  \n\t  const params = {\n\t\t  title: title.value,\n\t\t  title_en: title.value,\n\t\t  spec: spec.value,\n\t\t  spec_en: spec.value,\n\t\t  content: content.value,\n\t\t  content_en: content.value,\n\t\t  type: addType.value.value,\n\t\t  belonged_user: addUid.value.value\n\t  }\n\t\n\t  try {\t\t\t\t  \n\t    await addNotice(params)\n\t\tshowAddModal.value = false\n\t\tfetchData()\n\t\tresetAddNoticeForm()\n\t    toast({ message: '新增成功', color:'rgb(47, 148, 172)' })\n\t  } catch (error) {\n\t    toast({ \n\t      message: `删除失败: ${error.message || '未知错误'}`, \n\t      color: 'danger' \n\t    })\n\t  } finally {\n\t  }\n}\n\nconst cancel = () => {\n    resetAddNoticeForm()\n    showAddModal.value = false\n}\n\nconst confirmDelete = async () => {\n  try {\n    await deleteNotice(deleteId.value)\n    toast({ message: '删除成功', color:'rgb(47, 148, 172)' })\n    // 这里可以触发表格刷新逻辑\n  } catch (error) {\n    toast({ \n      message: `删除失败: ${error.message || '未知错误'}`, \n      color: 'danger' \n    })\n  } finally {\n\tfetchData()\n\tfetchNoticeOptions()\n    isDeleteConfirmVisible.value = false\n  }\n}\n\n\nconst cancelDelete = () => {\n  toast({ message: '已取消删除', color: 'info' })\n  isDeleteConfirmVisible.value = false\n}\n\nconst uploading = ref({})\nconst downloading = ref({})\n\nconst hasValidFilePath = (row) => {\n  // 检查对象层级\n  if (!row || !row.rowData) return false\n  \n  // 检查路径有效性\n  const path = row.rowData.file_path\n  return typeof path === 'string' && path.trim().length > 0\n}\n\nconst simulateStep = (delay) => {\n  return new Promise((resolve) => setTimeout(resolve, delay));\n};\n\nconst handleUpload = async (files, row) => {\n  const rowId = row.rowData.id\n  const file = files[0]\n\t\n  const formData = new FormData()\n  formData.append('file', file,file.name)\n  formData.append('version', row.rowData.version)\n  formData.append('system', row.rowData.system)\n  \t\n  try {\n\t  \n\t  uploading.value[rowId] = true\t  \n\t  const data = await uploadApk(formData)\n\t  if (data.success) {\n\t     uploadFiles.value[rowId] = []\n\t  }\n\t  await simulateStep(2000); \n\t  uploading.value[rowId] = false\n\t  toast({\n\t      message: '上传成功',\n\t      color: \"success\",\n\t\t  duration: 5000\n\t  })\n\t  fetchData()\n\t  fetchNoticeOptions()\n  } catch (error) {\n\tconsole.error('上传失败:', {\n\t  request: error.config,\n\t  status: error.response?.status,\n\t  data: error.response?.data  \n\t})\n  }\n}\n\nconst handleDownload = async (row) => {\n  try {\n\tconst rowId = row.rowData.id\n\tdownloading.value[rowId] = true\n\n    if (!row.rowData?.version || !row.rowData?.system) {\n      ElMessage.error('请选择要下载的版本')\n\t  return\n    }\n\n    const response = await downloadApk({\n      version: row.rowData.version,\n      system: row.rowData.system\n    })\n\n    // 获取文件名（兼容大小写）\n    const fileName = decodeURIComponent(\n      response.headers['x-file-name'] || \n      response.headers['X-File-Name'] || \n      `${row.rowData.file_name}`\n    )\n\n    // 创建并触发下载\n    saveAs(new Blob([response.data]), fileName)\n\tawait simulateStep(2000); \n\tdownloading.value[rowId] = false\n  } catch (error) {\n    console.error('下载失败:', error)\n    \n    // 统一错误处理\n    let message = '下载失败，请重试'\n    \n    if (error.response?.data instanceof Blob) {\n      try {\n        const text = await error.response.data.text()\n        message = JSON.parse(text).error || message\n      } catch {\n        message = '服务器返回异常'\n      }\n    }\n    \n    ElMessage.error(message)\n  }\n}\n\nconst uploadFiles = reactive({})\n\nconst systemOptions = ref([\n\t{ value: '', text: '所有' },\n    { value: 'ios', text: 'IOS' },\n    { value: 'android', text: 'Android' },\n])\n\nconst systemWithOutAllOptions = ref([\n    { value: 'ios', text: 'IOS' },\n    { value: 'android', text: 'Android' },\n])\n\nconst searchSystem = ref(systemOptions[0])\n\nconst publishTime = ref()\n\nconst time = ref(new Date())\nconst date = ref(new Date())\n\nconst isDatePickerVisible = ref(false)\nconst selectedDateTime = ref(new Date())\nconst rowData = ref({}) // 根据实际数据结构调整\n\nconst requiredRule = value => !!value || '必须选择时间'\nconst dateValidationRule = value => {\n  const now = new Date()\n  const selected = new Date(value)\n  \n  // 时间必须晚于当前\n  if (selected <= now) return '时间必须晚于当前'\n  \n  return true\n}\n\nconst cronForm = reactive({\n\tversion: '',\n\tsystem: ''\n})\n\n// 计算属性\nconst isDateTimeValid = computed(() => \n\n  requiredRule(date.value) === true &&\n  dateValidationRule(time.value) === true\n)\n\nconst showPublishButton = computed(() => \n  ['0', 0].includes(rowData.value.is_latest)\n)\n\n// 打开选择器\nconst openDatePicker = (row) => {\n  time.value = new Date() // 重置为当前时间\n  date.value = new Date()\n  cronForm.version = row.rowData.version\n  cronForm.system = row.rowData.system\n  isDatePickerVisible.value = true\n}\n\nconst getSystemText = (system) => {\n\tif (system === \"android\") {\n\t\treturn \"Android\"\n\t}else {\n\t\treturn \"IOS\"\n\t}\n}\n  \nconst currentStartIndex = ref(1)\nconst totalItems = ref(0)\nconst notices = ref([])\nconst loading = ref(false)\nconst pendingNoticeId = ref(0)\n\nconst showConfirmDialog = ref(false)\nconst pendingVersion = ref(null)\nconst pendingSystem = ref(null)\nconst deletePendingVersion = ref(null)\nconst deletePendingSystem = ref(null)\nconst pendingUid = ref('')\nconst pendingType = ref('')\n\nconst confirmPublish = (row) => {\n  pendingNoticeId.value = row.rowData.id\n  pendingUid.value = row.rowData.belonged_user\n  pendingType.value = row.rowData.type\n  showConfirmDialog.value = true\n\n}\n\nconst handleConfirm = async (row) => {\n\tconst params = {\n\t\tuid: pendingUid.value,\n\t\tnotice_id: pendingNoticeId.value,\n\t}\n  try {\t  \n\tconst msg = await pushNotice(params)\n\ttoast({\n\t    message: msg,\n\t    color: \"success\",\n\t})\n\tawait fetchData()\n\tawait fetchNoticeOptions()\n  } catch (error) {\n\t  toast({\n\t      message: error.message || \"发布失败\",\n\t      color: \"danger\",\n\t  })\n  } finally {\n\tshowConfirmDialog.value = false\n  }\n}\n\nconst handleCronPublish = async () => {\n\tconst combinedDate = date.value\n\tcombinedDate.setHours(time.value.getHours())\n\tcombinedDate.setMinutes(time.value.getMinutes())\n\tcombinedDate.setSeconds(0)\n\n\tconst params = {\n\t\tversion: cronForm.version,\n\t\tsystem: cronForm.system,\n\t\trelease_time: combinedDate.toLocaleString()\n\t}\n\ttry {\n\t\tawait cronPublishVersion(params)\n\t} catch (error) {\n\t} finally {\n\t\tisDatePickerVisible.value = false\n\t}\n}\n\nconst handleCancel = () => {\n  // toast({ message: '已取消推送', color: 'warning' })\n  showConfirmDialog.value = false\n}\n\nconst validateVersion = (value) => {\n  if (!value) return '版本号不能为空'  // 补充空值判断\n    const pattern = /^v\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9]+)?$/\n    return pattern.test(value) || '格式示例：v1.0.0 或 v2.3.4-beta'\n}\n\n// URL格式验证\nconst validateURL = (value) => {\n\tif (!value) return '下载链接不能为空'  // 补充空值判断\n\t  try {\n\t\tnew URL(value)\n\t\treturn true\n\t  } catch {\n\t\treturn '请输入有效的URL地址'\n\t  }\n}\n\nconst formValid = computed(() => {\n\tconsole.log(\"version is\",addForm.version)\n\tconsole.log(\"download_url is\",addForm.download_url)\n  return validateVersion(addForm.version) === true &&\n         validateURL(addForm.download_url) === true\n})\n\nconst queryParams = reactive({\n    page: 1,\n    pagesize: 15,\n})\n\nconst isAddModalVisible = ref(false)\nconst isPublishVisible = ref(false)\nconst addForm = reactive({\n\tversion: '',\n\tsystem: '',\n\tdownload_url: '',\n\trelease_notes: '',\n\trelease_notes_en: ''\n})\n\nconst addVersionForm = () => {\n    showAddModal.value = true\n}\n\nconst truncateText = (text, maxLength) => {\n      if (!text) return ''\n      return text.length > maxLength \n        ? text.slice(0, maxLength) + '...' \n        : text\n}\n\n// 修改 fetchData 方法\nconst fetchData = async () => {\n    loading.value = true\n    try {\n        const params = {\n            page: queryParams.page,\n            pagesize: queryParams.pagesize,\n\t\t\tcontent: searchContent?.value,\n\t\t\ttype: selectNotice.value?.value,\n\t\t\tis_published: selectPublish.value?.value\n        }\n\t\t\n\t\tif (searchSystem) {\n\t\t\tparams.system = searchSystem.value?.value\n\t\t}\n\n        const res = await noticeList(params)\n        // 因为拦截器已经处理了 res.data 的解构，这里直接使用返回值\n        if (res?.notices) {\n            notices.value = res.notices\n            totalItems.value = res.total\n        } else {\n            notices.value = []\n            totalItems.value = 0\n        }\n    } catch (error) {\n        console.error(\"获取数据失败:\", error)\n        toast({\n            message: error.message || \"获取数据失败\",\n            color: \"danger\",\n        })\n        notices.value = []\n        totalItems.value = 0\n    } finally {\n        loading.value = false\n    }\n}\n\nimport { watch } from 'vue'\n\nwatch([searchSystem,searchContent,selectNotice,selectPublish], () => {\n    queryParams.page = 1\n    currentStartIndex.value = 1\n    fetchData()\n\tfetchNoticeOptions()\n})\n\nconst columns = [\n\t{ key: 'id', label: '序号' },\n\t{ key: 'type', label: '通知类型' },\n    { key: 'title', label: '标题' },\n\t{ key: 'spec', label: '概览' },\n    // { key: 'content', label: '内容' },\n\t{ key: 'belonged_user', label: '推送用户' },\n    { key: 'created_time', label: '通知时间' },\n\t{ key: 'is_published', label: '推送状态' },\n    { key: 'actions', label: '操作' }  // 添加操作列\n]\n\nconst isEditModalVisible = ref(false)\nconst editForm = reactive({\n\tid: null,\n\ttitle: '',\n\ttitle_en: '',\n\tspec: '',\n\tspec_en: '',\n\ttype: '',\n\tcontent: '',\n\tcontent_en: '',\n\tbelonged_user: ''\n})\n\nconst editNotice = (row) => {\n\teditForm.id = row.rowData.id\n    editForm.title = row.rowData.title\n\teditForm.spec = row.rowData.spec\n\teditForm.type = row.rowData.type\n    editForm.content = row.rowData.content\n\teditForm.belonged_user = row.rowData.belonged_user\n    isEditModalVisible.value = true\n}\n\n\n\nconst onOk = async () => {\n\tif (!isEditFormValid()) {\t\n\t  toast({\n\t    message: '请检查输入内容是否符合要求',\n\t    color: 'danger'\n\t  })\n\t  return\n\t}\n\t\n\tconst params = {\n\t\ttitle: editForm.title,\n\t\ttitle_en: editForm.title,\n\t    spec: editForm.spec,\n\t    spec_en: editForm.spec,\n\t\ttype: editForm.type.value,\n\t\tcontent: editForm.content,\n\t\tcontent_en: editForm.content_en,\n\t\tbelonged_user: editForm.belonged_user\n\t}\n\t\n    try {\n        const msg = await modifyNotice(editForm.id, params)\n\t\tisEditModalVisible.value = false\n\t\tfetchData()\n        toast({\n            message: msg,\n            color: \"success\",\n        })\n    } catch (error) {\n        toast({\n            message: error.message || \"修改失败\",\n            color: \"danger\",\n        })\n    } finally {\n\t}\n}\n\nconst publishNewVersion = async (version,system) => {\n    try {\n        const msg = await publishVersion(version,system)\n\t\ttoast({\n\t\t  message: msg,\n\t\t  color: 'success',\n\t\t  duration: 3000\n\t\t})\n        await fetchData()\n\t\tawait fetchNoticeOptions()\n    } catch (error) {\n        toast({\n            message: error.message || \"发布失败\",\n            color: \"danger\",\n\t\t\tduration: 5000\n        })\n    }\n}\n\nconst cronPublishVersion = async (params) => {\n    try {\n        const msg = await timedPublishVersion(params)\n\t\ttoast({\n\t\t  message: msg,\n\t\t  color: 'success',\n\t\t  duration: 30000\n\t\t})\n        await fetchData()\n\t\tfetchNoticeOptions()\n    } catch (error) {\n        toast({\n            message: error.message || \"定时发布失败\",\n            color: \"danger\",\n\t\t\tduration: 5000\n        })\n    }\n}\n\nconst onAddOk = async () => {\n\t\ttry {\n\t\t    const msg = await addVersion({\n\t\t        version: addForm.version,\n\t\t\t\tsystem: addForm.system?.value,\n\t\t        download_url: addForm.download_url,\n\t\t        release_notes: addForm.release_notes,\n\t\t\t\trelease_notes_en: addForm.release_notes_en\n\t\t    })\n\t\t    toast({\n\t\t        message: msg,\n\t\t        color: \"success\",\n\t\t    })\n\t\t    await fetchData()\n\t\t    isAddModalVisible.value = false\n\t\t} catch (error) {\n\t\t    console.error(\"修改失败:\", error)\n\t\t    toast({\n\t\t        message: error.message || \"修改失败\",\n\t\t        color: \"danger\",\n\t\t    })\n\t\t}\t\n}\n\nconst onCancel = () => {\n    isEditModalVisible.value = false\n    resetForm()\n}\n\nconst onCronCancel = () => {\n\tisDatePickerVisible.value = false\n}\n\nconst onAddCancel = () => {\n    isAddModalVisible.value = false\n    resetAddForm()\n}\n\nconst resetForm = () => {\n    editForm.version = ''\n\teditForm.system = ''\n    editForm.download_url = ''\n    editForm.release_notes = ''\n\teditForm.release_notes_en = ''\n}\n\nconst resetAddForm = () => {\n\taddForm.version = ''\n\taddForm.system = ''\n\taddForm.download_url = ''\n\taddForm.release_notes = ''\n\taddForm.release_notes_en = ''\n}\n\n// 分页\nconst handlePageChange = (startIndex) => {\n    queryParams.page = Math.ceil(startIndex / queryParams.pagesize)\n    currentStartIndex.value = startIndex\n    fetchData()\n\tfetchNoticeOptions()\n}\n\nconst refreshData = () => {\n\tsearchSystem.value = ''\n\tsearchContent.value = ''\n\tselectNotice.value = ''\n    fetchData()\n\tfetchNoticeOptions()\n}\n\n// 初始化加载数据\nfetchData()\nfetchNoticeOptions()\n</script>\n\n<style scoped>\n.modal-content {\n  padding: 1rem 2rem;\n}\n\n.text-danger {\n  color: var(--va-danger);\n}\n\n.va-input--error {\n  border-color: var(--va-danger);\n}\n\n/* .va-input__message-text {\n  color: var(--va-danger);\n  font-size: 0.8rem;\n  margin-top: 4px;\n} */\n\t\n.dialog-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 0;\n}\n\n.header-text {\n  font-size: 1.2em;\n  font-weight: 600;\n  color: var(--va-primary);\n}\n\n/* 内容区域样式 */\n.dialog-content {\n  line-height: 1.6;\n  padding: 12px 0;\n}\n\n.version-info {\n  font-size: 1.1em;\n  margin-bottom: 12px;\n}\n\n.version-highlight {\n  color: var(--va-success);\n  font-weight: 500;\n  font-family: monospace;\n}\n\n.system-highlight {\n  color: #126fc4;\n  font-weight: 500;\n  font-family: monospace;\n}\n\n.confirm-text {\n  color: var(--va-danger);\n  margin-top: 16px;\n  font-size: 0.95em;\n}\n\n/* 按钮样式覆盖 */\n:deep(.va-modal__ok-button) {\n  font-weight: 600;\n  letter-spacing: 0.5px;\n}\n\n:deep(.va-modal__cancel-button) {\n  opacity: 0.8;\n}\n\n.machines-list {\n    padding: 20px;\n}\n\n.filters-row {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 10px;\n    align-items: center;\n    margin-top: 0; /* 移除之前的 mt-4 */\n}\n\n.filter-item {\n    min-width: 150px;\n}\n\n.mobile-list-item {\n    padding: 10px;\n}\n\n.mobile-actions {\n    display: flex;\n    justify-content: flex-end;\n    margin-top: 10px;\n}\n\n.action-buttons {\n    display: flex;\n    gap: 0.5rem;\n    justify-content: center;\n    padding-left: 5px;\n    padding-right: 5px;\n    min-width: 40px; /* 确保按钮有足够空间 */\n  }\n\n@media (max-width: 768px) {\n    .machines-list {\n        padding: 10px;\n    }\n\n    .filter-item {\n        width: 100%;\n        min-width: unset;\n    }\n}\n\n.custom-modal .va-modal-footer {\n  display: none; /* 隐藏默认的 footer */\n}\n\n.action-container {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  min-width: 160px; /* 保持列宽一致 */\n}\n\n/* 图标按钮统一样式 */\n.action-icon {\n  width: 28px;\n  height: 28px;\n  padding: 6px;\n  margin: 0 2px;\n}\n\n/* 悬停效果增强 */\n.va-button:hover {\n  transform: scale(1.1);\n  transition: transform 0.2s;\n}\n\n/* 下拉菜单定位 */\n.more-actions {\n  margin-left: auto;\n}\n\n/* 统一按钮尺寸 */\n.aligned-button {\n  min-width: 28px !important;\n  height: 28px !important;\n  padding: 6px 8px !important;  /* 与其他按钮一致 */\n  line-height: 1 !important;\n}\n\n/* 微调图标位置 */\n:deep(.va-button__content) {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n/* 确保所有按钮容器对齐 */\n.action-container > * {\n  vertical-align: middle;\n}\n\n.large-textarea {\n  /* 固定宽度 */\n  width: 800px;\n  /* 最小高度 */\n  min-height: 300px;\n  \n  /* 响应式适配 */\n  @media (max-width: 768px) {\n    width: 100%;\n    min-height: 200px;\n  }\n  \n  /* 文本域内部样式 */\n  ::v-deep .va-input-wrapper__textarea {\n    font-size: 16px;\n    line-height: 1.6;\n    padding: 1rem;\n  }\n}\n</style>"],"names":["noticeList","params","get","addNotice","data","put","response","modifyNotice","id","patch","deleteNotice","pushNotice","noticeTypes","toast","useToast","useForm","isDeleteConfirmVisible","ref","deleteId","searchContent","selectNotice","showAddModal","title","spec","content","addUid","addType","noticeTypeOptions","noticeSpecTypeOptions","uidOptions","openDeleteConfirm","rowData","convertToOptions","arr","item","fetchNoticeOptions","defaultOption","uids","getUserUids","error","selectPublish","publishedOptions","titleLength","specLength","contentLength","isFormValid","isEditFormValid","editForm","resetAddNoticeForm","handleSubmit","fetchData","cancel","confirmDelete","cancelDelete","reactive","systemOptions","searchSystem","time","date","isDatePickerVisible","requiredRule","value","dateValidationRule","now","cronForm","isDateTimeValid","computed","currentStartIndex","totalItems","notices","loading","pendingNoticeId","showConfirmDialog","pendingUid","pendingType","confirmPublish","row","handleConfirm","msg","handleCronPublish","combinedDate","cronPublishVersion","handleCancel","validateVersion","validateURL","addForm","queryParams","addVersionForm","truncateText","text","maxLength","_a","_b","_c","res","watch","columns","isEditModalVisible","editNotice","onOk","timedPublishVersion","onCancel","resetForm","onCronCancel","handlePageChange","startIndex","refreshData"],"mappings":"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"}