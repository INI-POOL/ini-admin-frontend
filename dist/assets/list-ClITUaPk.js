import{p as U}from"./request-BugqCKoK.js";import{f as $}from"./date-BVCtguWR.js";import{u as Q}from"./useToast-CmiBuZ4D.js";import{_ as W,r as d,U as G,c as H,h as o,w as l,F as J,f as n,a as k,b as a,i as c,t as r,u as I,g as z,k as M}from"./index-DXAis1cf.js";function K(m){return U("/api/v1/back_stage/machine/list",m)}function R(m,i){return U(`/api/v1/back_stage/machine/modify?id=${m}`,i)}const X={class:"mb-4"},Y={class:"filters-row"},ee={class:"table-responsive"},se={class:"flex justify-end mt-4"},ae={class:"ml-4 self-center text-gray-600"},te={class:"transfer-header",style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",gap:"0.62rem","padding-top":"1rem"}},oe={class:"time"},ne={class:"transfer-info"},le={class:"info-row"},re={class:"value-box"},ie={class:"value"},de={class:"info-row"},ce={class:"value-box"},me={class:"value"},ue={class:"info-row"},pe={class:"value-box"},ve={class:"info-row"},fe={class:"value-box"},_e={class:"transaction-id"},be={class:"value-box"},ye={class:"value"},ge=["href"],ke={__name:"list",setup(m){const{init:i}=Q(),V=d(""),h=d(null),_=d(1),b=d(100),C=d([]),T=d(!1),u=G({page:1,pagesize:10}),P=[{value:"active",text:"运行中"},{value:"inactive",text:"已停止"},{value:"error",text:"错误"}],B=[{key:"id",label:"机器ID"},{key:"hostname",label:"机器名"},{key:"idc",label:"机房"},{key:"hostname",label:"名称"},{key:"currency",label:"币种"},{key:"model_name",label:"机器类型"},{key:"sub_user_name",label:"子账户名"},{key:"uid",label:"用户UID"},{key:"mobile",label:"手机号"},{key:"last_seen",label:"上次提交时间"},{key:"created_time",label:"创建时间"},{key:"actions",label:"操作"}],N=e=>{u.page=Math.ceil(e/u.pagesize),_.value=e,p()},p=async()=>{T.value=!0;try{const e=await K(u);e&&typeof e.total=="number"?(C.value=e.machines||[],b.value=e.total):(console.error("API返回数据格式错误:",e),i({message:"数据格式错误",color:"danger"}))}catch(e){console.error("获取数据失败:",e),i({message:"获取数据失败",color:"danger"})}finally{T.value=!1}},F=()=>{p()},j=async e=>{try{await R(e.id,e),i({message:"更新成功",color:"success"}),await p()}catch(s){console.error("更新失败:",s),i({message:"更新失败",color:"danger"})}},x=async e=>{};return p(),(e,s)=>{const D=n("va-icon"),L=n("va-input"),S=n("va-select"),y=n("va-button"),Z=n("va-button-group"),q=n("VaDataTable"),A=n("VaPagination"),E=n("va-card"),w=n("VaDivider"),g=n("VaIcon"),O=n("VaModal");return k(),H(J,null,[o(E,{class:"machines-list"},{default:l(()=>[a("div",X,[o(L,{modelValue:V.value,"onUpdate:modelValue":s[0]||(s[0]=t=>V.value=t),placeholder:"搜索矿机...",class:"mb-2",style:{maxWidth:"100%"}},{prepend:l(()=>[o(D,{name:"search"})]),_:1},8,["modelValue"]),a("div",Y,[o(S,{modelValue:h.value,"onUpdate:modelValue":s[1]||(s[1]=t=>h.value=t),options:P,placeholder:"状态筛选",class:"filter-item"},null,8,["modelValue"]),o(y,{onClick:F,class:"ml-2"},{default:l(()=>[o(D,{name:"refresh"}),s[9]||(s[9]=c(" 刷新 "))]),_:1})])]),a("div",ee,[o(q,{items:C.value,columns:B,striped:"",class:"responsive-table"},{"cell(created_time)":l(({value:t})=>[c(r(I($)(t)),1)]),"cell(actions)":l(({row:t})=>[o(Z,null,{default:l(()=>[o(y,{small:"",icon:"edit",color:"primary",onClick:v=>j(t)},null,8,["onClick"]),o(y,{small:"",icon:"delete",color:"danger",onClick:v=>x(t)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["items"])]),a("div",se,[o(A,{modelValue:_.value,"onUpdate:modelValue":[s[2]||(s[2]=t=>_.value=t),N],"page-size":u.pagesize,"visible-pages":"5",total:b.value,"buttons-preset":"secondary","boundary-numbers":""},null,8,["modelValue","page-size","total"]),a("span",ae," 共 "+r(b.value)+" 条记录 ",1)])]),_:1}),o(O,{modelValue:e.detailVisible,"onUpdate:modelValue":s[8]||(s[8]=t=>e.detailVisible=t),title:"转账详情",size:"medium",class:"mr-6 my-1","close-button":""},{content:l(()=>{var t,v;return[a("div",te,[a("div",oe,r(I($)(e.transfer.created_time)),1)]),o(w),a("div",ne,[a("div",le,[s[10]||(s[10]=a("span",{class:"label"},"数额：",-1)),a("div",re,[a("span",ie,r(e.removeTrailingZeros((t=e.transfer)==null?void 0:t.amount)||0)+" "+r(e.transfer.currency),1)])]),a("div",de,[s[11]||(s[11]=a("span",{class:"label"},"提款手续费：",-1)),a("div",ce,[a("span",me,r(e.removeTrailingZeros((v=e.transfer)==null?void 0:v.gas_fee)||0)+" "+r(e.transfer.currency),1)])]),a("div",ue,[s[13]||(s[13]=a("span",{class:"label"},"收款地址：",-1)),a("div",pe,[a("span",{class:"value",onClick:s[3]||(s[3]=f=>e.copyText(e.transfer.to_addr))},r(e.transfer.to_addr),1),o(g,{class:"material-icons",onClick:s[4]||(s[4]=f=>e.copyText(e.transfer.to_addr))},{default:l(()=>s[12]||(s[12]=[c(" content_copy ")])),_:1})])]),a("div",ve,[s[15]||(s[15]=a("span",{class:"label"},"付款地址：",-1)),a("div",fe,[a("span",{class:"value",onClick:s[5]||(s[5]=f=>e.copyText(e.transfer.from_addr))},r(e.transfer.from_addr),1),e.transfer.from_addr?(k(),z(g,{key:0,class:"material-icons",onClick:s[6]||(s[6]=f=>e.copyText(e.transfer.from_addr))},{default:l(()=>s[14]||(s[14]=[c(" content_copy ")])),_:1})):M("",!0)])])]),o(w),a("div",_e,[s[17]||(s[17]=a("span",{class:"label"},"交易号：",-1)),a("div",be,[a("span",ye,[a("a",{href:`https://mainnet.aleo123.io/transactionDetail/${e.transfer.tx_id}`,target:"_blank"},r(e.transfer.tx_id),9,ge)]),e.transfer.tx_id?(k(),z(g,{key:0,class:"material-icons",onClick:s[7]||(s[7]=f=>e.copyText(e.transfer.tx_id))},{default:l(()=>s[16]||(s[16]=[c(" content_copy ")])),_:1})):M("",!0)])])]}),_:1},8,["modelValue"])],64)}}},De=W(ke,[["__scopeId","data-v-bdc49195"]]);export{De as default};
//# sourceMappingURL=list-ClITUaPk.js.map
