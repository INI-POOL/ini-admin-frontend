import{d as B,W as U,r as V,T as S,o as q,f as r,a as _,g as v,w as u,b as k,h as l,u as c,J as w,k as A,i as L,X as y,Y as b}from"./index-B0sGV8sl.js";import{u as Y}from"./useToast-BUyZxyTE.js";import{v as d,g as I}from"./utils-mi3Titu2.js";import{i as F,c as M}from"./user-Bx5HtWxF.js";import"./request-C4MOa17j.js";const j={class:"flex justify-center mt-4"},X=B({__name:"Login",setup(z){const{push:p}=U(),{init:t}=Y(),n=V(!1),i=V(0),e=S({username:"",password:"",google_code:"",keepLoggedIn:!1}),x=()=>{e.username.trim()==="umpool"&&i.value===1?n.value=!0:n.value=!1};q(async()=>{await C()});const C=async()=>{try{const s=await F("umpool");i.value=s}catch(s){console.error("Error checking Google code requirement:",s)}},g=()=>{if(n.value===!0&&e.google_code==""){t({message:"谷歌认证码不能为空",color:"danger"});return}if(e.username.trim()==="umpool"&&e.password.trim()==="gT9@pY6uV*2S"&&n.value===!0)M({user_name:e.username,google_code:e.google_code}).then(s=>{if(s===1){const o=I();y(o),b(e.username),t({message:"登陆成功！",color:"success"}),p({name:"withdraw"})}else t({message:"谷歌认证码错误",color:"danger"})}).catch(s=>{s.response?t({message:s.response.data.msg,color:"danger"}):t({message:"无效参数",color:"danger"})});else if(e.username.trim()==="admin"&&e.password.trim()==="A3f!7#b2Pz9L"||e.username==="umpool"&&e.password==="gT9@pY6uV*2S"){const s=I();y(s),b(e.username),t({message:"登陆成功！",color:"success"}),p({name:"withdraw"})}else t({message:"登陆失败！",color:"error"})};return(s,o)=>{const m=r("VaInput"),G=r("VaIcon"),T=r("VaValue"),h=r("VaButton"),N=r("VaForm");return _(),v(N,{ref:"form",onSubmit:w(g,["prevent"])},{default:u(()=>[o[4]||(o[4]=k("h1",{class:"font-semibold text-4xl mb-4"},"登陆",-1)),l(m,{modelValue:e.username,"onUpdate:modelValue":o[0]||(o[0]=a=>e.username=a),rules:[c(d).required,c(d).username],class:"mb-4",label:"用户名",type:"text",onInput:x},null,8,["modelValue","rules"]),l(T,{"default-value":!1},{default:u(a=>[l(m,{modelValue:e.password,"onUpdate:modelValue":o[1]||(o[1]=f=>e.password=f),rules:[c(d).required],type:a.value?"text":"password",class:"mb-4",label:"密码",onClickAppendInner:w(f=>a.value=!a.value,["stop"])},{appendInner:u(()=>[l(G,{name:a.value?"mso-visibility_off":"mso-visibility",class:"cursor-pointer",color:"secondary"},null,8,["name"])]),_:2},1032,["modelValue","rules","type","onClickAppendInner"])]),_:1}),n.value?(_(),v(m,{key:0,modelValue:e.google_code,"onUpdate:modelValue":o[2]||(o[2]=a=>e.google_code=a),class:"mb-4",label:"谷歌验证码",type:"text"},null,8,["modelValue"])):A("",!0),k("div",j,[l(h,{class:"w-full",onClick:g},{default:u(()=>o[3]||(o[3]=[L(" 登陆")])),_:1})])]),_:1},512)}}});export{X as default};
//# sourceMappingURL=Login-DhYYlY-A.js.map
