{"version":3,"file":"notice-B_U5V50W.js","sources":["../../src/api/notice.js","../../src/pages/notice/notice.vue"],"sourcesContent":["import { patch,get,post,put,getWithConfig,deleteFunc } from \"./request\";\n\n// 查询机器可选项\nexport function noticeList(params) {\n  return get(\"/api/v1/back_stage/notice/list\",params);\n}\n\nexport function addNotice(data) {\n  return put(\"/api/v1/back_stage/notice/add\",data)\n  .then((response) => {\n    if (!response) {\n      throw new Error(\"请求失败，未返回响应数据\");\n    }\n    return response;\n  });\n}\n\nexport function modifyNotice(id, data) {\n  return patch(`/api/v1/back_stage/notice/modify?id=${id}`, data)\n    .then((response) => {\n      if (!response) {\n        throw new Error(\"请求失败，未返回响应数据\");\n      }\n      return response;\n    });\n}\n\nexport function deleteNotice(id) {\n  return patch(`/api/v1/back_stage/notice/delete?id=${id}`)\n    .then((response) => {\n      if (!response) {\n        throw new Error(\"请求失败，未返回响应数据\");\n      }\n      return response;\n    });\n}\n\nexport function pushNotice(data) {\n  return put('/api/v1/back_stage/notice/push',data)\n    .then((response) => {\n      if (!response) {\n        throw new Error(\"请求失败，未返回响应数据\");\n      }\n      return response;\n    });\n}\n\nexport function noticeTypes() {\n\treturn get(\"/api/v1/back_stage/notice/type\");\n}","<template>\n    <va-card class=\"machines-list\">\n        <!-- 搜索和过滤区域 -->\n        <div class=\"mb-4\">\n            <div class=\"filters-row\">\n\t\t\t\t内容查询：\n\t\t\t\t<va-input v-model=\"searchContent\" placeholder=\"请输入消息内容\" class=\"mb-1 mr-6\" :style=\"{ maxWidth: '13%' }\">\n\t\t\t\t    <template #prepend>\n\t\t\t\t        <!-- <va-icon name=\"mobile\" /> -->\n\t\t\t\t    </template>\n\t\t\t\t</va-input>\n\t\t\t\t类型筛选：\n\t\t\t\t<va-select\n\t\t\t\t    v-model=\"selectNotice\"\n\t\t\t\t    :options=\"noticeTypeOptions\"\n\t\t\t\t    placeholder=\"请选择通知类型\"\n\t\t\t\t    class=\"mb-1\"\n\t\t\t\t    :style=\"{ maxWidth: '16%' }\"\n\t\t\t\t/>\n\t\t\t\t<va-button @click=\"addVersionForm\" color=\"rgb(47, 148, 172)\" class=\"mb-1 ml-6\">\n\t\t\t\t    新增通知\n\t\t\t\t</va-button>\n\t\t\t\t<va-button @click=\"refreshData\" color=\"rgb(47, 148, 172)\" class=\"mb-1 ml-6\">\n\t\t\t\t    刷新\n\t\t\t\t</va-button>\n\t\t\t\t<VaModal\n\t\t\t\t    v-model=\"isAddModalVisible\"\n\t\t\t\t    title=\"新增版本\"\n\t\t\t\t    @cancel=\"onAddCancel\"\n\t\t\t\t    @ok=\"onAddOk\"\n\t\t\t\t\t:ok-disabled=\"true\"\n\t\t\t\t>\n\t\t\t\t    <VaForm>\n\t\t\t\t\t\t<VaInput\n\t\t\t\t\t\t    v-model=\"addForm.version\"\n\t\t\t\t\t\t    label=\"版本号\"\n\t\t\t\t\t\t\t:rules=\"[validateVersion]\"\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t    class=\"mb-2\"\n\t\t\t\t\t\t\tplaceholder=\"v1.0.0\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<va-select\n\t\t\t\t\t\t\t\tv-model=\"addForm.system\"\n\t\t\t\t\t\t\t\tlabel=\"操作系统\"\n\t\t\t\t\t\t\t\t:options=\"systemWithOutAllOptions\"\n\t\t\t\t\t\t\t\tplaceholder=\"IOS\"\n\t\t\t\t\t\t\t\tclass=\"mb-2\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t        <VaInput\n\t\t\t\t            v-model=\"addForm.download_url\"\n\t\t\t\t            label=\"下载链接\"\n\t\t\t\t            type=\"url\"\n\t\t\t\t            :rules=\"[validateURL]\"\n\t\t\t\t            required\n\t\t\t\t            class=\"mb-2\"\n\t\t\t\t\t\t\tplaceholder=\"https://apps.apple.com/app/...\"\n\t\t\t\t        />\n\t\t\t\t\t\t<VaInput\n\t\t\t\t\t\t    v-model=\"addForm.release_notes\"\n\t\t\t\t\t\t    label=\"更新日志 (如需换行请用','隔开)\"\n\t\t\t\t\t\t    type=\"textarea\"\n\t\t\t\t\t\t    class=\"mb-2\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<VaInput\n\t\t\t\t\t\t    v-model=\"addForm.release_notes_en\"\n\t\t\t\t\t\t    label=\"更新日志英文版 (如需换行请用','隔开)\"\n\t\t\t\t\t\t    type=\"textarea\"\n\t\t\t\t\t\t    class=\"mb-2\"\n\t\t\t\t\t\t/>\n\t\t\t\t    </VaForm>\n\t\t\t\t</VaModal>\t\t\n            </div>\n        </div>\n\n        <!-- 列表区域 -->\n        <div class=\"table-responsive\">\n            \n            <VaDataTable :items=\"notices\" :columns=\"columns\" striped class=\"responsive-table\">\n\t\t\t\t<template #cell(created_time)=\"{ value }\">\n\t\t\t\t    {{ formatDateTime(value) }}\n\t\t\t\t</template>\n\t\t\t\t<template #cell(content)=\"{ value }\">\n\t\t\t\t   <template v-if=\"!value\">无</template>\n\t\t\t\t\n\t\t\t\t   <a v-else :title=\"value\" :href=\"value\" target=\"_blank\">  <!-- 悬浮显示完整内容 -->\n\t\t\t\t\t {{ truncateText(value, 10) }}\n\t\t\t\t   </a>\n\t\t\t\t</template>\n                <template #cell(actions)=\"{ row }\">\n\t\t\t\t\t  <div class=\"action-container\">\n\t\t\t\t\t    <!-- 主要操作：紧凑图标按钮 -->\n\t\t\t\t\t\t<va-button-group>\n\t\t\t\t\t\t\t<!-- <va-button \n\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t\ticon=\"edit\"\n\t\t\t\t\t\t\t\tcolor=\"rgb(47, 148, 172)\"\n\t\t\t\t\t\t\t\t@click=\"editVersion(row)\"\n\t\t\t\t\t\t\t\ttitle=\"修改通知内容\"\n\t\t\t\t\t\t\t\tclass=\"action-icon\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<va-button\n\t\t\t\t\t\t\t  icon=\"rocket_launch\"\n\t\t\t\t\t\t\t  size=\"small\"\n\t\t\t\t\t\t\t  color=\"rgb(47, 148, 172)\"\n\t\t\t\t\t\t\t  title=\"推送\"\n\t\t\t\t\t\t\t  @click=\"confirmPublish(row)\"\n\t\t\t\t\t\t\t  class=\"action-icon\"\n\t\t\t\t\t\t\t/> -->\n\t\t\t\t\t\t\t<va-button\n\t\t\t\t\t\t\t  size=\"small\"\n\t\t\t\t\t\t\t  icon=\"delete\"\n\t\t\t\t\t\t\t  color=\"rgb(208, 24, 39)\"\n\t\t\t\t\t\t\t  title=\"删除版本\"\n\t\t\t\t\t\t\t  @click=\"openDeleteConfirm(row.rowData)\"\n\t\t\t\t\t\t\t  class=\"action-icon\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</va-button-group>\n\t\t\t\t\t  </div>\n                </template>\n            </VaDataTable>\n            \n            <!-- 添加编辑弹窗 -->\n            <VaModal\n                v-model=\"isEditModalVisible\"\n                title=\"修改版本信息\"\n                @cancel=\"onCancel\"\n                @ok=\"onOk\"\n\t\t\t\t:ok-props=\"{ color: 'rgb(47, 148, 172)', textColor: 'white' }\"\n\t\t\t\t:cancel-props=\"{ color: 'rgb(47, 148, 172)', textColor: 'white' }\"\n            >\n                <VaForm>\n\t\t\t\t\t<VaInput\n\t\t\t\t\t    v-model=\"editForm.version\"\n\t\t\t\t\t    label=\"版本号\"\n\t\t\t\t\t    type=\"string\"\n\t\t\t\t\t    class=\"mb-3\"\n\t\t\t\t\t\treadonly\n\t\t\t\t\t/>\n\t\t\t\t\t<VaInput\n\t\t\t\t\t    v-model=\"editForm.system\"\n\t\t\t\t\t    label=\"系统\"\n\t\t\t\t\t    type=\"string\"\n\t\t\t\t\t    class=\"mb-3\"\n\t\t\t\t\t\treadonly\n\t\t\t\t\t/>\n                    <VaInput\n                        v-model=\"editForm.download_url\"\n                        label=\"下载链接\"\n                        type=\"string\"\n                        class=\"mb-3\"\n                    />\t\n\t\t\t\t\t<VaInput\n\t\t\t\t\t    v-model=\"editForm.release_notes\"\n\t\t\t\t\t    label=\"更新日志 (如需换行请用','隔开)\"\n\t\t\t\t\t    type=\"textarea\"\n\t\t\t\t\t    class=\"mb-3\"\n\t\t\t\t\t/>\t\n\t\t\t\t\t<VaInput\n\t\t\t\t\t    v-model=\"editForm.release_notes_en\"\n\t\t\t\t\t    label=\"更新日志英文版 (如需换行请用','隔开)\"\n\t\t\t\t\t    type=\"textarea\"\n\t\t\t\t\t    class=\"mb-3\"\n\t\t\t\t\t/>\t\n                </VaForm>\n            </VaModal>\n\t\t\t\n\t\t\t<va-modal v-model=\"isDatePickerVisible\" hide-default-actions title=\"选择发布时间\">\n\t\t\t    <VaDateInput v-model=\"date\" />\n\t\t\t\t<VaTimeInput v-model=\"time\" class=\"ml-2\" />\n\t\t\t\n\t\t\t    <va-button-group>\n\t\t\t\t\t<va-button\n\t\t\t\t\t  block \n\t\t\t\t\t  @click=\"onCronCancel\"\n\t\t\t\t\t  color=\"rgb(47, 148, 172)\"\n\t\t\t\t\t  class=\"mt-4\"\n\t\t\t\t\t>\n\t\t\t\t\t  取消\n\t\t\t\t\t</va-button>\n\t\t\t\t\t<va-button\n\t\t\t\t\t  block \n\t\t\t\t\t  @click=\"handleCronPublish\"\n\t\t\t\t\t  :disabled=\"!isDateTimeValid\"\n\t\t\t\t\t  color=\"rgb(47, 148, 172)\"\n\t\t\t\t\t  class=\"mt-4 ml-2\"\n\t\t\t\t\t>\n\t\t\t\t\t  确认发布\n\t\t\t\t\t</va-button>\n\t\t\t\t</va-button-group>\n\n\t\t\t  </va-modal>\n\t\t\t  \t\t\t\n\t\t\t<VaModal\n\t\t\t    v-model=\"showConfirmDialog\"\n\t\t\t\ttitle=\"系统提示\"\n\t\t\t\tok-text=\"🚀 确认发布\"\n\t\t\t\tcancel-text=\"暂不发布\"\n\t\t\t    @ok=\"handleConfirm\"\n\t\t\t    @cancel=\"handleCancel\"\n\t\t\t  >\n\t\t\t\t<template #header>\n\t\t\t\t  <div class=\"dialog-header\">\n\t\t\t\t\t<va-icon name=\"warning\" color=\"warning\" />\n\t\t\t\t\t<span class=\"header-text\">版本发布确认</span>\n\t\t\t\t  </div>\n\t\t\t\t</template>\n\t\t\t\n\t\t\t\t<div class=\"dialog-content\">\n\t\t\t\t  <p class=\"version-info\">\n\t\t\t\t\t即将为 <span class=\"system-highlight\">{{ getSystemText(pendingSystem) }}</span> 系统发布版本：<span class=\"version-highlight\">{{ pendingVersion }}</span>\n\t\t\t\t  </p>\n\t\t\t\t  <va-divider />\n\t\t\t\t  <p class=\"confirm-text\">该操作将立即生效且不可逆转，请确认是否继续？</p>\n\t\t\t\t</div>\n\t\t\t  </VaModal>\n\t\t\t  \n\t\t\t    <VaModal\n\t\t\t      v-model=\"isDeleteConfirmVisible\"\n\t\t\t      title=\"系统提示\"\n\t\t\t      size=\"small\"\n\t\t\t      :message=\"deleteConfirmMessage\"\n\t\t\t      @ok=\"confirmDelete\"\n\t\t\t      @cancel=\"cancelDelete\"\n\t\t\t      ok-text=\"确认\"\n\t\t\t      cancel-text=\"取消\"\n\t\t\t      :ok-props=\"{ color: 'danger' }\"\n\t\t\t    >\n\t\t\t\t\t<template #header>\n\t\t\t\t\t  <div class=\"dialog-header\">\n\t\t\t\t\t\t<va-icon name=\"warning\" color=\"warning\" />\n\t\t\t\t\t\t<span class=\"header-text\">确认删除？</span>\n\t\t\t\t\t  </div>\n\t\t\t\t\t</template>\n\t\t\t\t</VaModal>\n\t\t\t\t\n\t\t\t\t<va-modal v-model=\"showAddModal\" hide-default-actions size=\"medium\">\n\t\t\t\t      <template #header>\n\t\t\t\t        <h5 class=\"va-h5\">发布新通知</h5>\n\t\t\t\t      </template>\n\t\t\t\t\n\t\t\t\t      <div class=\"modal-content\">\n\t\t\t\t        <!-- 标题输入 -->\n\t\t\t\t        <va-input\n\t\t\t\t          v-model=\"title\"\n\t\t\t\t          label=\"标题\"\n\t\t\t\t          placeholder=\"请输入标题...\"\n\t\t\t\t          class=\"mb-4\"\n\t\t\t\t          :max-length=\"50\"\n\t\t\t\t          counter\n\t\t\t\t        >\n\t\t\t\t          <template #counter=\"{ valueLength }\">\n\t\t\t\t            <span :class=\"{ 'text-danger': valueLength > 50 }\">\n\t\t\t\t              {{ valueLength }}/50\n\t\t\t\t            </span>\n\t\t\t\t          </template>\n\t\t\t\t        </va-input>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<va-input\n\t\t\t\t\t\t  v-model=\"spec\"\n\t\t\t\t\t\t  label=\"概述\"\n\t\t\t\t\t\t  placeholder=\"请输入概述...\"\n\t\t\t\t\t\t  class=\"mb-4\"\n\t\t\t\t\t\t  :max-length=\"100\"\n\t\t\t\t\t\t  counter\n\t\t\t\t\t\t>\n\t\t\t\t\t\t  <template #counter=\"{ valueLength }\">\n\t\t\t\t\t\t    <span :class=\"{ 'text-danger': valueLength > 100 }\">\n\t\t\t\t\t\t      {{ valueLength }}/100\n\t\t\t\t\t\t    </span>\n\t\t\t\t\t\t  </template>\n\t\t\t\t\t\t</va-input>\n\t\t\t\t\n\t\t\t\t        <!-- 内容输入 -->\n\t\t\t\t        <VaTextarea\n\t\t\t\t          v-model=\"content\"\n\t\t\t\t          label=\"内容 (支持HTML语言)\"\n\t\t\t\t          placeholder=\"请输入详细内容...\"\n\t\t\t\t          autosize\n\t\t\t\t          :min-rows=\"10\"\n\t\t\t\t\t\t  :max-rows=\"20\"\n\t\t\t\t          :max-length=\"2000\"\n\t\t\t\t          counter\n\t\t\t\t          class=\"mb-6\"\n\t\t\t\t\t\t  :style=\"{ width: '1000px' }\"\n\t\t\t\t        >\n\t\t\t\t          <template #counter=\"{ valueLength }\">\n\t\t\t\t            <span :class=\"{ 'text-danger': valueLength > 2000 }\">\n\t\t\t\t              {{ valueLength }}/2000\n\t\t\t\t            </span>\n\t\t\t\t          </template>\n\t\t\t\t        </VaTextarea>\n\t\t\t\t\n\t\t\t\t        <!-- 操作按钮 -->\n\t\t\t\t        <div class=\"flex justify-end gap-4\">\n\t\t\t\t          <va-button\n\t\t\t\t            color=\"secondary\"\n\t\t\t\t            @click=\"cancel\"\n\t\t\t\t          >\n\t\t\t\t            取消\n\t\t\t\t          </va-button>\n\t\t\t\t          <va-button\n\t\t\t\t            :disabled=\"!isFormValid\"\n\t\t\t\t            @click=\"handleSubmit\"\n\t\t\t\t          >\n\t\t\t\t            提交\n\t\t\t\t          </va-button>\n\t\t\t\t        </div>\n\t\t\t\t      </div>\n\t\t\t\t    </va-modal>\n\t\t\t\t\t\n        </div>\n\n        <!-- 分页 -->\n        <div class=\"flex justify-end mt-4\">\n            <VaPagination\n                v-model=\"currentStartIndex\"\n                :page-size=\"queryParams.pagesize\"\n                visible-pages=\"5\"\n                :total=\"totalItems\"\n                buttons-preset=\"secondary\"\n                boundary-numbers\n                @update:modelValue=\"handlePageChange\"\n            />\n            <span class=\"ml-4 self-center text-gray-600\">\n                共 {{ totalItems }} 条记录\n            </span>\n        </div>\n    </va-card>\n</template>\n\n<script setup>\nimport dayjs from 'dayjs'\nimport { ElMessage } from 'element-plus'\nimport { ref, reactive, computed } from 'vue'\nimport { versionList, addVersion, modifyVersion, publishVersion,uploadApk,downloadApk,timedPublishVersion,deleteVersion } from \"../../api/version\"\nimport { noticeList, addNotice, modifyNotice, pushNotice,deleteNotice,noticeTypes } from \"../../api/notice\"\nimport { formatDateTime } from \"../../utils/date.ts\"\nimport { useToast, useForm } from \"vuestic-ui\"\nimport { saveAs } from 'file-saver'\n\nconst { init: toast } = useToast()\n\nconst { isValid, validate } = useForm('addFormRef')\n\nconst requiredAddRule = (value) => {\n  return !!value?.trim() || '该字段为必填项'\n}\n\nconst isDeleteConfirmVisible = ref(false)\nconst selectedVersion = ref(null)\nconst selectedSystem = ref(null)\nconst deleteId = ref(null)\n\nconst searchContent = ref('')\n\nconst selectNotice = ref('')\n\nconst showAddModal = ref(false)\nconst title = ref('')\nconst spec = ref('')\nconst content = ref('')\n\nconst noticeTypeOptions = ref([])\n\nconst openDeleteConfirm = (rowData) => {\n  deleteId.value = rowData.id\n  isDeleteConfirmVisible.value = true\n}\n\nconst convertToOptions = (arr) => \n  arr.map(item => ({ value: item, text: item }));\nconst fetchNoticeOptions = async () => {\n  try {\n    const response = await noticeTypes()\n\tconst defaultOption = { value: '', text: '所有' };\n\tnoticeTypeOptions.value = [defaultOption, ...convertToOptions(response || [])];\n  } catch (error) {\n    toast({\n      message: error,\n      color: 'danger'\n    })\n  }\n}\n\nconst titleLength = () => {\n\treturn title.value.trim().length\n}\n\nconst specLength = () => {\n\treturn spec.value.trim().length\n}\n\nconst contentLength = () => {\n\treturn content.value.trim().length\n}\n\nconst isFormValid = () => {\n\tconsole.log(\"titleLength is\",titleLength())\n\t\tconsole.log(\"contentLength is\",contentLength())\n\t\t\tconsole.log(\"specLength is\",specLength())\n\treturn titleLength() > 0 && \n\t\t titleLength() <= 50 &&\n\t\t specLength() > 0 &&\n\t\t specLength() <= 100 &&\n\t\t contentLength() > 0 &&\n\t\t contentLength() <= 2000\n}\n\nconst resetAddNoticeForm = () => {\n   title.value = ''\n   spec.value = ''\n   content.value = ''\n}\n\nconst handleSubmit = async () => {\n      if (!isFormValid()) {\n        toast({\n          message: '请检查输入内容是否符合要求',\n          color: 'danger'\n        })\n        return\n      }\n\t  \n\t  const params = {\n\t\t  title: title.value,\n\t\t  title_en: title.value,\n\t\t  spec: spec.value,\n\t\t  spec_en: spec.value,\n\t\t  content: content.value,\n\t\t  content_en: content.value\n\t  }\n\t\n\t  try {\t\t\t\t  \n\t    await addNotice(params)\n\t    toast({ message: '新增成功', color:'rgb(47, 148, 172)' })\n\t  } catch (error) {\n\t    toast({ \n\t      message: `删除失败: ${error.message || '未知错误'}`, \n\t      color: 'danger' \n\t    })\n\t  } finally {\n\t\tfetchData()\n\t\tresetAddNoticeForm()\n\t    showAddModal.value = false\n\t  }\n}\n\nconst cancel = () => {\n    resetAddNoticeForm()\n    showAddModal.value = false\n}\n\nconst confirmDelete = async () => {\n  try {\n    await deleteNotice(deleteId.value)\n    toast({ message: '删除成功', color:'rgb(47, 148, 172)' })\n    // 这里可以触发表格刷新逻辑\n  } catch (error) {\n    toast({ \n      message: `删除失败: ${error.message || '未知错误'}`, \n      color: 'danger' \n    })\n  } finally {\n\tfetchData()\n\tfetchNoticeOptions()\n    isDeleteConfirmVisible.value = false\n  }\n}\n\nconst cancelDelete = () => {\n  toast({ message: '已取消删除', color: 'info' })\n  isDeleteConfirmVisible.value = false\n}\n\nconst uploading = ref({})\nconst downloading = ref({})\n\nconst hasValidFilePath = (row) => {\n  // 检查对象层级\n  if (!row || !row.rowData) return false\n  \n  // 检查路径有效性\n  const path = row.rowData.file_path\n  return typeof path === 'string' && path.trim().length > 0\n}\n\nconst simulateStep = (delay) => {\n  return new Promise((resolve) => setTimeout(resolve, delay));\n};\n\nconst handleUpload = async (files, row) => {\n  const rowId = row.rowData.id\n  const file = files[0]\n\t\n  const formData = new FormData()\n  formData.append('file', file,file.name)\n  formData.append('version', row.rowData.version)\n  formData.append('system', row.rowData.system)\n  \t\n  try {\n\t  \n\t  uploading.value[rowId] = true\t  \n\t  const data = await uploadApk(formData)\n\t  if (data.success) {\n\t     uploadFiles.value[rowId] = []\n\t  }\n\t  await simulateStep(2000); \n\t  uploading.value[rowId] = false\n\t  toast({\n\t      message: '上传成功',\n\t      color: \"success\",\n\t\t  duration: 5000\n\t  })\n\t  fetchData()\n\t  fetchNoticeOptions()\n  } catch (error) {\n\tconsole.error('上传失败:', {\n\t  request: error.config,\n\t  status: error.response?.status,\n\t  data: error.response?.data  \n\t})\n  }\n}\n\nconst handleDownload = async (row) => {\n  try {\n\tconst rowId = row.rowData.id\n\tdownloading.value[rowId] = true\n\n    if (!row.rowData?.version || !row.rowData?.system) {\n      ElMessage.error('请选择要下载的版本')\n\t  return\n    }\n\n    const response = await downloadApk({\n      version: row.rowData.version,\n      system: row.rowData.system\n    })\n\n    // 获取文件名（兼容大小写）\n    const fileName = decodeURIComponent(\n      response.headers['x-file-name'] || \n      response.headers['X-File-Name'] || \n      `${row.rowData.file_name}`\n    )\n\n    // 创建并触发下载\n    saveAs(new Blob([response.data]), fileName)\n\tawait simulateStep(2000); \n\tdownloading.value[rowId] = false\n  } catch (error) {\n    console.error('下载失败:', error)\n    \n    // 统一错误处理\n    let message = '下载失败，请重试'\n    \n    if (error.response?.data instanceof Blob) {\n      try {\n        const text = await error.response.data.text()\n        message = JSON.parse(text).error || message\n      } catch {\n        message = '服务器返回异常'\n      }\n    }\n    \n    ElMessage.error(message)\n  }\n}\n\nconst uploadFiles = reactive({})\n\nconst systemOptions = ref([\n\t{ value: '', text: '所有' },\n    { value: 'ios', text: 'IOS' },\n    { value: 'android', text: 'Android' },\n])\n\nconst systemWithOutAllOptions = ref([\n    { value: 'ios', text: 'IOS' },\n    { value: 'android', text: 'Android' },\n])\n\nconst searchSystem = ref(systemOptions[0])\n\nconst publishTime = ref()\n\nconst time = ref(new Date())\nconst date = ref(new Date())\n\nconst isDatePickerVisible = ref(false)\nconst selectedDateTime = ref(new Date())\nconst rowData = ref({}) // 根据实际数据结构调整\n\nconst requiredRule = value => !!value || '必须选择时间'\nconst dateValidationRule = value => {\n  const now = new Date()\n  const selected = new Date(value)\n  \n  // 时间必须晚于当前\n  if (selected <= now) return '时间必须晚于当前'\n  \n  return true\n}\n\nconst cronForm = reactive({\n\tversion: '',\n\tsystem: ''\n})\n\n// 计算属性\nconst isDateTimeValid = computed(() => \n\n  requiredRule(date.value) === true &&\n  dateValidationRule(time.value) === true\n)\n\nconst showPublishButton = computed(() => \n  ['0', 0].includes(rowData.value.is_latest)\n)\n\n// 打开选择器\nconst openDatePicker = (row) => {\n  time.value = new Date() // 重置为当前时间\n  date.value = new Date()\n  cronForm.version = row.rowData.version\n  cronForm.system = row.rowData.system\n  isDatePickerVisible.value = true\n}\n\nconst getSystemText = (system) => {\n\tif (system === \"android\") {\n\t\treturn \"Android\"\n\t}else {\n\t\treturn \"IOS\"\n\t}\n}\n  \nconst currentStartIndex = ref(1)\nconst totalItems = ref(0)\nconst notices = ref([])\nconst loading = ref(false)\n\nconst showConfirmDialog = ref(false)\nconst pendingVersion = ref(null)\nconst pendingSystem = ref(null)\nconst deletePendingVersion = ref(null)\nconst deletePendingSystem = ref(null)\n\nconst confirmPublish = (row) => {\n  pendingVersion.value = row.rowData.version\n  pendingSystem.value = row.rowData.system\n  showConfirmDialog.value = true\n  \n}\n\nconst handleConfirm = async () => {\n  try {\n\tawait publishNewVersion(pendingVersion.value,pendingSystem.value)\n  } catch (error) {\n  } finally {\n\tshowConfirmDialog.value = false\n  }\n}\n\nconst handleCronPublish = async () => {\n\tconst combinedDate = date.value\n\tcombinedDate.setHours(time.value.getHours())\n\tcombinedDate.setMinutes(time.value.getMinutes())\n\tcombinedDate.setSeconds(0)\n\n\tconst params = {\n\t\tversion: cronForm.version,\n\t\tsystem: cronForm.system,\n\t\trelease_time: combinedDate.toLocaleString()\n\t}\n\ttry {\n\t\tawait cronPublishVersion(params)\n\t} catch (error) {\n\t} finally {\n\t\tisDatePickerVisible.value = false\n\t}\n}\n\nconst handleCancel = () => {\n  toast({ message: '已取消发布', color: 'warning' })\n  showConfirmDialog.value = false\n}\n\nconst validateVersion = (value) => {\n  if (!value) return '版本号不能为空'  // 补充空值判断\n    const pattern = /^v\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9]+)?$/\n    return pattern.test(value) || '格式示例：v1.0.0 或 v2.3.4-beta'\n}\n\n// URL格式验证\nconst validateURL = (value) => {\n\tif (!value) return '下载链接不能为空'  // 补充空值判断\n\t  try {\n\t\tnew URL(value)\n\t\treturn true\n\t  } catch {\n\t\treturn '请输入有效的URL地址'\n\t  }\n}\n\nconst formValid = computed(() => {\n\tconsole.log(\"version is\",addForm.version)\n\tconsole.log(\"download_url is\",addForm.download_url)\n  return validateVersion(addForm.version) === true &&\n         validateURL(addForm.download_url) === true\n})\n\nconst queryParams = reactive({\n    page: 1,\n    pagesize: 15,\n})\n\nconst isAddModalVisible = ref(false)\nconst isPublishVisible = ref(false)\nconst addForm = reactive({\n\tversion: '',\n\tsystem: '',\n\tdownload_url: '',\n\trelease_notes: '',\n\trelease_notes_en: ''\n})\n\nconst addVersionForm = () => {\n    showAddModal.value = true\n}\n\nconst truncateText = (text, maxLength) => {\n      if (!text) return ''\n      return text.length > maxLength \n        ? text.slice(0, maxLength) + '...' \n        : text\n}\n\n// 修改 fetchData 方法\nconst fetchData = async () => {\n    loading.value = true\n    try {\n        const params = {\n            page: queryParams.page,\n            pagesize: queryParams.pagesize,\n\t\t\tcontent: searchContent?.value,\n\t\t\ttype: selectNotice.value?.value\n        }\n\t\t\n\t\tif (searchSystem) {\n\t\t\tparams.system = searchSystem.value?.value\n\t\t}\n\n        const res = await noticeList(params)\n        // 因为拦截器已经处理了 res.data 的解构，这里直接使用返回值\n        if (res?.notices) {\n            notices.value = res.notices\n            totalItems.value = res.total\n        } else {\n            notices.value = []\n            totalItems.value = 0\n        }\n    } catch (error) {\n        console.error(\"获取数据失败:\", error)\n        toast({\n            message: error.message || \"获取数据失败\",\n            color: \"danger\",\n        })\n        notices.value = []\n        totalItems.value = 0\n    } finally {\n        loading.value = false\n    }\n}\n\nimport { watch } from 'vue'\n\nwatch([searchSystem,searchContent,selectNotice], () => {\n    queryParams.page = 1\n    currentStartIndex.value = 1\n    fetchData()\n\tfetchNoticeOptions()\n})\n\nconst columns = [\n\t { key: 'id', label: '序号' },\n    { key: 'title', label: '标题' },\n\t{ key: 'type', label: '通知类型' },\n\t{ key: 'spec', label: '概览' },\n    { key: 'content', label: '内容' },\n    { key: 'created_time', label: '通知时间' },\n    { key: 'actions', label: '操作' }  // 添加操作列\n]\n\nconst isEditModalVisible = ref(false)\nconst editForm = reactive({\n\tversion: '',\n\tsystem: '',\n\trelease_notes: '',\n\trelease_notes_en: '',\n\tdownload_url: ''\n})\n\nconst editVersion = (row) => {\n    editForm.version = row.rowData.version\n\teditForm.system = row.rowData.system\n\teditForm.download_url = row.rowData.download_url\n    editForm.release_notes = row.rowData.release_notes\n\teditForm.release_notes_en = row.rowData.release_notes_en\n    isEditModalVisible.value = true\n}\n\nconst onOk = async () => {\n    try {\n        const msg = await modifyVersion(editForm.version,editForm.system, {\n            download_url: editForm.download_url,\n            release_notes: editForm.release_notes,\n\t\t\trelease_notes_en: editForm.release_notes_en\n        })\n        toast({\n            message: msg,\n            color: \"success\",\n        })\n        await fetchData()\n        isEditModalVisible.value = false\n    } catch (error) {\n        console.error(\"修改失败:\", error)\n        toast({\n            message: error.message || \"修改失败\",\n            color: \"danger\",\n        })\n    }\n}\n\nconst publishNewVersion = async (version,system) => {\n    try {\n        const msg = await publishVersion(version,system)\n\t\ttoast({\n\t\t  message: msg,\n\t\t  color: 'success',\n\t\t  duration: 3000\n\t\t})\n        await fetchData()\n\t\tfetchNoticeOptions()\n    } catch (error) {\n        toast({\n            message: error.message || \"发布失败\",\n            color: \"danger\",\n\t\t\tduration: 5000\n        })\n    }\n}\n\nconst cronPublishVersion = async (params) => {\n    try {\n        const msg = await timedPublishVersion(params)\n\t\ttoast({\n\t\t  message: msg,\n\t\t  color: 'success',\n\t\t  duration: 30000\n\t\t})\n        await fetchData()\n\t\tfetchNoticeOptions()\n    } catch (error) {\n        toast({\n            message: error.message || \"定时发布失败\",\n            color: \"danger\",\n\t\t\tduration: 5000\n        })\n    }\n}\n\nconst onAddOk = async () => {\n\t\ttry {\n\t\t    const msg = await addVersion({\n\t\t        version: addForm.version,\n\t\t\t\tsystem: addForm.system?.value,\n\t\t        download_url: addForm.download_url,\n\t\t        release_notes: addForm.release_notes,\n\t\t\t\trelease_notes_en: addForm.release_notes_en\n\t\t    })\n\t\t    toast({\n\t\t        message: msg,\n\t\t        color: \"success\",\n\t\t    })\n\t\t    await fetchData()\n\t\t    isAddModalVisible.value = false\n\t\t} catch (error) {\n\t\t    console.error(\"修改失败:\", error)\n\t\t    toast({\n\t\t        message: error.message || \"修改失败\",\n\t\t        color: \"danger\",\n\t\t    })\n\t\t}\t\n}\n\nconst onCancel = () => {\n    isEditModalVisible.value = false\n    resetForm()\n}\n\nconst onCronCancel = () => {\n\tisDatePickerVisible.value = false\n}\n\nconst onAddCancel = () => {\n    isAddModalVisible.value = false\n    resetAddForm()\n}\n\nconst resetForm = () => {\n    editForm.version = ''\n\teditForm.system = ''\n    editForm.download_url = ''\n    editForm.release_notes = ''\n\teditForm.release_notes_en = ''\n}\n\nconst resetAddForm = () => {\n\taddForm.version = ''\n\taddForm.system = ''\n\taddForm.download_url = ''\n\taddForm.release_notes = ''\n\taddForm.release_notes_en = ''\n}\n\n// 分页\nconst handlePageChange = (startIndex) => {\n    queryParams.page = Math.ceil(startIndex / queryParams.pagesize)\n    currentStartIndex.value = startIndex\n    fetchData()\n\tfetchNoticeOptions()\n}\n\nconst refreshData = () => {\n\tsearchSystem.value = ''\n\tsearchContent.value = ''\n\tselectNotice.value = ''\n    fetchData()\n\tfetchNoticeOptions()\n}\n\n// 初始化加载数据\nfetchData()\nfetchNoticeOptions()\n</script>\n\n<style scoped>\n.modal-content {\n  padding: 1rem 2rem;\n}\n\n.text-danger {\n  color: var(--va-danger);\n}\n\n.va-input--error {\n  border-color: var(--va-danger);\n}\n\n/* .va-input__message-text {\n  color: var(--va-danger);\n  font-size: 0.8rem;\n  margin-top: 4px;\n} */\n\t\n.dialog-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 0;\n}\n\n.header-text {\n  font-size: 1.2em;\n  font-weight: 600;\n  color: var(--va-primary);\n}\n\n/* 内容区域样式 */\n.dialog-content {\n  line-height: 1.6;\n  padding: 12px 0;\n}\n\n.version-info {\n  font-size: 1.1em;\n  margin-bottom: 12px;\n}\n\n.version-highlight {\n  color: var(--va-success);\n  font-weight: 500;\n  font-family: monospace;\n}\n\n.system-highlight {\n  color: #126fc4;\n  font-weight: 500;\n  font-family: monospace;\n}\n\n.confirm-text {\n  color: var(--va-danger);\n  margin-top: 16px;\n  font-size: 0.95em;\n}\n\n/* 按钮样式覆盖 */\n:deep(.va-modal__ok-button) {\n  font-weight: 600;\n  letter-spacing: 0.5px;\n}\n\n:deep(.va-modal__cancel-button) {\n  opacity: 0.8;\n}\n\n.machines-list {\n    padding: 20px;\n}\n\n.filters-row {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 10px;\n    align-items: center;\n    margin-top: 0; /* 移除之前的 mt-4 */\n}\n\n.filter-item {\n    min-width: 150px;\n}\n\n.mobile-list-item {\n    padding: 10px;\n}\n\n.mobile-actions {\n    display: flex;\n    justify-content: flex-end;\n    margin-top: 10px;\n}\n\n.action-buttons {\n    display: flex;\n    gap: 0.5rem;\n    justify-content: center;\n    padding-left: 5px;\n    padding-right: 5px;\n    min-width: 40px; /* 确保按钮有足够空间 */\n  }\n\n@media (max-width: 768px) {\n    .machines-list {\n        padding: 10px;\n    }\n\n    .filter-item {\n        width: 100%;\n        min-width: unset;\n    }\n}\n\n.custom-modal .va-modal-footer {\n  display: none; /* 隐藏默认的 footer */\n}\n\n.action-container {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  min-width: 160px; /* 保持列宽一致 */\n}\n\n/* 图标按钮统一样式 */\n.action-icon {\n  width: 28px;\n  height: 28px;\n  padding: 6px;\n  margin: 0 2px;\n}\n\n/* 悬停效果增强 */\n.va-button:hover {\n  transform: scale(1.1);\n  transition: transform 0.2s;\n}\n\n/* 下拉菜单定位 */\n.more-actions {\n  margin-left: auto;\n}\n\n/* 统一按钮尺寸 */\n.aligned-button {\n  min-width: 28px !important;\n  height: 28px !important;\n  padding: 6px 8px !important;  /* 与其他按钮一致 */\n  line-height: 1 !important;\n}\n\n/* 微调图标位置 */\n:deep(.va-button__content) {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n/* 确保所有按钮容器对齐 */\n.action-container > * {\n  vertical-align: middle;\n}\n\n.large-textarea {\n  /* 固定宽度 */\n  width: 800px;\n  /* 最小高度 */\n  min-height: 300px;\n  \n  /* 响应式适配 */\n  @media (max-width: 768px) {\n    width: 100%;\n    min-height: 200px;\n  }\n  \n  /* 文本域内部样式 */\n  ::v-deep .va-input-wrapper__textarea {\n    font-size: 16px;\n    line-height: 1.6;\n    padding: 1rem;\n  }\n}\n</style>"],"names":["noticeList","params","get","addNotice","data","put","response","deleteNotice","id","patch","noticeTypes","toast","useToast","useForm","isDeleteConfirmVisible","ref","deleteId","searchContent","selectNotice","showAddModal","title","spec","content","noticeTypeOptions","openDeleteConfirm","rowData","convertToOptions","arr","item","fetchNoticeOptions","defaultOption","error","titleLength","specLength","contentLength","isFormValid","resetAddNoticeForm","handleSubmit","fetchData","cancel","confirmDelete","cancelDelete","reactive","systemOptions","systemWithOutAllOptions","searchSystem","time","date","isDatePickerVisible","requiredRule","value","dateValidationRule","now","cronForm","isDateTimeValid","computed","getSystemText","system","currentStartIndex","totalItems","notices","loading","showConfirmDialog","pendingVersion","pendingSystem","handleConfirm","publishNewVersion","handleCronPublish","combinedDate","cronPublishVersion","handleCancel","validateVersion","validateURL","addForm","queryParams","isAddModalVisible","addVersionForm","truncateText","text","maxLength","_a","_b","res","watch","columns","isEditModalVisible","editForm","onOk","msg","modifyVersion","version","publishVersion","timedPublishVersion","onAddOk","addVersion","onCancel","resetForm","onCronCancel","onAddCancel","resetAddForm","handlePageChange","startIndex","refreshData"],"mappings":"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"}