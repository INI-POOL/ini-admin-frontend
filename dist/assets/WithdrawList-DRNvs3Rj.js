import{u as oe}from"./useToast-Yo7ZTzUp.js";import{p as F,g as le}from"./request-BXGzMDzr.js";import{f as L}from"./date-BVCtguWR.js";import{_ as ne,U as j,r as p,o as re,c as E,b as t,t as n,h as i,w as l,I as ie,f as u,a as d,i as c,u as f,g as v,k as h}from"./index-Y_JN8mlM.js";function ue(y){return F("/api/v1/back_stage/withdraw/list",y)}function de(y){return F("/api/v1/back_stage/withdraw/audit",y)}function ce(){return le("/api/v1/back_stage/hot_address/balance")}function C(y){let r=y.toString();return r.includes(".")&&(r=r.replace(/\.?0+$/,"")),r}const me={class:"withdraw-list"},pe={class:"mb-4"},ve={class:"text-2xl font-bold"},_e={class:"action-buttons",style:{"text-align":"center"}},ge={key:2},fe={class:"flex justify-end mt-4"},ye={class:"ml-4 self-center text-gray-600"},be={class:"space-y-4"},Ve={class:"mb-4"},ke={class:"transfer-header",style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",gap:"0.62rem","padding-top":"1rem"}},xe={class:"status"},we={class:"time"},Ce={class:"transfer-info"},ze={class:"info-row"},De={class:"value-box"},he={class:"value"},Te={class:"info-row"},Ae={class:"value-box"},Be={class:"value"},Ie={class:"info-row"},$e={class:"value-box"},Se={class:"info-row"},Ue={class:"value-box"},We={class:"transaction-id"},Ne={class:"value-box"},Pe={class:"value"},Me=["href"],Le={__name:"WithdrawList",setup(y){const{init:r}=oe(),H=[{key:"id",label:"订单号"},{key:"user_id",label:"用户编号"},{key:"mobile",label:"手机号"},{key:"amount",label:"提现金额"},{key:"gas_fee",label:"gas费"},{key:"currency",label:"币种"},{key:"status",label:"提现状态"},{key:"audit_status",label:"审核状态",sortable:!0},{key:"created_time",label:"申请时间",sortable:!0},{key:"action",label:"操作"}],b=j({page:1,pagesize:10}),S=p([]),z=p(0),T=p(1),A=p(!1),B=async()=>{A.value=!0;try{const a=await ue(b);a&&typeof a.Total=="number"?(S.value=a.Withdraws||[],z.value=parseInt(a.Total)):(console.error("API返回数据格式错误:",a),r({message:"数据格式错误",color:"danger"}))}catch(a){console.error("获取数据失败:",a),r({message:"获取数据失败",color:"danger"})}finally{A.value=!1}},k=async a=>{if(navigator.clipboard)navigator.clipboard.writeText(a).then(()=>{r({message:"复制成功",color:"success"})}).catch(e=>{r({message:"复制成功",color:"success"})});else{const e=document.createElement("textarea");e.value=a,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),r({message:"复制成功",color:"success"})}},R=a=>{b.page=Math.ceil(a/b.pagesize),T.value=a,B()},U=(a,e)=>{const V={0:"处理中",1:"成功",2:"失败",3:"确认中",4:"提现异常"};return console.log(a,e),a==2&&e>15?"Aleo网络异常":V[a]||"未知状态"},q=a=>{const e={0:"warning",1:"success",2:"info",3:"danger"};let V=e[a]||"primary";return console.log(e[a]),V},O=a=>({0:"待审核",1:"已通过",2:"未通过"})[a]||"未知状态",Z=a=>({0:"warning",1:"success",2:"danger"})[a]||"primary",D=p(!1),x=p(null),m=j({audit_status:1}),G=a=>{a&&(x.value=a.rowData,m.audit_status=1,D.value=!0)},J=async()=>{if(!x.value)return;let a=ie();if(!m.google_code){r({message:"谷歌认证码不能为空",color:"danger"});return}try{let e=await de({id:x.value.id,audit_status:m.audit_status,google_code:m.google_code,user_name:a});console.log("data is",e),e==0?r({message:"审核失败, 余额不足",color:"warning"}):(r({message:"审核成功",color:"success"}),D.value=!1,B())}catch(e){r({message:e,color:"danger"})}},I=p(!1),o=p(null),K=a=>{if(!a){console.error("行数据为空");return}o.value=a.rowData,m.audit_status=1,I.value=!0},W=p(0),Q=async()=>{try{const a=await ce();a?W.value=parseFloat(a):console.error("热钱包余额获取失败:",a)}catch(a){console.error("热钱包余额获取失败:",a)}};return re(()=>{B(),Q()}),(a,e)=>{const V=u("VaBadge"),N=u("VaButton"),X=u("VaDataTable"),Y=u("VaPagination"),ee=u("VaCardContent"),te=u("VaCard"),ae=u("VaRadio"),se=u("VaInput"),P=u("VaModal"),w=u("VaAvatar"),M=u("VaDivider"),$=u("VaIcon");return d(),E("div",me,[t("div",pe,[t("h1",ve,"提现管理 (热钱包余额："+n(W.value||0)+")",1)]),i(te,null,{default:l(()=>[i(ee,null,{default:l(()=>[i(X,{items:S.value,loading:A.value,columns:H,"items-per-page":b.pagesize,"current-page":b.page,"total-items":z.value,selectable:!1,"show-select":!1,hoverable:"",class:"responsive-table"},{"cell(amount)":l(({value:s})=>[c(n(f(C)(s)),1)]),"cell(gas_fee)":l(({value:s})=>[c(n(f(C)(s)),1)]),"cell(status)":l(({row:s})=>[i(V,{color:q(s.rowData.status)},{default:l(()=>[c(n(U(s.rowData.status,s.rowData.id)),1)]),_:2},1032,["color"])]),"cell(audit_status)":l(({value:s})=>[i(V,{color:Z(s)},{default:l(()=>[c(n(O(s)),1)]),_:2},1032,["color"])]),"cell(created_time)":l(({value:s})=>[c(n(f(L)(s)),1)]),"cell(action)":l(({row:s})=>[t("div",_e,[s?(d(),v(N,{key:0,size:"small",preset:"primary",onClick:g=>K(s)},{default:l(()=>e[10]||(e[10]=[c(" 查看 ")])),_:2},1032,["onClick"])):h("",!0),s&&Number(s.rowData.audit_status)===0?(d(),v(N,{key:1,size:"small",preset:"primary",onClick:g=>G(s)},{default:l(()=>e[11]||(e[11]=[c(" 审核 ")])),_:2},1032,["onClick"])):(d(),E("span",ge,"--"))])]),_:1},8,["items","loading","items-per-page","current-page","total-items"]),t("div",fe,[i(Y,{modelValue:T.value,"onUpdate:modelValue":[e[0]||(e[0]=s=>T.value=s),R],"page-size":b.pagesize,"visible-pages":"5",total:z.value,"buttons-preset":"secondary","boundary-numbers":""},null,8,["modelValue","page-size","total"]),t("span",ye," 共 "+n(z.value)+" 条记录 ",1)])]),_:1})]),_:1}),i(P,{modelValue:D.value,"onUpdate:modelValue":e[3]||(e[3]=s=>D.value=s),title:"提现审核","ok-text":"确认","cancel-text":"取消",size:"small",class:"audit-modal",onOk:J},{default:l(()=>{var s,g;return[t("div",be,[t("div",null,[t("div",Ve," 当前提现金额："+n(f(C)((s=x.value)==null?void 0:s.amount)||0)+" "+n(((g=x.value)==null?void 0:g.currency)||""),1),e[12]||(e[12]=t("div",{class:"mb-2"},"审核结果",-1)),i(ae,{modelValue:m.audit_status,"onUpdate:modelValue":e[1]||(e[1]=_=>m.audit_status=_),options:[{text:"同意",value:1},{text:"拒绝",value:2}],"value-by":"value"},null,8,["modelValue"]),e[13]||(e[13]=t("div",{class:"mb-2",style:{"padding-top":"0.62rem"}},"谷歌认证",-1)),i(se,{modelValue:m.google_code,"onUpdate:modelValue":e[2]||(e[2]=_=>m.google_code=_),width:"200px",placeholder:"请输入谷歌认证码"},null,8,["modelValue"])])])]}),_:1},8,["modelValue"]),i(P,{modelValue:I.value,"onUpdate:modelValue":e[9]||(e[9]=s=>I.value=s),title:"转账详情",size:"medium",class:"mr-6 my-1","close-button":""},{content:l(()=>{var s,g;return[t("div",ke,[o.value.status===0?(d(),v(w,{key:0,color:"info"},{default:l(()=>e[14]||(e[14]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," more_horiz ",-1)])),_:1})):o.value.status===1?(d(),v(w,{key:1,color:"success"},{default:l(()=>e[15]||(e[15]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," check ",-1)])),_:1})):o.value.status===2?(d(),v(w,{key:2,color:"danger"},{default:l(()=>e[16]||(e[16]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," close ",-1)])),_:1})):o.value.status===3?(d(),v(w,{key:3,color:"warning"},{default:l(()=>e[17]||(e[17]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," directory_sync ",-1)])),_:1})):o.value.status===4?(d(),v(w,{key:4,color:"danger"},{default:l(()=>e[18]||(e[18]=[t("span",{class:"material-symbols-outlined",style:{"font-size":"40px"}}," check ",-1)])),_:1})):h("",!0),t("div",xe,n(U(o.value.status,o.value.id)),1),t("div",we,n(f(L)(o.value.created_time)),1)]),i(M),t("div",Ce,[t("div",ze,[e[19]||(e[19]=t("span",{class:"label"},"数额：",-1)),t("div",De,[t("span",he,n(f(C)((s=o.value)==null?void 0:s.amount)||0)+" "+n(o.value.currency),1)])]),t("div",Te,[e[20]||(e[20]=t("span",{class:"label"},"提款手续费：",-1)),t("div",Ae,[t("span",Be,n(f(C)((g=o.value)==null?void 0:g.gas_fee)||0)+" "+n(o.value.currency),1)])]),t("div",Ie,[e[22]||(e[22]=t("span",{class:"label"},"收款地址：",-1)),t("div",$e,[t("span",{class:"value",onClick:e[4]||(e[4]=_=>k(o.value.to_addr))},n(o.value.to_addr),1),i($,{class:"material-icons",onClick:e[5]||(e[5]=_=>k(o.value.to_addr))},{default:l(()=>e[21]||(e[21]=[c(" content_copy ")])),_:1})])]),t("div",Se,[e[24]||(e[24]=t("span",{class:"label"},"付款地址：",-1)),t("div",Ue,[t("span",{class:"value",onClick:e[6]||(e[6]=_=>k(o.value.from_addr))},n(o.value.from_addr),1),o.value.from_addr?(d(),v($,{key:0,class:"material-icons",onClick:e[7]||(e[7]=_=>k(o.value.from_addr))},{default:l(()=>e[23]||(e[23]=[c(" content_copy ")])),_:1})):h("",!0)])])]),i(M),t("div",We,[e[26]||(e[26]=t("span",{class:"label"},"交易号：",-1)),t("div",Ne,[t("span",Pe,[t("a",{href:`https://mainnet.aleo123.io/transactionDetail/${o.value.tx_id}`,target:"_blank"},n(o.value.tx_id),9,Me)]),o.value.tx_id?(d(),v($,{key:0,class:"material-icons",onClick:e[8]||(e[8]=_=>k(o.value.tx_id))},{default:l(()=>e[25]||(e[25]=[c(" content_copy ")])),_:1})):h("",!0)])])]}),_:1},8,["modelValue"])])}}},Re=ne(Le,[["__scopeId","data-v-1bbe1b72"]]);export{Re as default};
//# sourceMappingURL=WithdrawList-DRNvs3Rj.js.map
