import{H as D,d as A,I as $,f as i,a as v,c as I,h as r,w as p,i as f,b as l,t as h,u as _,F as E,r as g,o as R,e as T,g as V,j as w,k as S,J as q}from"./index-Bi09-Pwr.js";import{u as B}from"./useToast-BhaMxvRu.js";import{i as H,b as J,g as Y}from"./user-cYNxm4en.js";import"./request-Q-IbeB_i.js";const C=D("user",{state:()=>({userName:"Vasili Savitski",email:"vasili@gmail.com",memberSince:"8/12/2020",pfp:"https://picsum.photos/id/22/200/300",is2FAEnabled:!1}),actions:{toggle2FA(){this.is2FAEnabled=!this.is2FAEnabled},changeUserName(y){this.userName=y}}}),K={class:"flex flex-col justify-center"},L={class:"text-[28px] md:text-[32px] leading-10 font-bold"},Q=A({__name:"PreferencesHeader",setup(y){const u=$();return C(),(s,n)=>{const m=i("VaAvatar");return v(),I(E,null,[r(m,{color:"warning"},{default:p(()=>n[0]||(n[0]=[f(" U.M ")])),_:1}),l("div",K,[l("h2",L,h(_(u)),1)])],64)}}}),M={"--va-button-font-size":"14px","--va-button-line-height":"20px"},W={class:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-6 min-h-[36px] leading-5"},X=A({__name:"Settings",emits:["openNameModal","openResetPasswordModal"],setup(y,{emit:u}){const s=C();B();const n=g(0);R(async()=>{await m()});const m=async()=>{try{const t=$(),c=await H(t);n.value=c}catch(t){console.error("Error checking Google code requirement:",t)}};T(()=>s.is2FAEnabled?"2FA successfully enabled":"2FA successfully disabled"),T(()=>s.is2FAEnabled?{color:"danger",button:"Disable 2FA",content:"Two-Factor Authentication (2FA) is now enabled for your account, adding an extra layer of security to your sign-ins."}:{color:"primary",button:"Set up 2FA",content:"Add an extra layer of security to your account. To sign in, you’ll need to provide a code along with your username and password."});const o=u;return(t,c)=>{const a=i("VaButton"),x=i("VaDivider");return v(),I(E,null,[l("div",W,[c[2]||(c[2]=l("p",{class:"font-bold w-[200px]"},"绑定谷歌认证器",-1)),c[3]||(c[3]=l("div",{class:"flex-1"},[l("div",{class:"max-w-[748px]"}," 为您的帐户增加一层额外的安全保护。 登录时，除了用户名和密码外，您还需要提供一个谷歌验证码（安全认证器）。 ")],-1)),n.value==0?(v(),V(a,{key:0,style:w(_(M)),class:"w-fit h-fit",preset:"primary",onClick:c[0]||(c[0]=d=>o("openAuthenticationModal"))},{default:p(()=>c[1]||(c[1]=[f(" 绑定 ")])),_:1},8,["style"])):S("",!0)]),r(x)],64)}}}),Z={class:"flex flex-col-reverse md:flex-row md:items-center md:justify-end md:space-x-4"},ee=A({__name:"EditNameModal",emits:["cancel"],setup(y,{emit:u}){const s=C(),{init:n}=B(),m=u,o=g(s.userName),t=()=>{if(!o.value||o.value===s.userName)return m("cancel");s.changeUserName(o.value),n({message:"You've successfully changed your name",color:"success"}),m("cancel")};return(c,a)=>{const x=i("VaInput"),d=i("VaButton"),e=i("VaForm"),N=i("VaModal");return v(),V(N,{"mobile-fullscreen":!1,size:"small","hide-default-actions":"","max-width":"380px","model-value":"","close-button":"","onUpdate:modelValue":a[2]||(a[2]=b=>m("cancel"))},{default:p(()=>[a[5]||(a[5]=l("h1",{class:"va-h5 mb-4"},"Reset password",-1)),r(e,{ref:"form",onSubmit:q(t,["prevent"])},{default:p(()=>[r(x,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=b=>o.value=b),class:"mb-4",label:"Name",placeholder:"Name"},null,8,["modelValue"]),l("div",Z,[r(d,{style:w(_(M)),preset:"secondary",color:"secondary",onClick:a[1]||(a[1]=b=>m("cancel"))},{default:p(()=>a[3]||(a[3]=[f(" Cancel")])),_:1},8,["style"]),r(d,{style:w(_(M)),class:"mb-4 md:mb-0",type:"submit",onClick:t},{default:p(()=>a[4]||(a[4]=[f(" Save")])),_:1},8,["style"])])]),_:1},512)]),_:1})}}}),oe={class:"flex flex-col-reverse md:flex-row md:items-center md:justify-end md:space-x-4"},te={__name:"EditAuthenticationModal",emits:["cancel"],setup(y,{emit:u}){C();const{init:s}=B(),n=u,m=g(),o=g(),t=g(""),c=()=>{if(t.value||s({message:"谷歌认证码错误",color:"danger"}),t.value){const d=$();J({user_name:d,google_code:t.value}).then(e=>{e==1?(s({message:"谷歌认证绑定成功",color:"success"}),n("cancel"),window.location.reload()):(s({message:"谷歌认证绑定失败",color:"danger"}),n("cancel"))}).catch(e=>{s({message:"谷歌认证绑定失败",color:"danger"}),n("cancel")})}};(async()=>{const d=$(),e=await Y(d);o.value=e,console.log(o.value)})();const x=async d=>{if(navigator.clipboard)navigator.clipboard.writeText(d).then(()=>{s({message:"复制成功",color:"success"})}).catch(e=>{s({message:"复制失败",color:"danger"})});else{const e=document.createElement("textarea");e.value=d,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),s({message:"复制成功",color:"success"})}};return(d,e)=>{const N=i("VaImage"),b=i("VaIcon"),P=i("VaInput"),U=i("VaButton"),j=i("VaForm"),z=i("VaModal");return v(),V(z,{"mobile-fullscreen":!1,size:"small","hide-default-actions":"","max-width":"380px","model-value":"","close-button":"","onUpdate:modelValue":e[3]||(e[3]=k=>n("cancel"))},{default:p(()=>[e[7]||(e[7]=l("h1",{class:"va-h5 mb-4"},"谷歌认证",-1)),r(j,{ref_key:"form",ref:m},{default:p(()=>{var k,G;return[r(N,{class:"w-full md:w-1/2 lg:w-1/3",src:(k=o.value)==null?void 0:k.qr_secret},null,8,["src"]),l("div",{class:"mt-4",onClick:e[0]||(e[0]=F=>{var O;return x((O=o.value)==null?void 0:O.secret)})},[f(h((G=o.value)==null?void 0:G.secret)+" ",1),r(b,{class:"material-icons"},{default:p(()=>e[4]||(e[4]=[f(" content_copy ")])),_:1})]),r(P,{modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=F=>t.value=F),class:"mb-4",label:"Name",placeholder:"请输入谷歌认证码"},null,8,["modelValue"]),l("div",oe,[r(U,{style:w(_(M)),preset:"secondary",color:"secondary",onClick:e[2]||(e[2]=F=>n("cancel"))},{default:p(()=>e[5]||(e[5]=[f(" Cancel")])),_:1},8,["style"]),r(U,{style:w(_(M)),class:"mb-4 md:mb-0",type:"submit",onClick:c},{default:p(()=>e[6]||(e[6]=[f(" Save")])),_:1},8,["style"])])]}),_:1},512)]),_:1})}}},se={class:"flex flex-col p-4 space-y-10 bg-backgroundSecondary rounded-lg"},ne={class:"flex space-x-5"},ae={class:"space-y-4 md:space-y-6"},de=A({__name:"Preferences",setup(y){const u=g(!1),s=g(!1),n=g(!1);return(m,o)=>(v(),I(E,null,[o[5]||(o[5]=l("h1",{class:"page-title"},"双重认证",-1)),l("div",se,[l("div",ne,[r(Q)]),l("div",ae,[r(X,{onOpenNameModal:o[0]||(o[0]=t=>u.value=!0),onOpenResetPasswordModal:o[1]||(o[1]=t=>s.value=!0),onOpenAuthenticationModal:o[2]||(o[2]=t=>n.value=!0)})])]),u.value?(v(),V(ee,{key:0,onCancel:o[3]||(o[3]=t=>u.value=!1)})):S("",!0),n.value?(v(),V(te,{key:1,onCancel:o[4]||(o[4]=t=>n.value=!1)})):S("",!0)],64))}});export{de as default};
//# sourceMappingURL=Preferences-7QLWxYt9.js.map
