import{H as R,d as N,I as A,f as i,a as v,c as E,h as r,w as p,i as f,b as l,t as P,u as x,F as B,r as g,o as q,e as T,g as w,j as $,k as I,J as H}from"./index-Bqj2tm-I.js";import{u as U}from"./useToast-C17EpNUA.js";import{i as h,c as J,g as Y}from"./user-gYiAl9Bt.js";import"./request-HAmVxrmq.js";const F=R("user",{state:()=>({userName:"Vasili Savitski",email:"vasili@gmail.com",memberSince:"8/12/2020",pfp:"https://picsum.photos/id/22/200/300",is2FAEnabled:!1}),actions:{toggle2FA(){this.is2FAEnabled=!this.is2FAEnabled},changeUserName(y){this.userName=y}}}),K={class:"flex flex-col justify-center"},L={class:"text-[28px] md:text-[32px] leading-10 font-bold"},Q=N({__name:"PreferencesHeader",setup(y){const u=A();return F(),(n,s)=>{const d=i("VaAvatar");return v(),E(B,null,[r(d,{color:"warning"},{default:p(()=>s[0]||(s[0]=[f(" U.M ")])),_:1}),l("div",K,[l("h2",L,P(x(u)),1)])],64)}}}),k={"--va-button-font-size":"14px","--va-button-line-height":"20px"},W={class:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-6 min-h-[36px] leading-5"},X=N({__name:"Settings",emits:["openNameModal","openResetPasswordModal"],setup(y,{emit:u}){const n=F();U();const s=g(0);q(async()=>{await d()});const d=async()=>{try{const o=A(),c=await h(o);s.value=c}catch(o){console.error("Error checking Google code requirement:",o)}};T(()=>n.is2FAEnabled?"2FA successfully enabled":"2FA successfully disabled"),T(()=>n.is2FAEnabled?{color:"danger",button:"Disable 2FA",content:"Two-Factor Authentication (2FA) is now enabled for your account, adding an extra layer of security to your sign-ins."}:{color:"primary",button:"Set up 2FA",content:"Add an extra layer of security to your account. To sign in, you’ll need to provide a code along with your username and password."});const e=u;return(o,c)=>{const a=i("VaButton"),_=i("VaDivider");return v(),E(B,null,[l("div",W,[c[2]||(c[2]=l("p",{class:"font-bold w-[200px]"},"绑定谷歌认证器",-1)),c[3]||(c[3]=l("div",{class:"flex-1"},[l("div",{class:"max-w-[748px]"}," 为您的帐户增加一层额外的安全保护。 登录时，除了用户名和密码外，您还需要提供一个谷歌验证码（安全认证器）。 ")],-1)),s.value==0?(v(),w(a,{key:0,style:$(x(k)),class:"w-fit h-fit",preset:"primary",onClick:c[0]||(c[0]=m=>e("openAuthenticationModal"))},{default:p(()=>c[1]||(c[1]=[f(" 绑定 ")])),_:1},8,["style"])):I("",!0)]),r(_)],64)}}}),Z={class:"flex flex-col-reverse md:flex-row md:items-center md:justify-end md:space-x-4"},ee=N({__name:"EditNameModal",emits:["cancel"],setup(y,{emit:u}){const n=F(),{init:s}=U(),d=u,e=g(n.userName),o=()=>{if(!e.value||e.value===n.userName)return d("cancel");n.changeUserName(e.value),s({message:"You've successfully changed your name",color:"success"}),d("cancel")};return(c,a)=>{const _=i("VaInput"),m=i("VaButton"),t=i("VaForm"),C=i("VaModal");return v(),w(C,{"mobile-fullscreen":!1,size:"small","hide-default-actions":"","max-width":"380px","model-value":"","close-button":"","onUpdate:modelValue":a[2]||(a[2]=b=>d("cancel"))},{default:p(()=>[a[5]||(a[5]=l("h1",{class:"va-h5 mb-4"},"Reset password",-1)),r(t,{ref:"form",onSubmit:H(o,["prevent"])},{default:p(()=>[r(_,{modelValue:e.value,"onUpdate:modelValue":a[0]||(a[0]=b=>e.value=b),class:"mb-4",label:"Name",placeholder:"Name"},null,8,["modelValue"]),l("div",Z,[r(m,{style:$(x(k)),preset:"secondary",color:"secondary",onClick:a[1]||(a[1]=b=>d("cancel"))},{default:p(()=>a[3]||(a[3]=[f(" Cancel")])),_:1},8,["style"]),r(m,{style:$(x(k)),class:"mb-4 md:mb-0",type:"submit",onClick:o},{default:p(()=>a[4]||(a[4]=[f(" Save")])),_:1},8,["style"])])]),_:1},512)]),_:1})}}}),te={class:"flex flex-col-reverse md:flex-row md:items-center md:justify-end md:space-x-4"},oe={__name:"EditAuthenticationModal",emits:["cancel"],setup(y,{emit:u}){F();const{init:n}=U(),s=u,d=g(),e=g(),o=g(""),c=()=>{if(o.value||n({message:"谷歌认证码错误",color:"danger"}),o.value){const m=A();J({user_name:m,google_code:o.value}).then(t=>{t==1?(n({message:"谷歌认证绑定成功",color:"success"}),s("cancel"),window.location.reload()):(n({message:"谷歌认证绑定失败",color:"danger"}),s("cancel"))}).catch(t=>{n({message:"谷歌认证绑定失败",color:"danger"}),s("cancel")})}};(async()=>{const m=A(),t=await Y(m);e.value=t,console.log(e.value)})();const _=async m=>{try{await navigator.clipboard.writeText(m),n({message:"复制成功",color:"success"})}catch{n({message:"复制失败",color:"danger"})}};return(m,t)=>{const C=i("VaImage"),b=i("VaIcon"),j=i("VaInput"),G=i("VaButton"),z=i("VaForm"),D=i("VaModal");return v(),w(D,{"mobile-fullscreen":!1,size:"small","hide-default-actions":"","max-width":"380px","model-value":"","close-button":"","onUpdate:modelValue":t[4]||(t[4]=S=>s("cancel"))},{default:p(()=>[t[8]||(t[8]=l("h1",{class:"va-h5 mb-4"},"谷歌认证",-1)),r(z,{ref_key:"form",ref:d},{default:p(()=>{var S,O;return[r(C,{class:"w-full md:w-1/2 lg:w-1/3",src:(S=e.value)==null?void 0:S.qr_secret},null,8,["src"]),l("div",{class:"mt-4",onClick:t[1]||(t[1]=M=>{var V;return _((V=e.value)==null?void 0:V.secret)})},[f(P((O=e.value)==null?void 0:O.secret)+" ",1),r(b,{class:"material-icons",onClick:t[0]||(t[0]=M=>{var V;return _((V=e.value)==null?void 0:V.secret)})},{default:p(()=>t[5]||(t[5]=[f(" content_copy ")])),_:1})]),r(j,{modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=M=>o.value=M),class:"mb-4",label:"Name",placeholder:"请输入谷歌认证码"},null,8,["modelValue"]),l("div",te,[r(G,{style:$(x(k)),preset:"secondary",color:"secondary",onClick:t[3]||(t[3]=M=>s("cancel"))},{default:p(()=>t[6]||(t[6]=[f(" Cancel")])),_:1},8,["style"]),r(G,{style:$(x(k)),class:"mb-4 md:mb-0",type:"submit",onClick:c},{default:p(()=>t[7]||(t[7]=[f(" Save")])),_:1},8,["style"])])]}),_:1},512)]),_:1})}}},se={class:"flex flex-col p-4 space-y-10 bg-backgroundSecondary rounded-lg"},ne={class:"flex space-x-5"},ae={class:"space-y-4 md:space-y-6"},ue=N({__name:"Preferences",setup(y){const u=g(!1),n=g(!1),s=g(!1);return(d,e)=>(v(),E(B,null,[e[5]||(e[5]=l("h1",{class:"page-title"},"双重认证",-1)),l("div",se,[l("div",ne,[r(Q)]),l("div",ae,[r(X,{onOpenNameModal:e[0]||(e[0]=o=>u.value=!0),onOpenResetPasswordModal:e[1]||(e[1]=o=>n.value=!0),onOpenAuthenticationModal:e[2]||(e[2]=o=>s.value=!0)})])]),u.value?(v(),w(ee,{key:0,onCancel:e[3]||(e[3]=o=>u.value=!1)})):I("",!0),s.value?(v(),w(oe,{key:1,onCancel:e[4]||(e[4]=o=>s.value=!1)})):I("",!0)],64))}});export{ue as default};
//# sourceMappingURL=Preferences-Bs4hSviJ.js.map
