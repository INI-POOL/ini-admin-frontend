import{d as U,W as B,r as V,T as S,o as q,f as t,a as _,g as v,w as u,b as k,h as r,u as d,J as w,k as A,i as L,X as I,Y as y}from"./index-BaO3riMA.js";import{u as Y}from"./useToast-jrZIA6fZ.js";import{v as p,g as C}from"./utils-mi3Titu2.js";import{i as F,c as M}from"./user-1qKpP-2c.js";import"./request-CYM5lb0L.js";const j={class:"flex justify-center mt-4"},X=U({__name:"Login",setup(z){const{push:i}=B(),{init:l}=Y(),m=V(!1),n=V(0),e=S({username:"",password:"",google_code:"",keepLoggedIn:!1}),b=()=>{console.log("umpoolISGoogle",n),e.username.trim()==="umpool"&&n.value===1?(console.log("checkIsNeedGoogleCode"),m.value=!0):m.value=!1};q(async()=>{await x()});const x=async()=>{console.log("checkUserGoogleCode");try{const o=await F("umpool");console.log(o),n.value=o}catch(o){console.error("Error checking Google code requirement:",o)}},g=()=>{if(n.value===1&&e.google_code==""){l({message:"谷歌认证码不能为空",color:"danger"});return}if(e.username.trim()==="umpool"&&e.password.trim()==="gT9@pY6uV*2S"&&n.value===1)M({user_name:e.username,google_code:e.google_code}).then(o=>{if(o===1){const s=C();I(s),y(e.username),l({message:"登陆成功！",color:"success"}),i({name:"withdraw"})}else l({message:"谷歌认证码错误",color:"danger"})}).catch(o=>{o.response?l({message:o.response.data.msg,color:"danger"}):l({message:"无效参数",color:"danger"})});else if(e.username.trim()==="admin"&&e.password.trim()==="A3f!7#b2Pz9L"||e.username==="umpool"&&e.password==="gT9@pY6uV*2S"){const o=C();I(o),y(e.username),l({message:"登陆成功！",color:"success"}),i({name:"withdraw"})}else l({message:"登陆失败！",color:"error"})};return(o,s)=>{const c=t("VaInput"),G=t("VaIcon"),h=t("VaValue"),N=t("VaButton"),T=t("VaForm");return _(),v(T,{ref:"form",onSubmit:w(g,["prevent"])},{default:u(()=>[s[4]||(s[4]=k("h1",{class:"font-semibold text-4xl mb-4"},"登陆",-1)),r(c,{modelValue:e.username,"onUpdate:modelValue":s[0]||(s[0]=a=>e.username=a),rules:[d(p).required,d(p).username],class:"mb-4",label:"用户名",type:"text",onInput:b},null,8,["modelValue","rules"]),r(h,{"default-value":!1},{default:u(a=>[r(c,{modelValue:e.password,"onUpdate:modelValue":s[1]||(s[1]=f=>e.password=f),rules:[d(p).required],type:a.value?"text":"password",class:"mb-4",label:"密码",onClickAppendInner:w(f=>a.value=!a.value,["stop"])},{appendInner:u(()=>[r(G,{name:a.value?"mso-visibility_off":"mso-visibility",class:"cursor-pointer",color:"secondary"},null,8,["name"])]),_:2},1032,["modelValue","rules","type","onClickAppendInner"])]),_:1}),m.value?(_(),v(c,{key:0,modelValue:e.google_code,"onUpdate:modelValue":s[2]||(s[2]=a=>e.google_code=a),class:"mb-4",label:"谷歌验证码",type:"text"},null,8,["modelValue"])):A("",!0),k("div",j,[r(N,{class:"w-full",onClick:g},{default:u(()=>s[3]||(s[3]=[L(" 登陆")])),_:1})])]),_:1},512)}}});export{X as default};
//# sourceMappingURL=Login-BslpA3RJ.js.map
